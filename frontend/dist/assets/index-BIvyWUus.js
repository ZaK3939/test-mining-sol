var np=Object.defineProperty;var ip=(n,e,t)=>e in n?np(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var me=(n,e,t)=>ip(n,typeof e!="symbol"?e+"":e,t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function t(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=t(i);fetch(i.href,s)}})();const sp="modulepreload",op=function(n){return"/"+n},hc={},ap=function(e,t,r){let i=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),a=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));i=Promise.allSettled(t.map(u=>{if(u=op(u),u in hc)return;hc[u]=!0;const l=u.endsWith(".css"),f=l?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${f}`))return;const _=document.createElement("link");if(_.rel=l?"stylesheet":sp,l||(_.as="script"),_.crossOrigin="",_.href=u,a&&_.setAttribute("nonce",a),document.head.appendChild(_),l)return new Promise((I,g)=>{_.addEventListener("load",I),_.addEventListener("error",()=>g(new Error(`Unable to preload CSS for ${u}`)))})}))}function s(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return i.then(o=>{for(const a of o||[])a.status==="rejected"&&s(a.reason);return e().catch(s)})};var Zt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{};function Vn(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function gs(n){if(n.__esModule)return n;var e=n.default;if(typeof e=="function"){var t=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(n).forEach(function(r){var i=Object.getOwnPropertyDescriptor(n,r);Object.defineProperty(t,r,i.get?i:{enumerable:!0,get:function(){return n[r]}})}),t}var te={},ms={};ms.byteLength=lp;ms.toByteArray=fp;ms.fromByteArray=yp;var gr=[],Jt=[],cp=typeof Uint8Array<"u"?Uint8Array:Array,uo="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var vn=0,up=uo.length;vn<up;++vn)gr[vn]=uo[vn],Jt[uo.charCodeAt(vn)]=vn;Jt[45]=62;Jt[95]=63;function $u(n){var e=n.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var t=n.indexOf("=");t===-1&&(t=e);var r=t===e?0:4-t%4;return[t,r]}function lp(n){var e=$u(n),t=e[0],r=e[1];return(t+r)*3/4-r}function hp(n,e,t){return(e+t)*3/4-t}function fp(n){var e,t=$u(n),r=t[0],i=t[1],s=new cp(hp(n,r,i)),o=0,a=i>0?r-4:r,u;for(u=0;u<a;u+=4)e=Jt[n.charCodeAt(u)]<<18|Jt[n.charCodeAt(u+1)]<<12|Jt[n.charCodeAt(u+2)]<<6|Jt[n.charCodeAt(u+3)],s[o++]=e>>16&255,s[o++]=e>>8&255,s[o++]=e&255;return i===2&&(e=Jt[n.charCodeAt(u)]<<2|Jt[n.charCodeAt(u+1)]>>4,s[o++]=e&255),i===1&&(e=Jt[n.charCodeAt(u)]<<10|Jt[n.charCodeAt(u+1)]<<4|Jt[n.charCodeAt(u+2)]>>2,s[o++]=e>>8&255,s[o++]=e&255),s}function dp(n){return gr[n>>18&63]+gr[n>>12&63]+gr[n>>6&63]+gr[n&63]}function pp(n,e,t){for(var r,i=[],s=e;s<t;s+=3)r=(n[s]<<16&16711680)+(n[s+1]<<8&65280)+(n[s+2]&255),i.push(dp(r));return i.join("")}function yp(n){for(var e,t=n.length,r=t%3,i=[],s=16383,o=0,a=t-r;o<a;o+=s)i.push(pp(n,o,o+s>a?a:o+s));return r===1?(e=n[t-1],i.push(gr[e>>2]+gr[e<<4&63]+"==")):r===2&&(e=(n[t-2]<<8)+n[t-1],i.push(gr[e>>10]+gr[e>>4&63]+gr[e<<2&63]+"=")),i.join("")}var ua={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */ua.read=function(n,e,t,r,i){var s,o,a=i*8-r-1,u=(1<<a)-1,l=u>>1,f=-7,_=t?i-1:0,I=t?-1:1,g=n[e+_];for(_+=I,s=g&(1<<-f)-1,g>>=-f,f+=a;f>0;s=s*256+n[e+_],_+=I,f-=8);for(o=s&(1<<-f)-1,s>>=-f,f+=r;f>0;o=o*256+n[e+_],_+=I,f-=8);if(s===0)s=1-l;else{if(s===u)return o?NaN:(g?-1:1)*(1/0);o=o+Math.pow(2,r),s=s-l}return(g?-1:1)*o*Math.pow(2,s-r)};ua.write=function(n,e,t,r,i,s){var o,a,u,l=s*8-i-1,f=(1<<l)-1,_=f>>1,I=i===23?Math.pow(2,-24)-Math.pow(2,-77):0,g=r?0:s-1,v=r?1:-1,x=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,o=f):(o=Math.floor(Math.log(e)/Math.LN2),e*(u=Math.pow(2,-o))<1&&(o--,u*=2),o+_>=1?e+=I/u:e+=I*Math.pow(2,1-_),e*u>=2&&(o++,u/=2),o+_>=f?(a=0,o=f):o+_>=1?(a=(e*u-1)*Math.pow(2,i),o=o+_):(a=e*Math.pow(2,_-1)*Math.pow(2,i),o=0));i>=8;n[t+g]=a&255,g+=v,a/=256,i-=8);for(o=o<<i|a,l+=i;l>0;n[t+g]=o&255,g+=v,o/=256,l-=8);n[t+g-v]|=x*128};/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */(function(n){const e=ms,t=ua,r=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;n.Buffer=a,n.SlowBuffer=K,n.INSPECT_MAX_BYTES=50;const i=2147483647;n.kMaxLength=i,a.TYPED_ARRAY_SUPPORT=s(),!a.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function s(){try{const b=new Uint8Array(1),d={foo:function(){return 42}};return Object.setPrototypeOf(d,Uint8Array.prototype),Object.setPrototypeOf(b,d),b.foo()===42}catch{return!1}}Object.defineProperty(a.prototype,"parent",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.buffer}}),Object.defineProperty(a.prototype,"offset",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.byteOffset}});function o(b){if(b>i)throw new RangeError('The value "'+b+'" is invalid for option "size"');const d=new Uint8Array(b);return Object.setPrototypeOf(d,a.prototype),d}function a(b,d,p){if(typeof b=="number"){if(typeof d=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return _(b)}return u(b,d,p)}a.poolSize=8192;function u(b,d,p){if(typeof b=="string")return I(b,d);if(ArrayBuffer.isView(b))return v(b);if(b==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof b);if(Wt(b,ArrayBuffer)||b&&Wt(b.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(Wt(b,SharedArrayBuffer)||b&&Wt(b.buffer,SharedArrayBuffer)))return x(b,d,p);if(typeof b=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const k=b.valueOf&&b.valueOf();if(k!=null&&k!==b)return a.from(k,d,p);const B=A(b);if(B)return B;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof b[Symbol.toPrimitive]=="function")return a.from(b[Symbol.toPrimitive]("string"),d,p);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof b)}a.from=function(b,d,p){return u(b,d,p)},Object.setPrototypeOf(a.prototype,Uint8Array.prototype),Object.setPrototypeOf(a,Uint8Array);function l(b){if(typeof b!="number")throw new TypeError('"size" argument must be of type number');if(b<0)throw new RangeError('The value "'+b+'" is invalid for option "size"')}function f(b,d,p){return l(b),b<=0?o(b):d!==void 0?typeof p=="string"?o(b).fill(d,p):o(b).fill(d):o(b)}a.alloc=function(b,d,p){return f(b,d,p)};function _(b){return l(b),o(b<0?0:N(b)|0)}a.allocUnsafe=function(b){return _(b)},a.allocUnsafeSlow=function(b){return _(b)};function I(b,d){if((typeof d!="string"||d==="")&&(d="utf8"),!a.isEncoding(d))throw new TypeError("Unknown encoding: "+d);const p=P(b,d)|0;let k=o(p);const B=k.write(b,d);return B!==p&&(k=k.slice(0,B)),k}function g(b){const d=b.length<0?0:N(b.length)|0,p=o(d);for(let k=0;k<d;k+=1)p[k]=b[k]&255;return p}function v(b){if(Wt(b,Uint8Array)){const d=new Uint8Array(b);return x(d.buffer,d.byteOffset,d.byteLength)}return g(b)}function x(b,d,p){if(d<0||b.byteLength<d)throw new RangeError('"offset" is outside of buffer bounds');if(b.byteLength<d+(p||0))throw new RangeError('"length" is outside of buffer bounds');let k;return d===void 0&&p===void 0?k=new Uint8Array(b):p===void 0?k=new Uint8Array(b,d):k=new Uint8Array(b,d,p),Object.setPrototypeOf(k,a.prototype),k}function A(b){if(a.isBuffer(b)){const d=N(b.length)|0,p=o(d);return p.length===0||b.copy(p,0,0,d),p}if(b.length!==void 0)return typeof b.length!="number"||We(b.length)?o(0):g(b);if(b.type==="Buffer"&&Array.isArray(b.data))return g(b.data)}function N(b){if(b>=i)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i.toString(16)+" bytes");return b|0}function K(b){return+b!=b&&(b=0),a.alloc(+b)}a.isBuffer=function(d){return d!=null&&d._isBuffer===!0&&d!==a.prototype},a.compare=function(d,p){if(Wt(d,Uint8Array)&&(d=a.from(d,d.offset,d.byteLength)),Wt(p,Uint8Array)&&(p=a.from(p,p.offset,p.byteLength)),!a.isBuffer(d)||!a.isBuffer(p))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(d===p)return 0;let k=d.length,B=p.length;for(let F=0,q=Math.min(k,B);F<q;++F)if(d[F]!==p[F]){k=d[F],B=p[F];break}return k<B?-1:B<k?1:0},a.isEncoding=function(d){switch(String(d).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},a.concat=function(d,p){if(!Array.isArray(d))throw new TypeError('"list" argument must be an Array of Buffers');if(d.length===0)return a.alloc(0);let k;if(p===void 0)for(p=0,k=0;k<d.length;++k)p+=d[k].length;const B=a.allocUnsafe(p);let F=0;for(k=0;k<d.length;++k){let q=d[k];if(Wt(q,Uint8Array))F+q.length>B.length?(a.isBuffer(q)||(q=a.from(q)),q.copy(B,F)):Uint8Array.prototype.set.call(B,q,F);else if(a.isBuffer(q))q.copy(B,F);else throw new TypeError('"list" argument must be an Array of Buffers');F+=q.length}return B};function P(b,d){if(a.isBuffer(b))return b.length;if(ArrayBuffer.isView(b)||Wt(b,ArrayBuffer))return b.byteLength;if(typeof b!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof b);const p=b.length,k=arguments.length>2&&arguments[2]===!0;if(!k&&p===0)return 0;let B=!1;for(;;)switch(d){case"ascii":case"latin1":case"binary":return p;case"utf8":case"utf-8":return Ke(b).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return p*2;case"hex":return p>>>1;case"base64":return Ve(b).length;default:if(B)return k?-1:Ke(b).length;d=(""+d).toLowerCase(),B=!0}}a.byteLength=P;function $(b,d,p){let k=!1;if((d===void 0||d<0)&&(d=0),d>this.length||((p===void 0||p>this.length)&&(p=this.length),p<=0)||(p>>>=0,d>>>=0,p<=d))return"";for(b||(b="utf8");;)switch(b){case"hex":return O(this,d,p);case"utf8":case"utf-8":return c(this,d,p);case"ascii":return E(this,d,p);case"latin1":case"binary":return S(this,d,p);case"base64":return w(this,d,p);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return C(this,d,p);default:if(k)throw new TypeError("Unknown encoding: "+b);b=(b+"").toLowerCase(),k=!0}}a.prototype._isBuffer=!0;function L(b,d,p){const k=b[d];b[d]=b[p],b[p]=k}a.prototype.swap16=function(){const d=this.length;if(d%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let p=0;p<d;p+=2)L(this,p,p+1);return this},a.prototype.swap32=function(){const d=this.length;if(d%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let p=0;p<d;p+=4)L(this,p,p+3),L(this,p+1,p+2);return this},a.prototype.swap64=function(){const d=this.length;if(d%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let p=0;p<d;p+=8)L(this,p,p+7),L(this,p+1,p+6),L(this,p+2,p+5),L(this,p+3,p+4);return this},a.prototype.toString=function(){const d=this.length;return d===0?"":arguments.length===0?c(this,0,d):$.apply(this,arguments)},a.prototype.toLocaleString=a.prototype.toString,a.prototype.equals=function(d){if(!a.isBuffer(d))throw new TypeError("Argument must be a Buffer");return this===d?!0:a.compare(this,d)===0},a.prototype.inspect=function(){let d="";const p=n.INSPECT_MAX_BYTES;return d=this.toString("hex",0,p).replace(/(.{2})/g,"$1 ").trim(),this.length>p&&(d+=" ... "),"<Buffer "+d+">"},r&&(a.prototype[r]=a.prototype.inspect),a.prototype.compare=function(d,p,k,B,F){if(Wt(d,Uint8Array)&&(d=a.from(d,d.offset,d.byteLength)),!a.isBuffer(d))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof d);if(p===void 0&&(p=0),k===void 0&&(k=d?d.length:0),B===void 0&&(B=0),F===void 0&&(F=this.length),p<0||k>d.length||B<0||F>this.length)throw new RangeError("out of range index");if(B>=F&&p>=k)return 0;if(B>=F)return-1;if(p>=k)return 1;if(p>>>=0,k>>>=0,B>>>=0,F>>>=0,this===d)return 0;let q=F-B,we=k-p;const ye=Math.min(q,we),pe=this.slice(B,F),ze=d.slice(p,k);for(let de=0;de<ye;++de)if(pe[de]!==ze[de]){q=pe[de],we=ze[de];break}return q<we?-1:we<q?1:0};function X(b,d,p,k,B){if(b.length===0)return-1;if(typeof p=="string"?(k=p,p=0):p>2147483647?p=2147483647:p<-2147483648&&(p=-2147483648),p=+p,We(p)&&(p=B?0:b.length-1),p<0&&(p=b.length+p),p>=b.length){if(B)return-1;p=b.length-1}else if(p<0)if(B)p=0;else return-1;if(typeof d=="string"&&(d=a.from(d,k)),a.isBuffer(d))return d.length===0?-1:V(b,d,p,k,B);if(typeof d=="number")return d=d&255,typeof Uint8Array.prototype.indexOf=="function"?B?Uint8Array.prototype.indexOf.call(b,d,p):Uint8Array.prototype.lastIndexOf.call(b,d,p):V(b,[d],p,k,B);throw new TypeError("val must be string, number or Buffer")}function V(b,d,p,k,B){let F=1,q=b.length,we=d.length;if(k!==void 0&&(k=String(k).toLowerCase(),k==="ucs2"||k==="ucs-2"||k==="utf16le"||k==="utf-16le")){if(b.length<2||d.length<2)return-1;F=2,q/=2,we/=2,p/=2}function ye(ze,de){return F===1?ze[de]:ze.readUInt16BE(de*F)}let pe;if(B){let ze=-1;for(pe=p;pe<q;pe++)if(ye(b,pe)===ye(d,ze===-1?0:pe-ze)){if(ze===-1&&(ze=pe),pe-ze+1===we)return ze*F}else ze!==-1&&(pe-=pe-ze),ze=-1}else for(p+we>q&&(p=q-we),pe=p;pe>=0;pe--){let ze=!0;for(let de=0;de<we;de++)if(ye(b,pe+de)!==ye(d,de)){ze=!1;break}if(ze)return pe}return-1}a.prototype.includes=function(d,p,k){return this.indexOf(d,p,k)!==-1},a.prototype.indexOf=function(d,p,k){return X(this,d,p,k,!0)},a.prototype.lastIndexOf=function(d,p,k){return X(this,d,p,k,!1)};function Y(b,d,p,k){p=Number(p)||0;const B=b.length-p;k?(k=Number(k),k>B&&(k=B)):k=B;const F=d.length;k>F/2&&(k=F/2);let q;for(q=0;q<k;++q){const we=parseInt(d.substr(q*2,2),16);if(We(we))return q;b[p+q]=we}return q}function U(b,d,p,k){return He(Ke(d,b.length-p),b,p,k)}function G(b,d,p,k){return He(Xe(d),b,p,k)}function M(b,d,p,k){return He(Ve(d),b,p,k)}function D(b,d,p,k){return He(Mi(d,b.length-p),b,p,k)}a.prototype.write=function(d,p,k,B){if(p===void 0)B="utf8",k=this.length,p=0;else if(k===void 0&&typeof p=="string")B=p,k=this.length,p=0;else if(isFinite(p))p=p>>>0,isFinite(k)?(k=k>>>0,B===void 0&&(B="utf8")):(B=k,k=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const F=this.length-p;if((k===void 0||k>F)&&(k=F),d.length>0&&(k<0||p<0)||p>this.length)throw new RangeError("Attempt to write outside buffer bounds");B||(B="utf8");let q=!1;for(;;)switch(B){case"hex":return Y(this,d,p,k);case"utf8":case"utf-8":return U(this,d,p,k);case"ascii":case"latin1":case"binary":return G(this,d,p,k);case"base64":return M(this,d,p,k);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return D(this,d,p,k);default:if(q)throw new TypeError("Unknown encoding: "+B);B=(""+B).toLowerCase(),q=!0}},a.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function w(b,d,p){return d===0&&p===b.length?e.fromByteArray(b):e.fromByteArray(b.slice(d,p))}function c(b,d,p){p=Math.min(b.length,p);const k=[];let B=d;for(;B<p;){const F=b[B];let q=null,we=F>239?4:F>223?3:F>191?2:1;if(B+we<=p){let ye,pe,ze,de;switch(we){case 1:F<128&&(q=F);break;case 2:ye=b[B+1],(ye&192)===128&&(de=(F&31)<<6|ye&63,de>127&&(q=de));break;case 3:ye=b[B+1],pe=b[B+2],(ye&192)===128&&(pe&192)===128&&(de=(F&15)<<12|(ye&63)<<6|pe&63,de>2047&&(de<55296||de>57343)&&(q=de));break;case 4:ye=b[B+1],pe=b[B+2],ze=b[B+3],(ye&192)===128&&(pe&192)===128&&(ze&192)===128&&(de=(F&15)<<18|(ye&63)<<12|(pe&63)<<6|ze&63,de>65535&&de<1114112&&(q=de))}}q===null?(q=65533,we=1):q>65535&&(q-=65536,k.push(q>>>10&1023|55296),q=56320|q&1023),k.push(q),B+=we}return m(k)}const h=4096;function m(b){const d=b.length;if(d<=h)return String.fromCharCode.apply(String,b);let p="",k=0;for(;k<d;)p+=String.fromCharCode.apply(String,b.slice(k,k+=h));return p}function E(b,d,p){let k="";p=Math.min(b.length,p);for(let B=d;B<p;++B)k+=String.fromCharCode(b[B]&127);return k}function S(b,d,p){let k="";p=Math.min(b.length,p);for(let B=d;B<p;++B)k+=String.fromCharCode(b[B]);return k}function O(b,d,p){const k=b.length;(!d||d<0)&&(d=0),(!p||p<0||p>k)&&(p=k);let B="";for(let F=d;F<p;++F)B+=Je[b[F]];return B}function C(b,d,p){const k=b.slice(d,p);let B="";for(let F=0;F<k.length-1;F+=2)B+=String.fromCharCode(k[F]+k[F+1]*256);return B}a.prototype.slice=function(d,p){const k=this.length;d=~~d,p=p===void 0?k:~~p,d<0?(d+=k,d<0&&(d=0)):d>k&&(d=k),p<0?(p+=k,p<0&&(p=0)):p>k&&(p=k),p<d&&(p=d);const B=this.subarray(d,p);return Object.setPrototypeOf(B,a.prototype),B};function R(b,d,p){if(b%1!==0||b<0)throw new RangeError("offset is not uint");if(b+d>p)throw new RangeError("Trying to access beyond buffer length")}a.prototype.readUintLE=a.prototype.readUIntLE=function(d,p,k){d=d>>>0,p=p>>>0,k||R(d,p,this.length);let B=this[d],F=1,q=0;for(;++q<p&&(F*=256);)B+=this[d+q]*F;return B},a.prototype.readUintBE=a.prototype.readUIntBE=function(d,p,k){d=d>>>0,p=p>>>0,k||R(d,p,this.length);let B=this[d+--p],F=1;for(;p>0&&(F*=256);)B+=this[d+--p]*F;return B},a.prototype.readUint8=a.prototype.readUInt8=function(d,p){return d=d>>>0,p||R(d,1,this.length),this[d]},a.prototype.readUint16LE=a.prototype.readUInt16LE=function(d,p){return d=d>>>0,p||R(d,2,this.length),this[d]|this[d+1]<<8},a.prototype.readUint16BE=a.prototype.readUInt16BE=function(d,p){return d=d>>>0,p||R(d,2,this.length),this[d]<<8|this[d+1]},a.prototype.readUint32LE=a.prototype.readUInt32LE=function(d,p){return d=d>>>0,p||R(d,4,this.length),(this[d]|this[d+1]<<8|this[d+2]<<16)+this[d+3]*16777216},a.prototype.readUint32BE=a.prototype.readUInt32BE=function(d,p){return d=d>>>0,p||R(d,4,this.length),this[d]*16777216+(this[d+1]<<16|this[d+2]<<8|this[d+3])},a.prototype.readBigUInt64LE=sr(function(d){d=d>>>0,kr(d,"offset");const p=this[d],k=this[d+7];(p===void 0||k===void 0)&&Pe(d,this.length-8);const B=p+this[++d]*2**8+this[++d]*2**16+this[++d]*2**24,F=this[++d]+this[++d]*2**8+this[++d]*2**16+k*2**24;return BigInt(B)+(BigInt(F)<<BigInt(32))}),a.prototype.readBigUInt64BE=sr(function(d){d=d>>>0,kr(d,"offset");const p=this[d],k=this[d+7];(p===void 0||k===void 0)&&Pe(d,this.length-8);const B=p*2**24+this[++d]*2**16+this[++d]*2**8+this[++d],F=this[++d]*2**24+this[++d]*2**16+this[++d]*2**8+k;return(BigInt(B)<<BigInt(32))+BigInt(F)}),a.prototype.readIntLE=function(d,p,k){d=d>>>0,p=p>>>0,k||R(d,p,this.length);let B=this[d],F=1,q=0;for(;++q<p&&(F*=256);)B+=this[d+q]*F;return F*=128,B>=F&&(B-=Math.pow(2,8*p)),B},a.prototype.readIntBE=function(d,p,k){d=d>>>0,p=p>>>0,k||R(d,p,this.length);let B=p,F=1,q=this[d+--B];for(;B>0&&(F*=256);)q+=this[d+--B]*F;return F*=128,q>=F&&(q-=Math.pow(2,8*p)),q},a.prototype.readInt8=function(d,p){return d=d>>>0,p||R(d,1,this.length),this[d]&128?(255-this[d]+1)*-1:this[d]},a.prototype.readInt16LE=function(d,p){d=d>>>0,p||R(d,2,this.length);const k=this[d]|this[d+1]<<8;return k&32768?k|4294901760:k},a.prototype.readInt16BE=function(d,p){d=d>>>0,p||R(d,2,this.length);const k=this[d+1]|this[d]<<8;return k&32768?k|4294901760:k},a.prototype.readInt32LE=function(d,p){return d=d>>>0,p||R(d,4,this.length),this[d]|this[d+1]<<8|this[d+2]<<16|this[d+3]<<24},a.prototype.readInt32BE=function(d,p){return d=d>>>0,p||R(d,4,this.length),this[d]<<24|this[d+1]<<16|this[d+2]<<8|this[d+3]},a.prototype.readBigInt64LE=sr(function(d){d=d>>>0,kr(d,"offset");const p=this[d],k=this[d+7];(p===void 0||k===void 0)&&Pe(d,this.length-8);const B=this[d+4]+this[d+5]*2**8+this[d+6]*2**16+(k<<24);return(BigInt(B)<<BigInt(32))+BigInt(p+this[++d]*2**8+this[++d]*2**16+this[++d]*2**24)}),a.prototype.readBigInt64BE=sr(function(d){d=d>>>0,kr(d,"offset");const p=this[d],k=this[d+7];(p===void 0||k===void 0)&&Pe(d,this.length-8);const B=(p<<24)+this[++d]*2**16+this[++d]*2**8+this[++d];return(BigInt(B)<<BigInt(32))+BigInt(this[++d]*2**24+this[++d]*2**16+this[++d]*2**8+k)}),a.prototype.readFloatLE=function(d,p){return d=d>>>0,p||R(d,4,this.length),t.read(this,d,!0,23,4)},a.prototype.readFloatBE=function(d,p){return d=d>>>0,p||R(d,4,this.length),t.read(this,d,!1,23,4)},a.prototype.readDoubleLE=function(d,p){return d=d>>>0,p||R(d,8,this.length),t.read(this,d,!0,52,8)},a.prototype.readDoubleBE=function(d,p){return d=d>>>0,p||R(d,8,this.length),t.read(this,d,!1,52,8)};function y(b,d,p,k,B,F){if(!a.isBuffer(b))throw new TypeError('"buffer" argument must be a Buffer instance');if(d>B||d<F)throw new RangeError('"value" argument is out of bounds');if(p+k>b.length)throw new RangeError("Index out of range")}a.prototype.writeUintLE=a.prototype.writeUIntLE=function(d,p,k,B){if(d=+d,p=p>>>0,k=k>>>0,!B){const we=Math.pow(2,8*k)-1;y(this,d,p,k,we,0)}let F=1,q=0;for(this[p]=d&255;++q<k&&(F*=256);)this[p+q]=d/F&255;return p+k},a.prototype.writeUintBE=a.prototype.writeUIntBE=function(d,p,k,B){if(d=+d,p=p>>>0,k=k>>>0,!B){const we=Math.pow(2,8*k)-1;y(this,d,p,k,we,0)}let F=k-1,q=1;for(this[p+F]=d&255;--F>=0&&(q*=256);)this[p+F]=d/q&255;return p+k},a.prototype.writeUint8=a.prototype.writeUInt8=function(d,p,k){return d=+d,p=p>>>0,k||y(this,d,p,1,255,0),this[p]=d&255,p+1},a.prototype.writeUint16LE=a.prototype.writeUInt16LE=function(d,p,k){return d=+d,p=p>>>0,k||y(this,d,p,2,65535,0),this[p]=d&255,this[p+1]=d>>>8,p+2},a.prototype.writeUint16BE=a.prototype.writeUInt16BE=function(d,p,k){return d=+d,p=p>>>0,k||y(this,d,p,2,65535,0),this[p]=d>>>8,this[p+1]=d&255,p+2},a.prototype.writeUint32LE=a.prototype.writeUInt32LE=function(d,p,k){return d=+d,p=p>>>0,k||y(this,d,p,4,4294967295,0),this[p+3]=d>>>24,this[p+2]=d>>>16,this[p+1]=d>>>8,this[p]=d&255,p+4},a.prototype.writeUint32BE=a.prototype.writeUInt32BE=function(d,p,k){return d=+d,p=p>>>0,k||y(this,d,p,4,4294967295,0),this[p]=d>>>24,this[p+1]=d>>>16,this[p+2]=d>>>8,this[p+3]=d&255,p+4};function T(b,d,p,k,B){qe(d,k,B,b,p,7);let F=Number(d&BigInt(4294967295));b[p++]=F,F=F>>8,b[p++]=F,F=F>>8,b[p++]=F,F=F>>8,b[p++]=F;let q=Number(d>>BigInt(32)&BigInt(4294967295));return b[p++]=q,q=q>>8,b[p++]=q,q=q>>8,b[p++]=q,q=q>>8,b[p++]=q,p}function ae(b,d,p,k,B){qe(d,k,B,b,p,7);let F=Number(d&BigInt(4294967295));b[p+7]=F,F=F>>8,b[p+6]=F,F=F>>8,b[p+5]=F,F=F>>8,b[p+4]=F;let q=Number(d>>BigInt(32)&BigInt(4294967295));return b[p+3]=q,q=q>>8,b[p+2]=q,q=q>>8,b[p+1]=q,q=q>>8,b[p]=q,p+8}a.prototype.writeBigUInt64LE=sr(function(d,p=0){return T(this,d,p,BigInt(0),BigInt("0xffffffffffffffff"))}),a.prototype.writeBigUInt64BE=sr(function(d,p=0){return ae(this,d,p,BigInt(0),BigInt("0xffffffffffffffff"))}),a.prototype.writeIntLE=function(d,p,k,B){if(d=+d,p=p>>>0,!B){const ye=Math.pow(2,8*k-1);y(this,d,p,k,ye-1,-ye)}let F=0,q=1,we=0;for(this[p]=d&255;++F<k&&(q*=256);)d<0&&we===0&&this[p+F-1]!==0&&(we=1),this[p+F]=(d/q>>0)-we&255;return p+k},a.prototype.writeIntBE=function(d,p,k,B){if(d=+d,p=p>>>0,!B){const ye=Math.pow(2,8*k-1);y(this,d,p,k,ye-1,-ye)}let F=k-1,q=1,we=0;for(this[p+F]=d&255;--F>=0&&(q*=256);)d<0&&we===0&&this[p+F+1]!==0&&(we=1),this[p+F]=(d/q>>0)-we&255;return p+k},a.prototype.writeInt8=function(d,p,k){return d=+d,p=p>>>0,k||y(this,d,p,1,127,-128),d<0&&(d=255+d+1),this[p]=d&255,p+1},a.prototype.writeInt16LE=function(d,p,k){return d=+d,p=p>>>0,k||y(this,d,p,2,32767,-32768),this[p]=d&255,this[p+1]=d>>>8,p+2},a.prototype.writeInt16BE=function(d,p,k){return d=+d,p=p>>>0,k||y(this,d,p,2,32767,-32768),this[p]=d>>>8,this[p+1]=d&255,p+2},a.prototype.writeInt32LE=function(d,p,k){return d=+d,p=p>>>0,k||y(this,d,p,4,2147483647,-2147483648),this[p]=d&255,this[p+1]=d>>>8,this[p+2]=d>>>16,this[p+3]=d>>>24,p+4},a.prototype.writeInt32BE=function(d,p,k){return d=+d,p=p>>>0,k||y(this,d,p,4,2147483647,-2147483648),d<0&&(d=4294967295+d+1),this[p]=d>>>24,this[p+1]=d>>>16,this[p+2]=d>>>8,this[p+3]=d&255,p+4},a.prototype.writeBigInt64LE=sr(function(d,p=0){return T(this,d,p,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),a.prototype.writeBigInt64BE=sr(function(d,p=0){return ae(this,d,p,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function ne(b,d,p,k,B,F){if(p+k>b.length)throw new RangeError("Index out of range");if(p<0)throw new RangeError("Index out of range")}function le(b,d,p,k,B){return d=+d,p=p>>>0,B||ne(b,d,p,4),t.write(b,d,p,k,23,4),p+4}a.prototype.writeFloatLE=function(d,p,k){return le(this,d,p,!0,k)},a.prototype.writeFloatBE=function(d,p,k){return le(this,d,p,!1,k)};function Fe(b,d,p,k,B){return d=+d,p=p>>>0,B||ne(b,d,p,8),t.write(b,d,p,k,52,8),p+8}a.prototype.writeDoubleLE=function(d,p,k){return Fe(this,d,p,!0,k)},a.prototype.writeDoubleBE=function(d,p,k){return Fe(this,d,p,!1,k)},a.prototype.copy=function(d,p,k,B){if(!a.isBuffer(d))throw new TypeError("argument should be a Buffer");if(k||(k=0),!B&&B!==0&&(B=this.length),p>=d.length&&(p=d.length),p||(p=0),B>0&&B<k&&(B=k),B===k||d.length===0||this.length===0)return 0;if(p<0)throw new RangeError("targetStart out of bounds");if(k<0||k>=this.length)throw new RangeError("Index out of range");if(B<0)throw new RangeError("sourceEnd out of bounds");B>this.length&&(B=this.length),d.length-p<B-k&&(B=d.length-p+k);const F=B-k;return this===d&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(p,k,B):Uint8Array.prototype.set.call(d,this.subarray(k,B),p),F},a.prototype.fill=function(d,p,k,B){if(typeof d=="string"){if(typeof p=="string"?(B=p,p=0,k=this.length):typeof k=="string"&&(B=k,k=this.length),B!==void 0&&typeof B!="string")throw new TypeError("encoding must be a string");if(typeof B=="string"&&!a.isEncoding(B))throw new TypeError("Unknown encoding: "+B);if(d.length===1){const q=d.charCodeAt(0);(B==="utf8"&&q<128||B==="latin1")&&(d=q)}}else typeof d=="number"?d=d&255:typeof d=="boolean"&&(d=Number(d));if(p<0||this.length<p||this.length<k)throw new RangeError("Out of range index");if(k<=p)return this;p=p>>>0,k=k===void 0?this.length:k>>>0,d||(d=0);let F;if(typeof d=="number")for(F=p;F<k;++F)this[F]=d;else{const q=a.isBuffer(d)?d:a.from(d,B),we=q.length;if(we===0)throw new TypeError('The value "'+d+'" is invalid for argument "value"');for(F=0;F<k-p;++F)this[F+p]=q[F%we]}return this};const Ee={};function Ae(b,d,p){Ee[b]=class extends p{constructor(){super(),Object.defineProperty(this,"message",{value:d.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${b}]`,this.stack,delete this.name}get code(){return b}set code(B){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:B,writable:!0})}toString(){return`${this.name} [${b}]: ${this.message}`}}}Ae("ERR_BUFFER_OUT_OF_BOUNDS",function(b){return b?`${b} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),Ae("ERR_INVALID_ARG_TYPE",function(b,d){return`The "${b}" argument must be of type number. Received type ${typeof d}`},TypeError),Ae("ERR_OUT_OF_RANGE",function(b,d,p){let k=`The value of "${b}" is out of range.`,B=p;return Number.isInteger(p)&&Math.abs(p)>2**32?B=Ir(String(p)):typeof p=="bigint"&&(B=String(p),(p>BigInt(2)**BigInt(32)||p<-(BigInt(2)**BigInt(32)))&&(B=Ir(B)),B+="n"),k+=` It must be ${d}. Received ${B}`,k},RangeError);function Ir(b){let d="",p=b.length;const k=b[0]==="-"?1:0;for(;p>=k+4;p-=3)d=`_${b.slice(p-3,p)}${d}`;return`${b.slice(0,p)}${d}`}function Ne(b,d,p){kr(d,"offset"),(b[d]===void 0||b[d+p]===void 0)&&Pe(d,b.length-(p+1))}function qe(b,d,p,k,B,F){if(b>p||b<d){const q=typeof d=="bigint"?"n":"";let we;throw d===0||d===BigInt(0)?we=`>= 0${q} and < 2${q} ** ${(F+1)*8}${q}`:we=`>= -(2${q} ** ${(F+1)*8-1}${q}) and < 2 ** ${(F+1)*8-1}${q}`,new Ee.ERR_OUT_OF_RANGE("value",we,b)}Ne(k,B,F)}function kr(b,d){if(typeof b!="number")throw new Ee.ERR_INVALID_ARG_TYPE(d,"number",b)}function Pe(b,d,p){throw Math.floor(b)!==b?(kr(b,p),new Ee.ERR_OUT_OF_RANGE("offset","an integer",b)):d<0?new Ee.ERR_BUFFER_OUT_OF_BOUNDS:new Ee.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${d}`,b)}const Ye=/[^+/0-9A-Za-z-_]/g;function Bi(b){if(b=b.split("=")[0],b=b.trim().replace(Ye,""),b.length<2)return"";for(;b.length%4!==0;)b=b+"=";return b}function Ke(b,d){d=d||1/0;let p;const k=b.length;let B=null;const F=[];for(let q=0;q<k;++q){if(p=b.charCodeAt(q),p>55295&&p<57344){if(!B){if(p>56319){(d-=3)>-1&&F.push(239,191,189);continue}else if(q+1===k){(d-=3)>-1&&F.push(239,191,189);continue}B=p;continue}if(p<56320){(d-=3)>-1&&F.push(239,191,189),B=p;continue}p=(B-55296<<10|p-56320)+65536}else B&&(d-=3)>-1&&F.push(239,191,189);if(B=null,p<128){if((d-=1)<0)break;F.push(p)}else if(p<2048){if((d-=2)<0)break;F.push(p>>6|192,p&63|128)}else if(p<65536){if((d-=3)<0)break;F.push(p>>12|224,p>>6&63|128,p&63|128)}else if(p<1114112){if((d-=4)<0)break;F.push(p>>18|240,p>>12&63|128,p>>6&63|128,p&63|128)}else throw new Error("Invalid code point")}return F}function Xe(b){const d=[];for(let p=0;p<b.length;++p)d.push(b.charCodeAt(p)&255);return d}function Mi(b,d){let p,k,B;const F=[];for(let q=0;q<b.length&&!((d-=2)<0);++q)p=b.charCodeAt(q),k=p>>8,B=p%256,F.push(B),F.push(k);return F}function Ve(b){return e.toByteArray(Bi(b))}function He(b,d,p,k){let B;for(B=0;B<k&&!(B+p>=d.length||B>=b.length);++B)d[B+p]=b[B];return B}function Wt(b,d){return b instanceof d||b!=null&&b.constructor!=null&&b.constructor.name!=null&&b.constructor.name===d.name}function We(b){return b!==b}const Je=function(){const b="0123456789abcdef",d=new Array(256);for(let p=0;p<16;++p){const k=p*16;for(let B=0;B<16;++B)d[k+B]=b[p]+b[B]}return d}();function sr(b){return typeof BigInt>"u"?Qe:b}function Qe(){throw new Error("BigInt not supported")}})(te);const Sn=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */function la(n){return n instanceof Uint8Array||ArrayBuffer.isView(n)&&n.constructor.name==="Uint8Array"}function yi(n){if(!Number.isSafeInteger(n)||n<0)throw new Error("positive integer expected, got "+n)}function rr(n,...e){if(!la(n))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(n.length))throw new Error("Uint8Array expected of length "+e+", got length="+n.length)}function gp(n){if(typeof n!="function"||typeof n.create!="function")throw new Error("Hash should be wrapped by utils.createHasher");yi(n.outputLen),yi(n.blockLen)}function Fn(n,e=!0){if(n.destroyed)throw new Error("Hash instance has been destroyed");if(e&&n.finished)throw new Error("Hash#digest() has already been called")}function Ku(n,e){rr(n);const t=e.outputLen;if(n.length<t)throw new Error("digestInto() expects output buffer of length at least "+t)}function mp(n){return new Uint32Array(n.buffer,n.byteOffset,Math.floor(n.byteLength/4))}function en(...n){for(let e=0;e<n.length;e++)n[e].fill(0)}function lo(n){return new DataView(n.buffer,n.byteOffset,n.byteLength)}function hr(n,e){return n<<32-e|n>>>e}const wp=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function _p(n){return n<<24&4278190080|n<<8&16711680|n>>>8&65280|n>>>24&255}function bp(n){for(let e=0;e<n.length;e++)n[e]=_p(n[e]);return n}const fc=wp?n=>n:bp,Wu=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",Ep=Array.from({length:256},(n,e)=>e.toString(16).padStart(2,"0"));function Hn(n){if(rr(n),Wu)return n.toHex();let e="";for(let t=0;t<n.length;t++)e+=Ep[n[t]];return e}const Tr={_0:48,_9:57,A:65,F:70,a:97,f:102};function dc(n){if(n>=Tr._0&&n<=Tr._9)return n-Tr._0;if(n>=Tr.A&&n<=Tr.F)return n-(Tr.A-10);if(n>=Tr.a&&n<=Tr.f)return n-(Tr.a-10)}function ha(n){if(typeof n!="string")throw new Error("hex string expected, got "+typeof n);if(Wu)return Uint8Array.fromHex(n);const e=n.length,t=e/2;if(e%2)throw new Error("hex string expected, got unpadded hex of length "+e);const r=new Uint8Array(t);for(let i=0,s=0;i<t;i++,s+=2){const o=dc(n.charCodeAt(s)),a=dc(n.charCodeAt(s+1));if(o===void 0||a===void 0){const u=n[s]+n[s+1];throw new Error('hex string expected, got non-hex character "'+u+'" at index '+s)}r[i]=o*16+a}return r}function Rp(n){if(typeof n!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(n))}function ws(n){return typeof n=="string"&&(n=Rp(n)),rr(n),n}function Dr(...n){let e=0;for(let r=0;r<n.length;r++){const i=n[r];rr(i),e+=i.length}const t=new Uint8Array(e);for(let r=0,i=0;r<n.length;r++){const s=n[r];t.set(s,i),i+=s.length}return t}class fa{}function da(n){const e=r=>n().update(ws(r)).digest(),t=n();return e.outputLen=t.outputLen,e.blockLen=t.blockLen,e.create=()=>n(),e}function Gu(n=32){if(Sn&&typeof Sn.getRandomValues=="function")return Sn.getRandomValues(new Uint8Array(n));if(Sn&&typeof Sn.randomBytes=="function")return Uint8Array.from(Sn.randomBytes(n));throw new Error("crypto.getRandomValues must be defined")}function Ap(n,e,t,r){if(typeof n.setBigUint64=="function")return n.setBigUint64(e,t,r);const i=BigInt(32),s=BigInt(4294967295),o=Number(t>>i&s),a=Number(t&s),u=r?4:0,l=r?0:4;n.setUint32(e+u,o,r),n.setUint32(e+l,a,r)}function vp(n,e,t){return n&e^~n&t}function Sp(n,e,t){return n&e^n&t^e&t}class qu extends fa{constructor(e,t,r,i){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=e,this.outputLen=t,this.padOffset=r,this.isLE=i,this.buffer=new Uint8Array(e),this.view=lo(this.buffer)}update(e){Fn(this),e=ws(e),rr(e);const{view:t,buffer:r,blockLen:i}=this,s=e.length;for(let o=0;o<s;){const a=Math.min(i-this.pos,s-o);if(a===i){const u=lo(e);for(;i<=s-o;o+=i)this.process(u,o);continue}r.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===i&&(this.process(t,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){Fn(this),Ku(e,this),this.finished=!0;const{buffer:t,view:r,blockLen:i,isLE:s}=this;let{pos:o}=this;t[o++]=128,en(this.buffer.subarray(o)),this.padOffset>i-o&&(this.process(r,0),o=0);for(let _=o;_<i;_++)t[_]=0;Ap(r,i-8,BigInt(this.length*8),s),this.process(r,0);const a=lo(e),u=this.outputLen;if(u%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const l=u/4,f=this.get();if(l>f.length)throw new Error("_sha2: outputLen bigger than state");for(let _=0;_<l;_++)a.setUint32(4*_,f[_],s)}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const r=e.slice(0,t);return this.destroy(),r}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:t,buffer:r,length:i,finished:s,destroyed:o,pos:a}=this;return e.destroyed=o,e.finished=s,e.length=i,e.pos=a,i%t&&e.buffer.set(r),e}clone(){return this._cloneInto()}}const zr=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),xt=Uint32Array.from([1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209]),Li=BigInt(2**32-1),pc=BigInt(32);function Ip(n,e=!1){return e?{h:Number(n&Li),l:Number(n>>pc&Li)}:{h:Number(n>>pc&Li)|0,l:Number(n&Li)|0}}function Vu(n,e=!1){const t=n.length;let r=new Uint32Array(t),i=new Uint32Array(t);for(let s=0;s<t;s++){const{h:o,l:a}=Ip(n[s],e);[r[s],i[s]]=[o,a]}return[r,i]}const yc=(n,e,t)=>n>>>t,gc=(n,e,t)=>n<<32-t|e>>>t,In=(n,e,t)=>n>>>t|e<<32-t,kn=(n,e,t)=>n<<32-t|e>>>t,Pi=(n,e,t)=>n<<64-t|e>>>t-32,Ui=(n,e,t)=>n>>>t-32|e<<64-t,kp=(n,e,t)=>n<<t|e>>>32-t,Tp=(n,e,t)=>e<<t|n>>>32-t,xp=(n,e,t)=>e<<t-32|n>>>64-t,Op=(n,e,t)=>n<<t-32|e>>>64-t;function xr(n,e,t,r){const i=(e>>>0)+(r>>>0);return{h:n+t+(i/2**32|0)|0,l:i|0}}const Np=(n,e,t)=>(n>>>0)+(e>>>0)+(t>>>0),Cp=(n,e,t,r)=>e+t+r+(n/2**32|0)|0,Bp=(n,e,t,r)=>(n>>>0)+(e>>>0)+(t>>>0)+(r>>>0),Mp=(n,e,t,r,i)=>e+t+r+i+(n/2**32|0)|0,Lp=(n,e,t,r,i)=>(n>>>0)+(e>>>0)+(t>>>0)+(r>>>0)+(i>>>0),Pp=(n,e,t,r,i,s)=>e+t+r+i+s+(n/2**32|0)|0,Up=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),$r=new Uint32Array(64);class Dp extends qu{constructor(e=32){super(64,e,8,!1),this.A=zr[0]|0,this.B=zr[1]|0,this.C=zr[2]|0,this.D=zr[3]|0,this.E=zr[4]|0,this.F=zr[5]|0,this.G=zr[6]|0,this.H=zr[7]|0}get(){const{A:e,B:t,C:r,D:i,E:s,F:o,G:a,H:u}=this;return[e,t,r,i,s,o,a,u]}set(e,t,r,i,s,o,a,u){this.A=e|0,this.B=t|0,this.C=r|0,this.D=i|0,this.E=s|0,this.F=o|0,this.G=a|0,this.H=u|0}process(e,t){for(let _=0;_<16;_++,t+=4)$r[_]=e.getUint32(t,!1);for(let _=16;_<64;_++){const I=$r[_-15],g=$r[_-2],v=hr(I,7)^hr(I,18)^I>>>3,x=hr(g,17)^hr(g,19)^g>>>10;$r[_]=x+$r[_-7]+v+$r[_-16]|0}let{A:r,B:i,C:s,D:o,E:a,F:u,G:l,H:f}=this;for(let _=0;_<64;_++){const I=hr(a,6)^hr(a,11)^hr(a,25),g=f+I+vp(a,u,l)+Up[_]+$r[_]|0,x=(hr(r,2)^hr(r,13)^hr(r,22))+Sp(r,i,s)|0;f=l,l=u,u=a,a=o+g|0,o=s,s=i,i=r,r=g+x|0}r=r+this.A|0,i=i+this.B|0,s=s+this.C|0,o=o+this.D|0,a=a+this.E|0,u=u+this.F|0,l=l+this.G|0,f=f+this.H|0,this.set(r,i,s,o,a,u,l,f)}roundClean(){en($r)}destroy(){this.set(0,0,0,0,0,0,0,0),en(this.buffer)}}const ju=Vu(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(n=>BigInt(n))),Fp=ju[0],Hp=ju[1],Kr=new Uint32Array(80),Wr=new Uint32Array(80);class zp extends qu{constructor(e=64){super(128,e,16,!1),this.Ah=xt[0]|0,this.Al=xt[1]|0,this.Bh=xt[2]|0,this.Bl=xt[3]|0,this.Ch=xt[4]|0,this.Cl=xt[5]|0,this.Dh=xt[6]|0,this.Dl=xt[7]|0,this.Eh=xt[8]|0,this.El=xt[9]|0,this.Fh=xt[10]|0,this.Fl=xt[11]|0,this.Gh=xt[12]|0,this.Gl=xt[13]|0,this.Hh=xt[14]|0,this.Hl=xt[15]|0}get(){const{Ah:e,Al:t,Bh:r,Bl:i,Ch:s,Cl:o,Dh:a,Dl:u,Eh:l,El:f,Fh:_,Fl:I,Gh:g,Gl:v,Hh:x,Hl:A}=this;return[e,t,r,i,s,o,a,u,l,f,_,I,g,v,x,A]}set(e,t,r,i,s,o,a,u,l,f,_,I,g,v,x,A){this.Ah=e|0,this.Al=t|0,this.Bh=r|0,this.Bl=i|0,this.Ch=s|0,this.Cl=o|0,this.Dh=a|0,this.Dl=u|0,this.Eh=l|0,this.El=f|0,this.Fh=_|0,this.Fl=I|0,this.Gh=g|0,this.Gl=v|0,this.Hh=x|0,this.Hl=A|0}process(e,t){for(let P=0;P<16;P++,t+=4)Kr[P]=e.getUint32(t),Wr[P]=e.getUint32(t+=4);for(let P=16;P<80;P++){const $=Kr[P-15]|0,L=Wr[P-15]|0,X=In($,L,1)^In($,L,8)^yc($,L,7),V=kn($,L,1)^kn($,L,8)^gc($,L,7),Y=Kr[P-2]|0,U=Wr[P-2]|0,G=In(Y,U,19)^Pi(Y,U,61)^yc(Y,U,6),M=kn(Y,U,19)^Ui(Y,U,61)^gc(Y,U,6),D=Bp(V,M,Wr[P-7],Wr[P-16]),w=Mp(D,X,G,Kr[P-7],Kr[P-16]);Kr[P]=w|0,Wr[P]=D|0}let{Ah:r,Al:i,Bh:s,Bl:o,Ch:a,Cl:u,Dh:l,Dl:f,Eh:_,El:I,Fh:g,Fl:v,Gh:x,Gl:A,Hh:N,Hl:K}=this;for(let P=0;P<80;P++){const $=In(_,I,14)^In(_,I,18)^Pi(_,I,41),L=kn(_,I,14)^kn(_,I,18)^Ui(_,I,41),X=_&g^~_&x,V=I&v^~I&A,Y=Lp(K,L,V,Hp[P],Wr[P]),U=Pp(Y,N,$,X,Fp[P],Kr[P]),G=Y|0,M=In(r,i,28)^Pi(r,i,34)^Pi(r,i,39),D=kn(r,i,28)^Ui(r,i,34)^Ui(r,i,39),w=r&s^r&a^s&a,c=i&o^i&u^o&u;N=x|0,K=A|0,x=g|0,A=v|0,g=_|0,v=I|0,{h:_,l:I}=xr(l|0,f|0,U|0,G|0),l=a|0,f=u|0,a=s|0,u=o|0,s=r|0,o=i|0;const h=Np(G,D,c);r=Cp(h,U,M,w),i=h|0}({h:r,l:i}=xr(this.Ah|0,this.Al|0,r|0,i|0)),{h:s,l:o}=xr(this.Bh|0,this.Bl|0,s|0,o|0),{h:a,l:u}=xr(this.Ch|0,this.Cl|0,a|0,u|0),{h:l,l:f}=xr(this.Dh|0,this.Dl|0,l|0,f|0),{h:_,l:I}=xr(this.Eh|0,this.El|0,_|0,I|0),{h:g,l:v}=xr(this.Fh|0,this.Fl|0,g|0,v|0),{h:x,l:A}=xr(this.Gh|0,this.Gl|0,x|0,A|0),{h:N,l:K}=xr(this.Hh|0,this.Hl|0,N|0,K|0),this.set(r,i,s,o,a,u,l,f,_,I,g,v,x,A,N,K)}roundClean(){en(Kr,Wr)}destroy(){en(this.buffer),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const Zu=da(()=>new Dp),$p=da(()=>new zp);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const pa=BigInt(0),Ko=BigInt(1);function pn(n,e){if(typeof e!="boolean")throw new Error(n+" boolean expected, got "+e)}function Di(n){const e=n.toString(16);return e.length&1?"0"+e:e}function Yu(n){if(typeof n!="string")throw new Error("hex string expected, got "+typeof n);return n===""?pa:BigInt("0x"+n)}function _s(n){return Yu(Hn(n))}function gi(n){return rr(n),Yu(Hn(Uint8Array.from(n).reverse()))}function ya(n,e){return ha(n.toString(16).padStart(e*2,"0"))}function bs(n,e){return ya(n,e).reverse()}function rt(n,e,t){let r;if(typeof e=="string")try{r=ha(e)}catch(s){throw new Error(n+" must be hex string or Uint8Array, cause: "+s)}else if(la(e))r=Uint8Array.from(e);else throw new Error(n+" must be hex string or Uint8Array");const i=r.length;if(typeof t=="number"&&i!==t)throw new Error(n+" of length "+t+" expected, got "+i);return r}const ho=n=>typeof n=="bigint"&&pa<=n;function Kp(n,e,t){return ho(n)&&ho(e)&&ho(t)&&e<=n&&n<t}function Cn(n,e,t,r){if(!Kp(e,t,r))throw new Error("expected valid "+n+": "+t+" <= n < "+r+", got "+e)}function Wp(n){let e;for(e=0;n>pa;n>>=Ko,e+=1);return e}const Es=n=>(Ko<<BigInt(n))-Ko;function Gp(n,e,t){if(typeof n!="number"||n<2)throw new Error("hashLen must be a number");if(typeof e!="number"||e<2)throw new Error("qByteLen must be a number");if(typeof t!="function")throw new Error("hmacFn must be a function");const r=g=>new Uint8Array(g),i=g=>Uint8Array.of(g);let s=r(n),o=r(n),a=0;const u=()=>{s.fill(1),o.fill(0),a=0},l=(...g)=>t(o,s,...g),f=(g=r(0))=>{o=l(i(0),g),s=l(),g.length!==0&&(o=l(i(1),g),s=l())},_=()=>{if(a++>=1e3)throw new Error("drbg: tried 1000 values");let g=0;const v=[];for(;g<e;){s=l();const x=s.slice();v.push(x),g+=s.length}return Dr(...v)};return(g,v)=>{u(),f(g);let x;for(;!(x=v(_()));)f();return u(),x}}function Ai(n,e,t={}){if(!n||typeof n!="object")throw new Error("expected valid options object");function r(i,s,o){const a=n[i];if(o&&a===void 0)return;const u=typeof a;if(u!==s||a===null)throw new Error(`param "${i}" is invalid: expected ${s}, got ${u}`)}Object.entries(e).forEach(([i,s])=>r(i,s,!1)),Object.entries(t).forEach(([i,s])=>r(i,s,!0))}function rs(n){const e=new WeakMap;return(t,...r)=>{const i=e.get(t);if(i!==void 0)return i;const s=n(t,...r);return e.set(t,s),s}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const $t=BigInt(0),Tt=BigInt(1),un=BigInt(2),qp=BigInt(3),Xu=BigInt(4),Ju=BigInt(5),Qu=BigInt(8);function nt(n,e){const t=n%e;return t>=$t?t:e+t}function et(n,e,t){let r=n;for(;e-- >$t;)r*=r,r%=t;return r}function mc(n,e){if(n===$t)throw new Error("invert: expected non-zero number");if(e<=$t)throw new Error("invert: expected positive modulus, got "+e);let t=nt(n,e),r=e,i=$t,s=Tt;for(;t!==$t;){const a=r/t,u=r%t,l=i-s*a;r=t,t=u,i=s,s=l}if(r!==Tt)throw new Error("invert: does not exist");return nt(i,e)}function el(n,e){const t=(n.ORDER+Tt)/Xu,r=n.pow(e,t);if(!n.eql(n.sqr(r),e))throw new Error("Cannot find square root");return r}function Vp(n,e){const t=(n.ORDER-Ju)/Qu,r=n.mul(e,un),i=n.pow(r,t),s=n.mul(e,i),o=n.mul(n.mul(s,un),i),a=n.mul(s,n.sub(o,n.ONE));if(!n.eql(n.sqr(a),e))throw new Error("Cannot find square root");return a}function jp(n){if(n<BigInt(3))throw new Error("sqrt is not defined for small field");let e=n-Tt,t=0;for(;e%un===$t;)e/=un,t++;let r=un;const i=jn(n);for(;wc(i,r)===1;)if(r++>1e3)throw new Error("Cannot find square root: probably non-prime P");if(t===1)return el;let s=i.pow(r,e);const o=(e+Tt)/un;return function(u,l){if(u.is0(l))return l;if(wc(u,l)!==1)throw new Error("Cannot find square root");let f=t,_=u.mul(u.ONE,s),I=u.pow(l,e),g=u.pow(l,o);for(;!u.eql(I,u.ONE);){if(u.is0(I))return u.ZERO;let v=1,x=u.sqr(I);for(;!u.eql(x,u.ONE);)if(v++,x=u.sqr(x),v===f)throw new Error("Cannot find square root");const A=Tt<<BigInt(f-v-1),N=u.pow(_,A);f=v,_=u.sqr(N),I=u.mul(I,_),g=u.mul(g,N)}return g}}function Zp(n){return n%Xu===qp?el:n%Qu===Ju?Vp:jp(n)}const Yp=(n,e)=>(nt(n,e)&Tt)===Tt,Xp=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function Jp(n){const e={ORDER:"bigint",MASK:"bigint",BYTES:"number",BITS:"number"},t=Xp.reduce((r,i)=>(r[i]="function",r),e);return Ai(n,t),n}function Qp(n,e,t){if(t<$t)throw new Error("invalid exponent, negatives unsupported");if(t===$t)return n.ONE;if(t===Tt)return e;let r=n.ONE,i=e;for(;t>$t;)t&Tt&&(r=n.mul(r,i)),i=n.sqr(i),t>>=Tt;return r}function tl(n,e,t=!1){const r=new Array(e.length).fill(t?n.ZERO:void 0),i=e.reduce((o,a,u)=>n.is0(a)?o:(r[u]=o,n.mul(o,a)),n.ONE),s=n.inv(i);return e.reduceRight((o,a,u)=>n.is0(a)?o:(r[u]=n.mul(o,r[u]),n.mul(o,a)),s),r}function wc(n,e){const t=(n.ORDER-Tt)/un,r=n.pow(e,t),i=n.eql(r,n.ONE),s=n.eql(r,n.ZERO),o=n.eql(r,n.neg(n.ONE));if(!i&&!s&&!o)throw new Error("invalid Legendre symbol result");return i?1:s?0:-1}function e0(n,e){e!==void 0&&yi(e);const t=e!==void 0?e:n.toString(2).length,r=Math.ceil(t/8);return{nBitLength:t,nByteLength:r}}function jn(n,e,t=!1,r={}){if(n<=$t)throw new Error("invalid field: expected ORDER > 0, got "+n);let i,s;if(typeof e=="object"&&e!=null){if(r.sqrt||t)throw new Error("cannot specify opts in two arguments");const f=e;f.BITS&&(i=f.BITS),f.sqrt&&(s=f.sqrt),typeof f.isLE=="boolean"&&(t=f.isLE)}else typeof e=="number"&&(i=e),r.sqrt&&(s=r.sqrt);const{nBitLength:o,nByteLength:a}=e0(n,i);if(a>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let u;const l=Object.freeze({ORDER:n,isLE:t,BITS:o,BYTES:a,MASK:Es(o),ZERO:$t,ONE:Tt,create:f=>nt(f,n),isValid:f=>{if(typeof f!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof f);return $t<=f&&f<n},is0:f=>f===$t,isValidNot0:f=>!l.is0(f)&&l.isValid(f),isOdd:f=>(f&Tt)===Tt,neg:f=>nt(-f,n),eql:(f,_)=>f===_,sqr:f=>nt(f*f,n),add:(f,_)=>nt(f+_,n),sub:(f,_)=>nt(f-_,n),mul:(f,_)=>nt(f*_,n),pow:(f,_)=>Qp(l,f,_),div:(f,_)=>nt(f*mc(_,n),n),sqrN:f=>f*f,addN:(f,_)=>f+_,subN:(f,_)=>f-_,mulN:(f,_)=>f*_,inv:f=>mc(f,n),sqrt:s||(f=>(u||(u=Zp(n)),u(l,f))),toBytes:f=>t?bs(f,a):ya(f,a),fromBytes:f=>{if(f.length!==a)throw new Error("Field.fromBytes: expected "+a+" bytes, got "+f.length);return t?gi(f):_s(f)},invertBatch:f=>tl(l,f),cmov:(f,_,I)=>I?_:f});return Object.freeze(l)}function rl(n){if(typeof n!="bigint")throw new Error("field order must be bigint");const e=n.toString(2).length;return Math.ceil(e/8)}function nl(n){const e=rl(n);return e+Math.ceil(e/2)}function t0(n,e,t=!1){const r=n.length,i=rl(e),s=nl(e);if(r<16||r<s||r>1024)throw new Error("expected "+s+"-1024 bytes of input, got "+r);const o=t?gi(n):_s(n),a=nt(o,e-Tt)+Tt;return t?bs(a,i):ya(a,i)}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const zn=BigInt(0),ln=BigInt(1);function ci(n,e){const t=e.negate();return n?t:e}function il(n,e,t){const r=e==="pz"?o=>o.pz:o=>o.ez,i=tl(n.Fp,t.map(r));return t.map((o,a)=>o.toAffine(i[a])).map(n.fromAffine)}function sl(n,e){if(!Number.isSafeInteger(n)||n<=0||n>e)throw new Error("invalid window size, expected [1.."+e+"], got W="+n)}function fo(n,e){sl(n,e);const t=Math.ceil(e/n)+1,r=2**(n-1),i=2**n,s=Es(n),o=BigInt(n);return{windows:t,windowSize:r,mask:s,maxNumber:i,shiftBy:o}}function _c(n,e,t){const{windowSize:r,mask:i,maxNumber:s,shiftBy:o}=t;let a=Number(n&i),u=n>>o;a>r&&(a-=s,u+=ln);const l=e*r,f=l+Math.abs(a)-1,_=a===0,I=a<0,g=e%2!==0;return{nextN:u,offset:f,isZero:_,isNeg:I,isNegF:g,offsetF:l}}function r0(n,e){if(!Array.isArray(n))throw new Error("array expected");n.forEach((t,r)=>{if(!(t instanceof e))throw new Error("invalid point at index "+r)})}function n0(n,e){if(!Array.isArray(n))throw new Error("array of scalars expected");n.forEach((t,r)=>{if(!e.isValid(t))throw new Error("invalid scalar at index "+r)})}const po=new WeakMap,ol=new WeakMap;function yo(n){return ol.get(n)||1}function bc(n){if(n!==zn)throw new Error("invalid wNAF")}function al(n,e){return{constTimeNegate:ci,hasPrecomputes(t){return yo(t)!==1},unsafeLadder(t,r,i=n.ZERO){let s=t;for(;r>zn;)r&ln&&(i=i.add(s)),s=s.double(),r>>=ln;return i},precomputeWindow(t,r){const{windows:i,windowSize:s}=fo(r,e),o=[];let a=t,u=a;for(let l=0;l<i;l++){u=a,o.push(u);for(let f=1;f<s;f++)u=u.add(a),o.push(u);a=u.double()}return o},wNAF(t,r,i){let s=n.ZERO,o=n.BASE;const a=fo(t,e);for(let u=0;u<a.windows;u++){const{nextN:l,offset:f,isZero:_,isNeg:I,isNegF:g,offsetF:v}=_c(i,u,a);i=l,_?o=o.add(ci(g,r[v])):s=s.add(ci(I,r[f]))}return bc(i),{p:s,f:o}},wNAFUnsafe(t,r,i,s=n.ZERO){const o=fo(t,e);for(let a=0;a<o.windows&&i!==zn;a++){const{nextN:u,offset:l,isZero:f,isNeg:_}=_c(i,a,o);if(i=u,!f){const I=r[l];s=s.add(_?I.negate():I)}}return bc(i),s},getPrecomputes(t,r,i){let s=po.get(r);return s||(s=this.precomputeWindow(r,t),t!==1&&(typeof i=="function"&&(s=i(s)),po.set(r,s))),s},wNAFCached(t,r,i){const s=yo(t);return this.wNAF(s,this.getPrecomputes(s,t,i),r)},wNAFCachedUnsafe(t,r,i,s){const o=yo(t);return o===1?this.unsafeLadder(t,r,s):this.wNAFUnsafe(o,this.getPrecomputes(o,t,i),r,s)},setWindowSize(t,r){sl(r,e),ol.set(t,r),po.delete(t)}}}function i0(n,e,t,r){let i=e,s=n.ZERO,o=n.ZERO;for(;t>zn||r>zn;)t&ln&&(s=s.add(i)),r&ln&&(o=o.add(i)),i=i.double(),t>>=ln,r>>=ln;return{p1:s,p2:o}}function cl(n,e,t,r){r0(t,n),n0(r,e);const i=t.length,s=r.length;if(i!==s)throw new Error("arrays of points and scalars must have equal length");const o=n.ZERO,a=Wp(BigInt(i));let u=1;a>12?u=a-3:a>4?u=a-2:a>0&&(u=2);const l=Es(u),f=new Array(Number(l)+1).fill(o),_=Math.floor((e.BITS-1)/u)*u;let I=o;for(let g=_;g>=0;g-=u){f.fill(o);for(let x=0;x<s;x++){const A=r[x],N=Number(A>>BigInt(g)&l);f[N]=f[N].add(t[x])}let v=o;for(let x=f.length-1,A=o;x>0;x--)A=A.add(f[x]),v=v.add(A);if(I=I.add(v),g!==0)for(let x=0;x<u;x++)I=I.double()}return I}function Ec(n,e){if(e){if(e.ORDER!==n)throw new Error("Field.ORDER must match order: Fp == p, Fn == n");return Jp(e),e}else return jn(n)}function ul(n,e,t={}){if(!e||typeof e!="object")throw new Error(`expected valid ${n} CURVE object`);for(const a of["p","n","h"]){const u=e[a];if(!(typeof u=="bigint"&&u>zn))throw new Error(`CURVE.${a} must be positive bigint`)}const r=Ec(e.p,t.Fp),i=Ec(e.n,t.Fn),o=["Gx","Gy","a",n==="weierstrass"?"b":"d"];for(const a of o)if(!r.isValid(e[a]))throw new Error(`CURVE.${a} must be valid field element of CURVE.Fp`);return{Fp:r,Fn:i}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const pr=BigInt(0),Lt=BigInt(1),go=BigInt(2),s0=BigInt(8),o0={zip215:!0};function a0(n,e,t,r){const i=n.sqr(t),s=n.sqr(r),o=n.add(n.mul(e.a,i),s),a=n.add(n.ONE,n.mul(e.d,n.mul(i,s)));return n.eql(o,a)}function c0(n,e={}){const{Fp:t,Fn:r}=ul("edwards",n,e),{h:i,n:s}=n;Ai(e,{},{uvRatio:"function"});const o=go<<BigInt(r.BYTES*8)-Lt,a=x=>t.create(x),u=e.uvRatio||((x,A)=>{try{return{isValid:!0,value:t.sqrt(t.div(x,A))}}catch{return{isValid:!1,value:pr}}});if(!a0(t,n,n.Gx,n.Gy))throw new Error("bad curve params: generator point");function l(x,A,N=!1){const K=N?Lt:pr;return Cn("coordinate "+x,A,K,o),A}function f(x){if(!(x instanceof g))throw new Error("ExtendedPoint expected")}const _=rs((x,A)=>{const{ex:N,ey:K,ez:P}=x,$=x.is0();A==null&&(A=$?s0:t.inv(P));const L=a(N*A),X=a(K*A),V=a(P*A);if($)return{x:pr,y:Lt};if(V!==Lt)throw new Error("invZ was invalid");return{x:L,y:X}}),I=rs(x=>{const{a:A,d:N}=n;if(x.is0())throw new Error("bad point: ZERO");const{ex:K,ey:P,ez:$,et:L}=x,X=a(K*K),V=a(P*P),Y=a($*$),U=a(Y*Y),G=a(X*A),M=a(Y*a(G+V)),D=a(U+a(N*a(X*V)));if(M!==D)throw new Error("bad point: equation left != right (1)");const w=a(K*P),c=a($*L);if(w!==c)throw new Error("bad point: equation left != right (2)");return!0});class g{constructor(A,N,K,P){this.ex=l("x",A),this.ey=l("y",N),this.ez=l("z",K,!0),this.et=l("t",P),Object.freeze(this)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(A){if(A instanceof g)throw new Error("extended point not allowed");const{x:N,y:K}=A||{};return l("x",N),l("y",K),new g(N,K,Lt,a(N*K))}static normalizeZ(A){return il(g,"ez",A)}static msm(A,N){return cl(g,r,A,N)}_setWindowSize(A){this.precompute(A)}precompute(A=8,N=!0){return v.setWindowSize(this,A),N||this.multiply(go),this}assertValidity(){I(this)}equals(A){f(A);const{ex:N,ey:K,ez:P}=this,{ex:$,ey:L,ez:X}=A,V=a(N*X),Y=a($*P),U=a(K*X),G=a(L*P);return V===Y&&U===G}is0(){return this.equals(g.ZERO)}negate(){return new g(a(-this.ex),this.ey,this.ez,a(-this.et))}double(){const{a:A}=n,{ex:N,ey:K,ez:P}=this,$=a(N*N),L=a(K*K),X=a(go*a(P*P)),V=a(A*$),Y=N+K,U=a(a(Y*Y)-$-L),G=V+L,M=G-X,D=V-L,w=a(U*M),c=a(G*D),h=a(U*D),m=a(M*G);return new g(w,c,m,h)}add(A){f(A);const{a:N,d:K}=n,{ex:P,ey:$,ez:L,et:X}=this,{ex:V,ey:Y,ez:U,et:G}=A,M=a(P*V),D=a($*Y),w=a(X*K*G),c=a(L*U),h=a((P+$)*(V+Y)-M-D),m=c-w,E=c+w,S=a(D-N*M),O=a(h*m),C=a(E*S),R=a(h*S),y=a(m*E);return new g(O,C,y,R)}subtract(A){return this.add(A.negate())}multiply(A){const N=A;Cn("scalar",N,Lt,s);const{p:K,f:P}=v.wNAFCached(this,N,g.normalizeZ);return g.normalizeZ([K,P])[0]}multiplyUnsafe(A,N=g.ZERO){const K=A;return Cn("scalar",K,pr,s),K===pr?g.ZERO:this.is0()||K===Lt?this:v.wNAFCachedUnsafe(this,K,g.normalizeZ,N)}isSmallOrder(){return this.multiplyUnsafe(i).is0()}isTorsionFree(){return v.wNAFCachedUnsafe(this,s).is0()}toAffine(A){return _(this,A)}clearCofactor(){return i===Lt?this:this.multiplyUnsafe(i)}static fromBytes(A,N=!1){return rr(A),this.fromHex(A,N)}static fromHex(A,N=!1){const{d:K,a:P}=n,$=t.BYTES;A=rt("pointHex",A,$),pn("zip215",N);const L=A.slice(),X=A[$-1];L[$-1]=X&-129;const V=gi(L),Y=N?o:t.ORDER;Cn("pointHex.y",V,pr,Y);const U=a(V*V),G=a(U-Lt),M=a(K*U-P);let{isValid:D,value:w}=u(G,M);if(!D)throw new Error("Point.fromHex: invalid y coordinate");const c=(w&Lt)===Lt,h=(X&128)!==0;if(!N&&w===pr&&h)throw new Error("Point.fromHex: x=0 and x_0=1");return h!==c&&(w=a(-w)),g.fromAffine({x:w,y:V})}static fromPrivateScalar(A){return g.BASE.multiply(A)}toBytes(){const{x:A,y:N}=this.toAffine(),K=bs(N,t.BYTES);return K[K.length-1]|=A&Lt?128:0,K}toRawBytes(){return this.toBytes()}toHex(){return Hn(this.toBytes())}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}}g.BASE=new g(n.Gx,n.Gy,Lt,a(n.Gx*n.Gy)),g.ZERO=new g(pr,Lt,Lt,pr),g.Fp=t,g.Fn=r;const v=al(g,r.BYTES*8);return g}function u0(n,e){Ai(e,{hash:"function"},{adjustScalarBytes:"function",randomBytes:"function",domain:"function",prehash:"function",mapToCurve:"function"});const{prehash:t,hash:r}=e,{BASE:i,Fp:s,Fn:o}=n,a=o.ORDER,u=e.randomBytes||Gu,l=e.adjustScalarBytes||(L=>L),f=e.domain||((L,X,V)=>{if(pn("phflag",V),X.length||V)throw new Error("Contexts/pre-hash are not supported");return L});function _(L){return o.create(L)}function I(L){return _(gi(L))}function g(L){const X=s.BYTES;L=rt("private key",L,X);const V=rt("hashed private key",r(L),2*X),Y=l(V.slice(0,X)),U=V.slice(X,2*X),G=I(Y);return{head:Y,prefix:U,scalar:G}}function v(L){const{head:X,prefix:V,scalar:Y}=g(L),U=i.multiply(Y),G=U.toBytes();return{head:X,prefix:V,scalar:Y,point:U,pointBytes:G}}function x(L){return v(L).pointBytes}function A(L=Uint8Array.of(),...X){const V=Dr(...X);return I(r(f(V,rt("context",L),!!t)))}function N(L,X,V={}){L=rt("message",L),t&&(L=t(L));const{prefix:Y,scalar:U,pointBytes:G}=v(X),M=A(V.context,Y,L),D=i.multiply(M).toBytes(),w=A(V.context,D,G,L),c=_(M+w*U);Cn("signature.s",c,pr,a);const h=s.BYTES,m=Dr(D,bs(c,h));return rt("result",m,h*2)}const K=o0;function P(L,X,V,Y=K){const{context:U,zip215:G}=Y,M=s.BYTES;L=rt("signature",L,2*M),X=rt("message",X),V=rt("publicKey",V,M),G!==void 0&&pn("zip215",G),t&&(X=t(X));const D=gi(L.slice(M,2*M));let w,c,h;try{w=n.fromHex(V,G),c=n.fromHex(L.slice(0,M),G),h=i.multiplyUnsafe(D)}catch{return!1}if(!G&&w.isSmallOrder())return!1;const m=A(U,c.toBytes(),w.toBytes(),X);return c.add(w.multiplyUnsafe(m)).subtract(h).clearCofactor().is0()}return i.precompute(8),{getPublicKey:x,sign:N,verify:P,utils:{getExtendedPublicKey:v,randomPrivateKey:()=>u(s.BYTES),precompute(L=8,X=n.BASE){return X.precompute(L,!1)}},Point:n}}function l0(n){const e={a:n.a,d:n.d,p:n.Fp.ORDER,n:n.n,h:n.h,Gx:n.Gx,Gy:n.Gy},t=n.Fp,r=jn(e.n,n.nBitLength,!0),i={Fp:t,Fn:r,uvRatio:n.uvRatio},s={hash:n.hash,randomBytes:n.randomBytes,adjustScalarBytes:n.adjustScalarBytes,domain:n.domain,prehash:n.prehash,mapToCurve:n.mapToCurve};return{CURVE:e,curveOpts:i,eddsaOpts:s}}function h0(n,e){return Object.assign({},e,{ExtendedPoint:e.Point,CURVE:n})}function f0(n){const{CURVE:e,curveOpts:t,eddsaOpts:r}=l0(n),i=c0(e,t),s=u0(i,r);return h0(n,s)}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */BigInt(0);const d0=BigInt(1),Rc=BigInt(2);BigInt(3);const p0=BigInt(5),y0=BigInt(8),Rs={p:BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffed"),n:BigInt("0x1000000000000000000000000000000014def9dea2f79cd65812631a5cf5d3ed"),h:y0,a:BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffec"),d:BigInt("0x52036cee2b6ffe738cc740797779e89800700a4d4141d8ab75eb4dca135978a3"),Gx:BigInt("0x216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a"),Gy:BigInt("0x6666666666666666666666666666666666666666666666666666666666666658")};function g0(n){const e=BigInt(10),t=BigInt(20),r=BigInt(40),i=BigInt(80),s=Rs.p,a=n*n%s*n%s,u=et(a,Rc,s)*a%s,l=et(u,d0,s)*n%s,f=et(l,p0,s)*l%s,_=et(f,e,s)*f%s,I=et(_,t,s)*_%s,g=et(I,r,s)*I%s,v=et(g,i,s)*g%s,x=et(v,i,s)*g%s,A=et(x,e,s)*f%s;return{pow_p_5_8:et(A,Rc,s)*n%s,b2:a}}function m0(n){return n[0]&=248,n[31]&=127,n[31]|=64,n}const Ac=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752");function w0(n,e){const t=Rs.p,r=nt(e*e*e,t),i=nt(r*r*e,t),s=g0(n*i).pow_p_5_8;let o=nt(n*r*s,t);const a=nt(e*o*o,t),u=o,l=nt(o*Ac,t),f=a===n,_=a===nt(-n,t),I=a===nt(-n*Ac,t);return f&&(o=u),(_||I)&&(o=l),Yp(o,t)&&(o=nt(-o,t)),{isValid:f||_,value:o}}const _0=jn(Rs.p,void 0,!0),b0={...Rs,Fp:_0,hash:$p,adjustScalarBytes:m0,uvRatio:w0},Zn=f0(b0);var ga={exports:{}};const E0={},R0=Object.freeze(Object.defineProperty({__proto__:null,default:E0},Symbol.toStringTag,{value:"Module"})),A0=gs(R0);ga.exports;(function(n){(function(e,t){function r(w,c){if(!w)throw new Error(c||"Assertion failed")}function i(w,c){w.super_=c;var h=function(){};h.prototype=c.prototype,w.prototype=new h,w.prototype.constructor=w}function s(w,c,h){if(s.isBN(w))return w;this.negative=0,this.words=null,this.length=0,this.red=null,w!==null&&((c==="le"||c==="be")&&(h=c,c=10),this._init(w||0,c||10,h||"be"))}typeof e=="object"?e.exports=s:t.BN=s,s.BN=s,s.wordSize=26;var o;try{typeof window<"u"&&typeof window.Buffer<"u"?o=window.Buffer:o=A0.Buffer}catch{}s.isBN=function(c){return c instanceof s?!0:c!==null&&typeof c=="object"&&c.constructor.wordSize===s.wordSize&&Array.isArray(c.words)},s.max=function(c,h){return c.cmp(h)>0?c:h},s.min=function(c,h){return c.cmp(h)<0?c:h},s.prototype._init=function(c,h,m){if(typeof c=="number")return this._initNumber(c,h,m);if(typeof c=="object")return this._initArray(c,h,m);h==="hex"&&(h=16),r(h===(h|0)&&h>=2&&h<=36),c=c.toString().replace(/\s+/g,"");var E=0;c[0]==="-"&&(E++,this.negative=1),E<c.length&&(h===16?this._parseHex(c,E,m):(this._parseBase(c,h,E),m==="le"&&this._initArray(this.toArray(),h,m)))},s.prototype._initNumber=function(c,h,m){c<0&&(this.negative=1,c=-c),c<67108864?(this.words=[c&67108863],this.length=1):c<4503599627370496?(this.words=[c&67108863,c/67108864&67108863],this.length=2):(r(c<9007199254740992),this.words=[c&67108863,c/67108864&67108863,1],this.length=3),m==="le"&&this._initArray(this.toArray(),h,m)},s.prototype._initArray=function(c,h,m){if(r(typeof c.length=="number"),c.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(c.length/3),this.words=new Array(this.length);for(var E=0;E<this.length;E++)this.words[E]=0;var S,O,C=0;if(m==="be")for(E=c.length-1,S=0;E>=0;E-=3)O=c[E]|c[E-1]<<8|c[E-2]<<16,this.words[S]|=O<<C&67108863,this.words[S+1]=O>>>26-C&67108863,C+=24,C>=26&&(C-=26,S++);else if(m==="le")for(E=0,S=0;E<c.length;E+=3)O=c[E]|c[E+1]<<8|c[E+2]<<16,this.words[S]|=O<<C&67108863,this.words[S+1]=O>>>26-C&67108863,C+=24,C>=26&&(C-=26,S++);return this._strip()};function a(w,c){var h=w.charCodeAt(c);if(h>=48&&h<=57)return h-48;if(h>=65&&h<=70)return h-55;if(h>=97&&h<=102)return h-87;r(!1,"Invalid character in "+w)}function u(w,c,h){var m=a(w,h);return h-1>=c&&(m|=a(w,h-1)<<4),m}s.prototype._parseHex=function(c,h,m){this.length=Math.ceil((c.length-h)/6),this.words=new Array(this.length);for(var E=0;E<this.length;E++)this.words[E]=0;var S=0,O=0,C;if(m==="be")for(E=c.length-1;E>=h;E-=2)C=u(c,h,E)<<S,this.words[O]|=C&67108863,S>=18?(S-=18,O+=1,this.words[O]|=C>>>26):S+=8;else{var R=c.length-h;for(E=R%2===0?h+1:h;E<c.length;E+=2)C=u(c,h,E)<<S,this.words[O]|=C&67108863,S>=18?(S-=18,O+=1,this.words[O]|=C>>>26):S+=8}this._strip()};function l(w,c,h,m){for(var E=0,S=0,O=Math.min(w.length,h),C=c;C<O;C++){var R=w.charCodeAt(C)-48;E*=m,R>=49?S=R-49+10:R>=17?S=R-17+10:S=R,r(R>=0&&S<m,"Invalid character"),E+=S}return E}s.prototype._parseBase=function(c,h,m){this.words=[0],this.length=1;for(var E=0,S=1;S<=67108863;S*=h)E++;E--,S=S/h|0;for(var O=c.length-m,C=O%E,R=Math.min(O,O-C)+m,y=0,T=m;T<R;T+=E)y=l(c,T,T+E,h),this.imuln(S),this.words[0]+y<67108864?this.words[0]+=y:this._iaddn(y);if(C!==0){var ae=1;for(y=l(c,T,c.length,h),T=0;T<C;T++)ae*=h;this.imuln(ae),this.words[0]+y<67108864?this.words[0]+=y:this._iaddn(y)}this._strip()},s.prototype.copy=function(c){c.words=new Array(this.length);for(var h=0;h<this.length;h++)c.words[h]=this.words[h];c.length=this.length,c.negative=this.negative,c.red=this.red};function f(w,c){w.words=c.words,w.length=c.length,w.negative=c.negative,w.red=c.red}if(s.prototype._move=function(c){f(c,this)},s.prototype.clone=function(){var c=new s(null);return this.copy(c),c},s.prototype._expand=function(c){for(;this.length<c;)this.words[this.length++]=0;return this},s.prototype._strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},s.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},typeof Symbol<"u"&&typeof Symbol.for=="function")try{s.prototype[Symbol.for("nodejs.util.inspect.custom")]=_}catch{s.prototype.inspect=_}else s.prototype.inspect=_;function _(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"}var I=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],g=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],v=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];s.prototype.toString=function(c,h){c=c||10,h=h|0||1;var m;if(c===16||c==="hex"){m="";for(var E=0,S=0,O=0;O<this.length;O++){var C=this.words[O],R=((C<<E|S)&16777215).toString(16);S=C>>>24-E&16777215,E+=2,E>=26&&(E-=26,O--),S!==0||O!==this.length-1?m=I[6-R.length]+R+m:m=R+m}for(S!==0&&(m=S.toString(16)+m);m.length%h!==0;)m="0"+m;return this.negative!==0&&(m="-"+m),m}if(c===(c|0)&&c>=2&&c<=36){var y=g[c],T=v[c];m="";var ae=this.clone();for(ae.negative=0;!ae.isZero();){var ne=ae.modrn(T).toString(c);ae=ae.idivn(T),ae.isZero()?m=ne+m:m=I[y-ne.length]+ne+m}for(this.isZero()&&(m="0"+m);m.length%h!==0;)m="0"+m;return this.negative!==0&&(m="-"+m),m}r(!1,"Base should be between 2 and 36")},s.prototype.toNumber=function(){var c=this.words[0];return this.length===2?c+=this.words[1]*67108864:this.length===3&&this.words[2]===1?c+=4503599627370496+this.words[1]*67108864:this.length>2&&r(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-c:c},s.prototype.toJSON=function(){return this.toString(16,2)},o&&(s.prototype.toBuffer=function(c,h){return this.toArrayLike(o,c,h)}),s.prototype.toArray=function(c,h){return this.toArrayLike(Array,c,h)};var x=function(c,h){return c.allocUnsafe?c.allocUnsafe(h):new c(h)};s.prototype.toArrayLike=function(c,h,m){this._strip();var E=this.byteLength(),S=m||Math.max(1,E);r(E<=S,"byte array longer than desired length"),r(S>0,"Requested array length <= 0");var O=x(c,S),C=h==="le"?"LE":"BE";return this["_toArrayLike"+C](O,E),O},s.prototype._toArrayLikeLE=function(c,h){for(var m=0,E=0,S=0,O=0;S<this.length;S++){var C=this.words[S]<<O|E;c[m++]=C&255,m<c.length&&(c[m++]=C>>8&255),m<c.length&&(c[m++]=C>>16&255),O===6?(m<c.length&&(c[m++]=C>>24&255),E=0,O=0):(E=C>>>24,O+=2)}if(m<c.length)for(c[m++]=E;m<c.length;)c[m++]=0},s.prototype._toArrayLikeBE=function(c,h){for(var m=c.length-1,E=0,S=0,O=0;S<this.length;S++){var C=this.words[S]<<O|E;c[m--]=C&255,m>=0&&(c[m--]=C>>8&255),m>=0&&(c[m--]=C>>16&255),O===6?(m>=0&&(c[m--]=C>>24&255),E=0,O=0):(E=C>>>24,O+=2)}if(m>=0)for(c[m--]=E;m>=0;)c[m--]=0},Math.clz32?s.prototype._countBits=function(c){return 32-Math.clz32(c)}:s.prototype._countBits=function(c){var h=c,m=0;return h>=4096&&(m+=13,h>>>=13),h>=64&&(m+=7,h>>>=7),h>=8&&(m+=4,h>>>=4),h>=2&&(m+=2,h>>>=2),m+h},s.prototype._zeroBits=function(c){if(c===0)return 26;var h=c,m=0;return h&8191||(m+=13,h>>>=13),h&127||(m+=7,h>>>=7),h&15||(m+=4,h>>>=4),h&3||(m+=2,h>>>=2),h&1||m++,m},s.prototype.bitLength=function(){var c=this.words[this.length-1],h=this._countBits(c);return(this.length-1)*26+h};function A(w){for(var c=new Array(w.bitLength()),h=0;h<c.length;h++){var m=h/26|0,E=h%26;c[h]=w.words[m]>>>E&1}return c}s.prototype.zeroBits=function(){if(this.isZero())return 0;for(var c=0,h=0;h<this.length;h++){var m=this._zeroBits(this.words[h]);if(c+=m,m!==26)break}return c},s.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},s.prototype.toTwos=function(c){return this.negative!==0?this.abs().inotn(c).iaddn(1):this.clone()},s.prototype.fromTwos=function(c){return this.testn(c-1)?this.notn(c).iaddn(1).ineg():this.clone()},s.prototype.isNeg=function(){return this.negative!==0},s.prototype.neg=function(){return this.clone().ineg()},s.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},s.prototype.iuor=function(c){for(;this.length<c.length;)this.words[this.length++]=0;for(var h=0;h<c.length;h++)this.words[h]=this.words[h]|c.words[h];return this._strip()},s.prototype.ior=function(c){return r((this.negative|c.negative)===0),this.iuor(c)},s.prototype.or=function(c){return this.length>c.length?this.clone().ior(c):c.clone().ior(this)},s.prototype.uor=function(c){return this.length>c.length?this.clone().iuor(c):c.clone().iuor(this)},s.prototype.iuand=function(c){var h;this.length>c.length?h=c:h=this;for(var m=0;m<h.length;m++)this.words[m]=this.words[m]&c.words[m];return this.length=h.length,this._strip()},s.prototype.iand=function(c){return r((this.negative|c.negative)===0),this.iuand(c)},s.prototype.and=function(c){return this.length>c.length?this.clone().iand(c):c.clone().iand(this)},s.prototype.uand=function(c){return this.length>c.length?this.clone().iuand(c):c.clone().iuand(this)},s.prototype.iuxor=function(c){var h,m;this.length>c.length?(h=this,m=c):(h=c,m=this);for(var E=0;E<m.length;E++)this.words[E]=h.words[E]^m.words[E];if(this!==h)for(;E<h.length;E++)this.words[E]=h.words[E];return this.length=h.length,this._strip()},s.prototype.ixor=function(c){return r((this.negative|c.negative)===0),this.iuxor(c)},s.prototype.xor=function(c){return this.length>c.length?this.clone().ixor(c):c.clone().ixor(this)},s.prototype.uxor=function(c){return this.length>c.length?this.clone().iuxor(c):c.clone().iuxor(this)},s.prototype.inotn=function(c){r(typeof c=="number"&&c>=0);var h=Math.ceil(c/26)|0,m=c%26;this._expand(h),m>0&&h--;for(var E=0;E<h;E++)this.words[E]=~this.words[E]&67108863;return m>0&&(this.words[E]=~this.words[E]&67108863>>26-m),this._strip()},s.prototype.notn=function(c){return this.clone().inotn(c)},s.prototype.setn=function(c,h){r(typeof c=="number"&&c>=0);var m=c/26|0,E=c%26;return this._expand(m+1),h?this.words[m]=this.words[m]|1<<E:this.words[m]=this.words[m]&~(1<<E),this._strip()},s.prototype.iadd=function(c){var h;if(this.negative!==0&&c.negative===0)return this.negative=0,h=this.isub(c),this.negative^=1,this._normSign();if(this.negative===0&&c.negative!==0)return c.negative=0,h=this.isub(c),c.negative=1,h._normSign();var m,E;this.length>c.length?(m=this,E=c):(m=c,E=this);for(var S=0,O=0;O<E.length;O++)h=(m.words[O]|0)+(E.words[O]|0)+S,this.words[O]=h&67108863,S=h>>>26;for(;S!==0&&O<m.length;O++)h=(m.words[O]|0)+S,this.words[O]=h&67108863,S=h>>>26;if(this.length=m.length,S!==0)this.words[this.length]=S,this.length++;else if(m!==this)for(;O<m.length;O++)this.words[O]=m.words[O];return this},s.prototype.add=function(c){var h;return c.negative!==0&&this.negative===0?(c.negative=0,h=this.sub(c),c.negative^=1,h):c.negative===0&&this.negative!==0?(this.negative=0,h=c.sub(this),this.negative=1,h):this.length>c.length?this.clone().iadd(c):c.clone().iadd(this)},s.prototype.isub=function(c){if(c.negative!==0){c.negative=0;var h=this.iadd(c);return c.negative=1,h._normSign()}else if(this.negative!==0)return this.negative=0,this.iadd(c),this.negative=1,this._normSign();var m=this.cmp(c);if(m===0)return this.negative=0,this.length=1,this.words[0]=0,this;var E,S;m>0?(E=this,S=c):(E=c,S=this);for(var O=0,C=0;C<S.length;C++)h=(E.words[C]|0)-(S.words[C]|0)+O,O=h>>26,this.words[C]=h&67108863;for(;O!==0&&C<E.length;C++)h=(E.words[C]|0)+O,O=h>>26,this.words[C]=h&67108863;if(O===0&&C<E.length&&E!==this)for(;C<E.length;C++)this.words[C]=E.words[C];return this.length=Math.max(this.length,C),E!==this&&(this.negative=1),this._strip()},s.prototype.sub=function(c){return this.clone().isub(c)};function N(w,c,h){h.negative=c.negative^w.negative;var m=w.length+c.length|0;h.length=m,m=m-1|0;var E=w.words[0]|0,S=c.words[0]|0,O=E*S,C=O&67108863,R=O/67108864|0;h.words[0]=C;for(var y=1;y<m;y++){for(var T=R>>>26,ae=R&67108863,ne=Math.min(y,c.length-1),le=Math.max(0,y-w.length+1);le<=ne;le++){var Fe=y-le|0;E=w.words[Fe]|0,S=c.words[le]|0,O=E*S+ae,T+=O/67108864|0,ae=O&67108863}h.words[y]=ae|0,R=T|0}return R!==0?h.words[y]=R|0:h.length--,h._strip()}var K=function(c,h,m){var E=c.words,S=h.words,O=m.words,C=0,R,y,T,ae=E[0]|0,ne=ae&8191,le=ae>>>13,Fe=E[1]|0,Ee=Fe&8191,Ae=Fe>>>13,Ir=E[2]|0,Ne=Ir&8191,qe=Ir>>>13,kr=E[3]|0,Pe=kr&8191,Ye=kr>>>13,Bi=E[4]|0,Ke=Bi&8191,Xe=Bi>>>13,Mi=E[5]|0,Ve=Mi&8191,He=Mi>>>13,Wt=E[6]|0,We=Wt&8191,Je=Wt>>>13,sr=E[7]|0,Qe=sr&8191,b=sr>>>13,d=E[8]|0,p=d&8191,k=d>>>13,B=E[9]|0,F=B&8191,q=B>>>13,we=S[0]|0,ye=we&8191,pe=we>>>13,ze=S[1]|0,de=ze&8191,it=ze>>>13,nc=S[2]|0,st=nc&8191,ot=nc>>>13,ic=S[3]|0,at=ic&8191,ct=ic>>>13,sc=S[4]|0,ut=sc&8191,lt=sc>>>13,oc=S[5]|0,ht=oc&8191,ft=oc>>>13,ac=S[6]|0,dt=ac&8191,pt=ac>>>13,cc=S[7]|0,yt=cc&8191,gt=cc>>>13,uc=S[8]|0,mt=uc&8191,wt=uc>>>13,lc=S[9]|0,_t=lc&8191,bt=lc>>>13;m.negative=c.negative^h.negative,m.length=19,R=Math.imul(ne,ye),y=Math.imul(ne,pe),y=y+Math.imul(le,ye)|0,T=Math.imul(le,pe);var Ws=(C+R|0)+((y&8191)<<13)|0;C=(T+(y>>>13)|0)+(Ws>>>26)|0,Ws&=67108863,R=Math.imul(Ee,ye),y=Math.imul(Ee,pe),y=y+Math.imul(Ae,ye)|0,T=Math.imul(Ae,pe),R=R+Math.imul(ne,de)|0,y=y+Math.imul(ne,it)|0,y=y+Math.imul(le,de)|0,T=T+Math.imul(le,it)|0;var Gs=(C+R|0)+((y&8191)<<13)|0;C=(T+(y>>>13)|0)+(Gs>>>26)|0,Gs&=67108863,R=Math.imul(Ne,ye),y=Math.imul(Ne,pe),y=y+Math.imul(qe,ye)|0,T=Math.imul(qe,pe),R=R+Math.imul(Ee,de)|0,y=y+Math.imul(Ee,it)|0,y=y+Math.imul(Ae,de)|0,T=T+Math.imul(Ae,it)|0,R=R+Math.imul(ne,st)|0,y=y+Math.imul(ne,ot)|0,y=y+Math.imul(le,st)|0,T=T+Math.imul(le,ot)|0;var qs=(C+R|0)+((y&8191)<<13)|0;C=(T+(y>>>13)|0)+(qs>>>26)|0,qs&=67108863,R=Math.imul(Pe,ye),y=Math.imul(Pe,pe),y=y+Math.imul(Ye,ye)|0,T=Math.imul(Ye,pe),R=R+Math.imul(Ne,de)|0,y=y+Math.imul(Ne,it)|0,y=y+Math.imul(qe,de)|0,T=T+Math.imul(qe,it)|0,R=R+Math.imul(Ee,st)|0,y=y+Math.imul(Ee,ot)|0,y=y+Math.imul(Ae,st)|0,T=T+Math.imul(Ae,ot)|0,R=R+Math.imul(ne,at)|0,y=y+Math.imul(ne,ct)|0,y=y+Math.imul(le,at)|0,T=T+Math.imul(le,ct)|0;var Vs=(C+R|0)+((y&8191)<<13)|0;C=(T+(y>>>13)|0)+(Vs>>>26)|0,Vs&=67108863,R=Math.imul(Ke,ye),y=Math.imul(Ke,pe),y=y+Math.imul(Xe,ye)|0,T=Math.imul(Xe,pe),R=R+Math.imul(Pe,de)|0,y=y+Math.imul(Pe,it)|0,y=y+Math.imul(Ye,de)|0,T=T+Math.imul(Ye,it)|0,R=R+Math.imul(Ne,st)|0,y=y+Math.imul(Ne,ot)|0,y=y+Math.imul(qe,st)|0,T=T+Math.imul(qe,ot)|0,R=R+Math.imul(Ee,at)|0,y=y+Math.imul(Ee,ct)|0,y=y+Math.imul(Ae,at)|0,T=T+Math.imul(Ae,ct)|0,R=R+Math.imul(ne,ut)|0,y=y+Math.imul(ne,lt)|0,y=y+Math.imul(le,ut)|0,T=T+Math.imul(le,lt)|0;var js=(C+R|0)+((y&8191)<<13)|0;C=(T+(y>>>13)|0)+(js>>>26)|0,js&=67108863,R=Math.imul(Ve,ye),y=Math.imul(Ve,pe),y=y+Math.imul(He,ye)|0,T=Math.imul(He,pe),R=R+Math.imul(Ke,de)|0,y=y+Math.imul(Ke,it)|0,y=y+Math.imul(Xe,de)|0,T=T+Math.imul(Xe,it)|0,R=R+Math.imul(Pe,st)|0,y=y+Math.imul(Pe,ot)|0,y=y+Math.imul(Ye,st)|0,T=T+Math.imul(Ye,ot)|0,R=R+Math.imul(Ne,at)|0,y=y+Math.imul(Ne,ct)|0,y=y+Math.imul(qe,at)|0,T=T+Math.imul(qe,ct)|0,R=R+Math.imul(Ee,ut)|0,y=y+Math.imul(Ee,lt)|0,y=y+Math.imul(Ae,ut)|0,T=T+Math.imul(Ae,lt)|0,R=R+Math.imul(ne,ht)|0,y=y+Math.imul(ne,ft)|0,y=y+Math.imul(le,ht)|0,T=T+Math.imul(le,ft)|0;var Zs=(C+R|0)+((y&8191)<<13)|0;C=(T+(y>>>13)|0)+(Zs>>>26)|0,Zs&=67108863,R=Math.imul(We,ye),y=Math.imul(We,pe),y=y+Math.imul(Je,ye)|0,T=Math.imul(Je,pe),R=R+Math.imul(Ve,de)|0,y=y+Math.imul(Ve,it)|0,y=y+Math.imul(He,de)|0,T=T+Math.imul(He,it)|0,R=R+Math.imul(Ke,st)|0,y=y+Math.imul(Ke,ot)|0,y=y+Math.imul(Xe,st)|0,T=T+Math.imul(Xe,ot)|0,R=R+Math.imul(Pe,at)|0,y=y+Math.imul(Pe,ct)|0,y=y+Math.imul(Ye,at)|0,T=T+Math.imul(Ye,ct)|0,R=R+Math.imul(Ne,ut)|0,y=y+Math.imul(Ne,lt)|0,y=y+Math.imul(qe,ut)|0,T=T+Math.imul(qe,lt)|0,R=R+Math.imul(Ee,ht)|0,y=y+Math.imul(Ee,ft)|0,y=y+Math.imul(Ae,ht)|0,T=T+Math.imul(Ae,ft)|0,R=R+Math.imul(ne,dt)|0,y=y+Math.imul(ne,pt)|0,y=y+Math.imul(le,dt)|0,T=T+Math.imul(le,pt)|0;var Ys=(C+R|0)+((y&8191)<<13)|0;C=(T+(y>>>13)|0)+(Ys>>>26)|0,Ys&=67108863,R=Math.imul(Qe,ye),y=Math.imul(Qe,pe),y=y+Math.imul(b,ye)|0,T=Math.imul(b,pe),R=R+Math.imul(We,de)|0,y=y+Math.imul(We,it)|0,y=y+Math.imul(Je,de)|0,T=T+Math.imul(Je,it)|0,R=R+Math.imul(Ve,st)|0,y=y+Math.imul(Ve,ot)|0,y=y+Math.imul(He,st)|0,T=T+Math.imul(He,ot)|0,R=R+Math.imul(Ke,at)|0,y=y+Math.imul(Ke,ct)|0,y=y+Math.imul(Xe,at)|0,T=T+Math.imul(Xe,ct)|0,R=R+Math.imul(Pe,ut)|0,y=y+Math.imul(Pe,lt)|0,y=y+Math.imul(Ye,ut)|0,T=T+Math.imul(Ye,lt)|0,R=R+Math.imul(Ne,ht)|0,y=y+Math.imul(Ne,ft)|0,y=y+Math.imul(qe,ht)|0,T=T+Math.imul(qe,ft)|0,R=R+Math.imul(Ee,dt)|0,y=y+Math.imul(Ee,pt)|0,y=y+Math.imul(Ae,dt)|0,T=T+Math.imul(Ae,pt)|0,R=R+Math.imul(ne,yt)|0,y=y+Math.imul(ne,gt)|0,y=y+Math.imul(le,yt)|0,T=T+Math.imul(le,gt)|0;var Xs=(C+R|0)+((y&8191)<<13)|0;C=(T+(y>>>13)|0)+(Xs>>>26)|0,Xs&=67108863,R=Math.imul(p,ye),y=Math.imul(p,pe),y=y+Math.imul(k,ye)|0,T=Math.imul(k,pe),R=R+Math.imul(Qe,de)|0,y=y+Math.imul(Qe,it)|0,y=y+Math.imul(b,de)|0,T=T+Math.imul(b,it)|0,R=R+Math.imul(We,st)|0,y=y+Math.imul(We,ot)|0,y=y+Math.imul(Je,st)|0,T=T+Math.imul(Je,ot)|0,R=R+Math.imul(Ve,at)|0,y=y+Math.imul(Ve,ct)|0,y=y+Math.imul(He,at)|0,T=T+Math.imul(He,ct)|0,R=R+Math.imul(Ke,ut)|0,y=y+Math.imul(Ke,lt)|0,y=y+Math.imul(Xe,ut)|0,T=T+Math.imul(Xe,lt)|0,R=R+Math.imul(Pe,ht)|0,y=y+Math.imul(Pe,ft)|0,y=y+Math.imul(Ye,ht)|0,T=T+Math.imul(Ye,ft)|0,R=R+Math.imul(Ne,dt)|0,y=y+Math.imul(Ne,pt)|0,y=y+Math.imul(qe,dt)|0,T=T+Math.imul(qe,pt)|0,R=R+Math.imul(Ee,yt)|0,y=y+Math.imul(Ee,gt)|0,y=y+Math.imul(Ae,yt)|0,T=T+Math.imul(Ae,gt)|0,R=R+Math.imul(ne,mt)|0,y=y+Math.imul(ne,wt)|0,y=y+Math.imul(le,mt)|0,T=T+Math.imul(le,wt)|0;var Js=(C+R|0)+((y&8191)<<13)|0;C=(T+(y>>>13)|0)+(Js>>>26)|0,Js&=67108863,R=Math.imul(F,ye),y=Math.imul(F,pe),y=y+Math.imul(q,ye)|0,T=Math.imul(q,pe),R=R+Math.imul(p,de)|0,y=y+Math.imul(p,it)|0,y=y+Math.imul(k,de)|0,T=T+Math.imul(k,it)|0,R=R+Math.imul(Qe,st)|0,y=y+Math.imul(Qe,ot)|0,y=y+Math.imul(b,st)|0,T=T+Math.imul(b,ot)|0,R=R+Math.imul(We,at)|0,y=y+Math.imul(We,ct)|0,y=y+Math.imul(Je,at)|0,T=T+Math.imul(Je,ct)|0,R=R+Math.imul(Ve,ut)|0,y=y+Math.imul(Ve,lt)|0,y=y+Math.imul(He,ut)|0,T=T+Math.imul(He,lt)|0,R=R+Math.imul(Ke,ht)|0,y=y+Math.imul(Ke,ft)|0,y=y+Math.imul(Xe,ht)|0,T=T+Math.imul(Xe,ft)|0,R=R+Math.imul(Pe,dt)|0,y=y+Math.imul(Pe,pt)|0,y=y+Math.imul(Ye,dt)|0,T=T+Math.imul(Ye,pt)|0,R=R+Math.imul(Ne,yt)|0,y=y+Math.imul(Ne,gt)|0,y=y+Math.imul(qe,yt)|0,T=T+Math.imul(qe,gt)|0,R=R+Math.imul(Ee,mt)|0,y=y+Math.imul(Ee,wt)|0,y=y+Math.imul(Ae,mt)|0,T=T+Math.imul(Ae,wt)|0,R=R+Math.imul(ne,_t)|0,y=y+Math.imul(ne,bt)|0,y=y+Math.imul(le,_t)|0,T=T+Math.imul(le,bt)|0;var Qs=(C+R|0)+((y&8191)<<13)|0;C=(T+(y>>>13)|0)+(Qs>>>26)|0,Qs&=67108863,R=Math.imul(F,de),y=Math.imul(F,it),y=y+Math.imul(q,de)|0,T=Math.imul(q,it),R=R+Math.imul(p,st)|0,y=y+Math.imul(p,ot)|0,y=y+Math.imul(k,st)|0,T=T+Math.imul(k,ot)|0,R=R+Math.imul(Qe,at)|0,y=y+Math.imul(Qe,ct)|0,y=y+Math.imul(b,at)|0,T=T+Math.imul(b,ct)|0,R=R+Math.imul(We,ut)|0,y=y+Math.imul(We,lt)|0,y=y+Math.imul(Je,ut)|0,T=T+Math.imul(Je,lt)|0,R=R+Math.imul(Ve,ht)|0,y=y+Math.imul(Ve,ft)|0,y=y+Math.imul(He,ht)|0,T=T+Math.imul(He,ft)|0,R=R+Math.imul(Ke,dt)|0,y=y+Math.imul(Ke,pt)|0,y=y+Math.imul(Xe,dt)|0,T=T+Math.imul(Xe,pt)|0,R=R+Math.imul(Pe,yt)|0,y=y+Math.imul(Pe,gt)|0,y=y+Math.imul(Ye,yt)|0,T=T+Math.imul(Ye,gt)|0,R=R+Math.imul(Ne,mt)|0,y=y+Math.imul(Ne,wt)|0,y=y+Math.imul(qe,mt)|0,T=T+Math.imul(qe,wt)|0,R=R+Math.imul(Ee,_t)|0,y=y+Math.imul(Ee,bt)|0,y=y+Math.imul(Ae,_t)|0,T=T+Math.imul(Ae,bt)|0;var eo=(C+R|0)+((y&8191)<<13)|0;C=(T+(y>>>13)|0)+(eo>>>26)|0,eo&=67108863,R=Math.imul(F,st),y=Math.imul(F,ot),y=y+Math.imul(q,st)|0,T=Math.imul(q,ot),R=R+Math.imul(p,at)|0,y=y+Math.imul(p,ct)|0,y=y+Math.imul(k,at)|0,T=T+Math.imul(k,ct)|0,R=R+Math.imul(Qe,ut)|0,y=y+Math.imul(Qe,lt)|0,y=y+Math.imul(b,ut)|0,T=T+Math.imul(b,lt)|0,R=R+Math.imul(We,ht)|0,y=y+Math.imul(We,ft)|0,y=y+Math.imul(Je,ht)|0,T=T+Math.imul(Je,ft)|0,R=R+Math.imul(Ve,dt)|0,y=y+Math.imul(Ve,pt)|0,y=y+Math.imul(He,dt)|0,T=T+Math.imul(He,pt)|0,R=R+Math.imul(Ke,yt)|0,y=y+Math.imul(Ke,gt)|0,y=y+Math.imul(Xe,yt)|0,T=T+Math.imul(Xe,gt)|0,R=R+Math.imul(Pe,mt)|0,y=y+Math.imul(Pe,wt)|0,y=y+Math.imul(Ye,mt)|0,T=T+Math.imul(Ye,wt)|0,R=R+Math.imul(Ne,_t)|0,y=y+Math.imul(Ne,bt)|0,y=y+Math.imul(qe,_t)|0,T=T+Math.imul(qe,bt)|0;var to=(C+R|0)+((y&8191)<<13)|0;C=(T+(y>>>13)|0)+(to>>>26)|0,to&=67108863,R=Math.imul(F,at),y=Math.imul(F,ct),y=y+Math.imul(q,at)|0,T=Math.imul(q,ct),R=R+Math.imul(p,ut)|0,y=y+Math.imul(p,lt)|0,y=y+Math.imul(k,ut)|0,T=T+Math.imul(k,lt)|0,R=R+Math.imul(Qe,ht)|0,y=y+Math.imul(Qe,ft)|0,y=y+Math.imul(b,ht)|0,T=T+Math.imul(b,ft)|0,R=R+Math.imul(We,dt)|0,y=y+Math.imul(We,pt)|0,y=y+Math.imul(Je,dt)|0,T=T+Math.imul(Je,pt)|0,R=R+Math.imul(Ve,yt)|0,y=y+Math.imul(Ve,gt)|0,y=y+Math.imul(He,yt)|0,T=T+Math.imul(He,gt)|0,R=R+Math.imul(Ke,mt)|0,y=y+Math.imul(Ke,wt)|0,y=y+Math.imul(Xe,mt)|0,T=T+Math.imul(Xe,wt)|0,R=R+Math.imul(Pe,_t)|0,y=y+Math.imul(Pe,bt)|0,y=y+Math.imul(Ye,_t)|0,T=T+Math.imul(Ye,bt)|0;var ro=(C+R|0)+((y&8191)<<13)|0;C=(T+(y>>>13)|0)+(ro>>>26)|0,ro&=67108863,R=Math.imul(F,ut),y=Math.imul(F,lt),y=y+Math.imul(q,ut)|0,T=Math.imul(q,lt),R=R+Math.imul(p,ht)|0,y=y+Math.imul(p,ft)|0,y=y+Math.imul(k,ht)|0,T=T+Math.imul(k,ft)|0,R=R+Math.imul(Qe,dt)|0,y=y+Math.imul(Qe,pt)|0,y=y+Math.imul(b,dt)|0,T=T+Math.imul(b,pt)|0,R=R+Math.imul(We,yt)|0,y=y+Math.imul(We,gt)|0,y=y+Math.imul(Je,yt)|0,T=T+Math.imul(Je,gt)|0,R=R+Math.imul(Ve,mt)|0,y=y+Math.imul(Ve,wt)|0,y=y+Math.imul(He,mt)|0,T=T+Math.imul(He,wt)|0,R=R+Math.imul(Ke,_t)|0,y=y+Math.imul(Ke,bt)|0,y=y+Math.imul(Xe,_t)|0,T=T+Math.imul(Xe,bt)|0;var no=(C+R|0)+((y&8191)<<13)|0;C=(T+(y>>>13)|0)+(no>>>26)|0,no&=67108863,R=Math.imul(F,ht),y=Math.imul(F,ft),y=y+Math.imul(q,ht)|0,T=Math.imul(q,ft),R=R+Math.imul(p,dt)|0,y=y+Math.imul(p,pt)|0,y=y+Math.imul(k,dt)|0,T=T+Math.imul(k,pt)|0,R=R+Math.imul(Qe,yt)|0,y=y+Math.imul(Qe,gt)|0,y=y+Math.imul(b,yt)|0,T=T+Math.imul(b,gt)|0,R=R+Math.imul(We,mt)|0,y=y+Math.imul(We,wt)|0,y=y+Math.imul(Je,mt)|0,T=T+Math.imul(Je,wt)|0,R=R+Math.imul(Ve,_t)|0,y=y+Math.imul(Ve,bt)|0,y=y+Math.imul(He,_t)|0,T=T+Math.imul(He,bt)|0;var io=(C+R|0)+((y&8191)<<13)|0;C=(T+(y>>>13)|0)+(io>>>26)|0,io&=67108863,R=Math.imul(F,dt),y=Math.imul(F,pt),y=y+Math.imul(q,dt)|0,T=Math.imul(q,pt),R=R+Math.imul(p,yt)|0,y=y+Math.imul(p,gt)|0,y=y+Math.imul(k,yt)|0,T=T+Math.imul(k,gt)|0,R=R+Math.imul(Qe,mt)|0,y=y+Math.imul(Qe,wt)|0,y=y+Math.imul(b,mt)|0,T=T+Math.imul(b,wt)|0,R=R+Math.imul(We,_t)|0,y=y+Math.imul(We,bt)|0,y=y+Math.imul(Je,_t)|0,T=T+Math.imul(Je,bt)|0;var so=(C+R|0)+((y&8191)<<13)|0;C=(T+(y>>>13)|0)+(so>>>26)|0,so&=67108863,R=Math.imul(F,yt),y=Math.imul(F,gt),y=y+Math.imul(q,yt)|0,T=Math.imul(q,gt),R=R+Math.imul(p,mt)|0,y=y+Math.imul(p,wt)|0,y=y+Math.imul(k,mt)|0,T=T+Math.imul(k,wt)|0,R=R+Math.imul(Qe,_t)|0,y=y+Math.imul(Qe,bt)|0,y=y+Math.imul(b,_t)|0,T=T+Math.imul(b,bt)|0;var oo=(C+R|0)+((y&8191)<<13)|0;C=(T+(y>>>13)|0)+(oo>>>26)|0,oo&=67108863,R=Math.imul(F,mt),y=Math.imul(F,wt),y=y+Math.imul(q,mt)|0,T=Math.imul(q,wt),R=R+Math.imul(p,_t)|0,y=y+Math.imul(p,bt)|0,y=y+Math.imul(k,_t)|0,T=T+Math.imul(k,bt)|0;var ao=(C+R|0)+((y&8191)<<13)|0;C=(T+(y>>>13)|0)+(ao>>>26)|0,ao&=67108863,R=Math.imul(F,_t),y=Math.imul(F,bt),y=y+Math.imul(q,_t)|0,T=Math.imul(q,bt);var co=(C+R|0)+((y&8191)<<13)|0;return C=(T+(y>>>13)|0)+(co>>>26)|0,co&=67108863,O[0]=Ws,O[1]=Gs,O[2]=qs,O[3]=Vs,O[4]=js,O[5]=Zs,O[6]=Ys,O[7]=Xs,O[8]=Js,O[9]=Qs,O[10]=eo,O[11]=to,O[12]=ro,O[13]=no,O[14]=io,O[15]=so,O[16]=oo,O[17]=ao,O[18]=co,C!==0&&(O[19]=C,m.length++),m};Math.imul||(K=N);function P(w,c,h){h.negative=c.negative^w.negative,h.length=w.length+c.length;for(var m=0,E=0,S=0;S<h.length-1;S++){var O=E;E=0;for(var C=m&67108863,R=Math.min(S,c.length-1),y=Math.max(0,S-w.length+1);y<=R;y++){var T=S-y,ae=w.words[T]|0,ne=c.words[y]|0,le=ae*ne,Fe=le&67108863;O=O+(le/67108864|0)|0,Fe=Fe+C|0,C=Fe&67108863,O=O+(Fe>>>26)|0,E+=O>>>26,O&=67108863}h.words[S]=C,m=O,O=E}return m!==0?h.words[S]=m:h.length--,h._strip()}function $(w,c,h){return P(w,c,h)}s.prototype.mulTo=function(c,h){var m,E=this.length+c.length;return this.length===10&&c.length===10?m=K(this,c,h):E<63?m=N(this,c,h):E<1024?m=P(this,c,h):m=$(this,c,h),m},s.prototype.mul=function(c){var h=new s(null);return h.words=new Array(this.length+c.length),this.mulTo(c,h)},s.prototype.mulf=function(c){var h=new s(null);return h.words=new Array(this.length+c.length),$(this,c,h)},s.prototype.imul=function(c){return this.clone().mulTo(c,this)},s.prototype.imuln=function(c){var h=c<0;h&&(c=-c),r(typeof c=="number"),r(c<67108864);for(var m=0,E=0;E<this.length;E++){var S=(this.words[E]|0)*c,O=(S&67108863)+(m&67108863);m>>=26,m+=S/67108864|0,m+=O>>>26,this.words[E]=O&67108863}return m!==0&&(this.words[E]=m,this.length++),this.length=c===0?1:this.length,h?this.ineg():this},s.prototype.muln=function(c){return this.clone().imuln(c)},s.prototype.sqr=function(){return this.mul(this)},s.prototype.isqr=function(){return this.imul(this.clone())},s.prototype.pow=function(c){var h=A(c);if(h.length===0)return new s(1);for(var m=this,E=0;E<h.length&&h[E]===0;E++,m=m.sqr());if(++E<h.length)for(var S=m.sqr();E<h.length;E++,S=S.sqr())h[E]!==0&&(m=m.mul(S));return m},s.prototype.iushln=function(c){r(typeof c=="number"&&c>=0);var h=c%26,m=(c-h)/26,E=67108863>>>26-h<<26-h,S;if(h!==0){var O=0;for(S=0;S<this.length;S++){var C=this.words[S]&E,R=(this.words[S]|0)-C<<h;this.words[S]=R|O,O=C>>>26-h}O&&(this.words[S]=O,this.length++)}if(m!==0){for(S=this.length-1;S>=0;S--)this.words[S+m]=this.words[S];for(S=0;S<m;S++)this.words[S]=0;this.length+=m}return this._strip()},s.prototype.ishln=function(c){return r(this.negative===0),this.iushln(c)},s.prototype.iushrn=function(c,h,m){r(typeof c=="number"&&c>=0);var E;h?E=(h-h%26)/26:E=0;var S=c%26,O=Math.min((c-S)/26,this.length),C=67108863^67108863>>>S<<S,R=m;if(E-=O,E=Math.max(0,E),R){for(var y=0;y<O;y++)R.words[y]=this.words[y];R.length=O}if(O!==0)if(this.length>O)for(this.length-=O,y=0;y<this.length;y++)this.words[y]=this.words[y+O];else this.words[0]=0,this.length=1;var T=0;for(y=this.length-1;y>=0&&(T!==0||y>=E);y--){var ae=this.words[y]|0;this.words[y]=T<<26-S|ae>>>S,T=ae&C}return R&&T!==0&&(R.words[R.length++]=T),this.length===0&&(this.words[0]=0,this.length=1),this._strip()},s.prototype.ishrn=function(c,h,m){return r(this.negative===0),this.iushrn(c,h,m)},s.prototype.shln=function(c){return this.clone().ishln(c)},s.prototype.ushln=function(c){return this.clone().iushln(c)},s.prototype.shrn=function(c){return this.clone().ishrn(c)},s.prototype.ushrn=function(c){return this.clone().iushrn(c)},s.prototype.testn=function(c){r(typeof c=="number"&&c>=0);var h=c%26,m=(c-h)/26,E=1<<h;if(this.length<=m)return!1;var S=this.words[m];return!!(S&E)},s.prototype.imaskn=function(c){r(typeof c=="number"&&c>=0);var h=c%26,m=(c-h)/26;if(r(this.negative===0,"imaskn works only with positive numbers"),this.length<=m)return this;if(h!==0&&m++,this.length=Math.min(m,this.length),h!==0){var E=67108863^67108863>>>h<<h;this.words[this.length-1]&=E}return this._strip()},s.prototype.maskn=function(c){return this.clone().imaskn(c)},s.prototype.iaddn=function(c){return r(typeof c=="number"),r(c<67108864),c<0?this.isubn(-c):this.negative!==0?this.length===1&&(this.words[0]|0)<=c?(this.words[0]=c-(this.words[0]|0),this.negative=0,this):(this.negative=0,this.isubn(c),this.negative=1,this):this._iaddn(c)},s.prototype._iaddn=function(c){this.words[0]+=c;for(var h=0;h<this.length&&this.words[h]>=67108864;h++)this.words[h]-=67108864,h===this.length-1?this.words[h+1]=1:this.words[h+1]++;return this.length=Math.max(this.length,h+1),this},s.prototype.isubn=function(c){if(r(typeof c=="number"),r(c<67108864),c<0)return this.iaddn(-c);if(this.negative!==0)return this.negative=0,this.iaddn(c),this.negative=1,this;if(this.words[0]-=c,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var h=0;h<this.length&&this.words[h]<0;h++)this.words[h]+=67108864,this.words[h+1]-=1;return this._strip()},s.prototype.addn=function(c){return this.clone().iaddn(c)},s.prototype.subn=function(c){return this.clone().isubn(c)},s.prototype.iabs=function(){return this.negative=0,this},s.prototype.abs=function(){return this.clone().iabs()},s.prototype._ishlnsubmul=function(c,h,m){var E=c.length+m,S;this._expand(E);var O,C=0;for(S=0;S<c.length;S++){O=(this.words[S+m]|0)+C;var R=(c.words[S]|0)*h;O-=R&67108863,C=(O>>26)-(R/67108864|0),this.words[S+m]=O&67108863}for(;S<this.length-m;S++)O=(this.words[S+m]|0)+C,C=O>>26,this.words[S+m]=O&67108863;if(C===0)return this._strip();for(r(C===-1),C=0,S=0;S<this.length;S++)O=-(this.words[S]|0)+C,C=O>>26,this.words[S]=O&67108863;return this.negative=1,this._strip()},s.prototype._wordDiv=function(c,h){var m=this.length-c.length,E=this.clone(),S=c,O=S.words[S.length-1]|0,C=this._countBits(O);m=26-C,m!==0&&(S=S.ushln(m),E.iushln(m),O=S.words[S.length-1]|0);var R=E.length-S.length,y;if(h!=="mod"){y=new s(null),y.length=R+1,y.words=new Array(y.length);for(var T=0;T<y.length;T++)y.words[T]=0}var ae=E.clone()._ishlnsubmul(S,1,R);ae.negative===0&&(E=ae,y&&(y.words[R]=1));for(var ne=R-1;ne>=0;ne--){var le=(E.words[S.length+ne]|0)*67108864+(E.words[S.length+ne-1]|0);for(le=Math.min(le/O|0,67108863),E._ishlnsubmul(S,le,ne);E.negative!==0;)le--,E.negative=0,E._ishlnsubmul(S,1,ne),E.isZero()||(E.negative^=1);y&&(y.words[ne]=le)}return y&&y._strip(),E._strip(),h!=="div"&&m!==0&&E.iushrn(m),{div:y||null,mod:E}},s.prototype.divmod=function(c,h,m){if(r(!c.isZero()),this.isZero())return{div:new s(0),mod:new s(0)};var E,S,O;return this.negative!==0&&c.negative===0?(O=this.neg().divmod(c,h),h!=="mod"&&(E=O.div.neg()),h!=="div"&&(S=O.mod.neg(),m&&S.negative!==0&&S.iadd(c)),{div:E,mod:S}):this.negative===0&&c.negative!==0?(O=this.divmod(c.neg(),h),h!=="mod"&&(E=O.div.neg()),{div:E,mod:O.mod}):this.negative&c.negative?(O=this.neg().divmod(c.neg(),h),h!=="div"&&(S=O.mod.neg(),m&&S.negative!==0&&S.isub(c)),{div:O.div,mod:S}):c.length>this.length||this.cmp(c)<0?{div:new s(0),mod:this}:c.length===1?h==="div"?{div:this.divn(c.words[0]),mod:null}:h==="mod"?{div:null,mod:new s(this.modrn(c.words[0]))}:{div:this.divn(c.words[0]),mod:new s(this.modrn(c.words[0]))}:this._wordDiv(c,h)},s.prototype.div=function(c){return this.divmod(c,"div",!1).div},s.prototype.mod=function(c){return this.divmod(c,"mod",!1).mod},s.prototype.umod=function(c){return this.divmod(c,"mod",!0).mod},s.prototype.divRound=function(c){var h=this.divmod(c);if(h.mod.isZero())return h.div;var m=h.div.negative!==0?h.mod.isub(c):h.mod,E=c.ushrn(1),S=c.andln(1),O=m.cmp(E);return O<0||S===1&&O===0?h.div:h.div.negative!==0?h.div.isubn(1):h.div.iaddn(1)},s.prototype.modrn=function(c){var h=c<0;h&&(c=-c),r(c<=67108863);for(var m=(1<<26)%c,E=0,S=this.length-1;S>=0;S--)E=(m*E+(this.words[S]|0))%c;return h?-E:E},s.prototype.modn=function(c){return this.modrn(c)},s.prototype.idivn=function(c){var h=c<0;h&&(c=-c),r(c<=67108863);for(var m=0,E=this.length-1;E>=0;E--){var S=(this.words[E]|0)+m*67108864;this.words[E]=S/c|0,m=S%c}return this._strip(),h?this.ineg():this},s.prototype.divn=function(c){return this.clone().idivn(c)},s.prototype.egcd=function(c){r(c.negative===0),r(!c.isZero());var h=this,m=c.clone();h.negative!==0?h=h.umod(c):h=h.clone();for(var E=new s(1),S=new s(0),O=new s(0),C=new s(1),R=0;h.isEven()&&m.isEven();)h.iushrn(1),m.iushrn(1),++R;for(var y=m.clone(),T=h.clone();!h.isZero();){for(var ae=0,ne=1;!(h.words[0]&ne)&&ae<26;++ae,ne<<=1);if(ae>0)for(h.iushrn(ae);ae-- >0;)(E.isOdd()||S.isOdd())&&(E.iadd(y),S.isub(T)),E.iushrn(1),S.iushrn(1);for(var le=0,Fe=1;!(m.words[0]&Fe)&&le<26;++le,Fe<<=1);if(le>0)for(m.iushrn(le);le-- >0;)(O.isOdd()||C.isOdd())&&(O.iadd(y),C.isub(T)),O.iushrn(1),C.iushrn(1);h.cmp(m)>=0?(h.isub(m),E.isub(O),S.isub(C)):(m.isub(h),O.isub(E),C.isub(S))}return{a:O,b:C,gcd:m.iushln(R)}},s.prototype._invmp=function(c){r(c.negative===0),r(!c.isZero());var h=this,m=c.clone();h.negative!==0?h=h.umod(c):h=h.clone();for(var E=new s(1),S=new s(0),O=m.clone();h.cmpn(1)>0&&m.cmpn(1)>0;){for(var C=0,R=1;!(h.words[0]&R)&&C<26;++C,R<<=1);if(C>0)for(h.iushrn(C);C-- >0;)E.isOdd()&&E.iadd(O),E.iushrn(1);for(var y=0,T=1;!(m.words[0]&T)&&y<26;++y,T<<=1);if(y>0)for(m.iushrn(y);y-- >0;)S.isOdd()&&S.iadd(O),S.iushrn(1);h.cmp(m)>=0?(h.isub(m),E.isub(S)):(m.isub(h),S.isub(E))}var ae;return h.cmpn(1)===0?ae=E:ae=S,ae.cmpn(0)<0&&ae.iadd(c),ae},s.prototype.gcd=function(c){if(this.isZero())return c.abs();if(c.isZero())return this.abs();var h=this.clone(),m=c.clone();h.negative=0,m.negative=0;for(var E=0;h.isEven()&&m.isEven();E++)h.iushrn(1),m.iushrn(1);do{for(;h.isEven();)h.iushrn(1);for(;m.isEven();)m.iushrn(1);var S=h.cmp(m);if(S<0){var O=h;h=m,m=O}else if(S===0||m.cmpn(1)===0)break;h.isub(m)}while(!0);return m.iushln(E)},s.prototype.invm=function(c){return this.egcd(c).a.umod(c)},s.prototype.isEven=function(){return(this.words[0]&1)===0},s.prototype.isOdd=function(){return(this.words[0]&1)===1},s.prototype.andln=function(c){return this.words[0]&c},s.prototype.bincn=function(c){r(typeof c=="number");var h=c%26,m=(c-h)/26,E=1<<h;if(this.length<=m)return this._expand(m+1),this.words[m]|=E,this;for(var S=E,O=m;S!==0&&O<this.length;O++){var C=this.words[O]|0;C+=S,S=C>>>26,C&=67108863,this.words[O]=C}return S!==0&&(this.words[O]=S,this.length++),this},s.prototype.isZero=function(){return this.length===1&&this.words[0]===0},s.prototype.cmpn=function(c){var h=c<0;if(this.negative!==0&&!h)return-1;if(this.negative===0&&h)return 1;this._strip();var m;if(this.length>1)m=1;else{h&&(c=-c),r(c<=67108863,"Number is too big");var E=this.words[0]|0;m=E===c?0:E<c?-1:1}return this.negative!==0?-m|0:m},s.prototype.cmp=function(c){if(this.negative!==0&&c.negative===0)return-1;if(this.negative===0&&c.negative!==0)return 1;var h=this.ucmp(c);return this.negative!==0?-h|0:h},s.prototype.ucmp=function(c){if(this.length>c.length)return 1;if(this.length<c.length)return-1;for(var h=0,m=this.length-1;m>=0;m--){var E=this.words[m]|0,S=c.words[m]|0;if(E!==S){E<S?h=-1:E>S&&(h=1);break}}return h},s.prototype.gtn=function(c){return this.cmpn(c)===1},s.prototype.gt=function(c){return this.cmp(c)===1},s.prototype.gten=function(c){return this.cmpn(c)>=0},s.prototype.gte=function(c){return this.cmp(c)>=0},s.prototype.ltn=function(c){return this.cmpn(c)===-1},s.prototype.lt=function(c){return this.cmp(c)===-1},s.prototype.lten=function(c){return this.cmpn(c)<=0},s.prototype.lte=function(c){return this.cmp(c)<=0},s.prototype.eqn=function(c){return this.cmpn(c)===0},s.prototype.eq=function(c){return this.cmp(c)===0},s.red=function(c){return new M(c)},s.prototype.toRed=function(c){return r(!this.red,"Already a number in reduction context"),r(this.negative===0,"red works only with positives"),c.convertTo(this)._forceRed(c)},s.prototype.fromRed=function(){return r(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},s.prototype._forceRed=function(c){return this.red=c,this},s.prototype.forceRed=function(c){return r(!this.red,"Already a number in reduction context"),this._forceRed(c)},s.prototype.redAdd=function(c){return r(this.red,"redAdd works only with red numbers"),this.red.add(this,c)},s.prototype.redIAdd=function(c){return r(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,c)},s.prototype.redSub=function(c){return r(this.red,"redSub works only with red numbers"),this.red.sub(this,c)},s.prototype.redISub=function(c){return r(this.red,"redISub works only with red numbers"),this.red.isub(this,c)},s.prototype.redShl=function(c){return r(this.red,"redShl works only with red numbers"),this.red.shl(this,c)},s.prototype.redMul=function(c){return r(this.red,"redMul works only with red numbers"),this.red._verify2(this,c),this.red.mul(this,c)},s.prototype.redIMul=function(c){return r(this.red,"redMul works only with red numbers"),this.red._verify2(this,c),this.red.imul(this,c)},s.prototype.redSqr=function(){return r(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},s.prototype.redISqr=function(){return r(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},s.prototype.redSqrt=function(){return r(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},s.prototype.redInvm=function(){return r(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},s.prototype.redNeg=function(){return r(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},s.prototype.redPow=function(c){return r(this.red&&!c.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,c)};var L={k256:null,p224:null,p192:null,p25519:null};function X(w,c){this.name=w,this.p=new s(c,16),this.n=this.p.bitLength(),this.k=new s(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}X.prototype._tmp=function(){var c=new s(null);return c.words=new Array(Math.ceil(this.n/13)),c},X.prototype.ireduce=function(c){var h=c,m;do this.split(h,this.tmp),h=this.imulK(h),h=h.iadd(this.tmp),m=h.bitLength();while(m>this.n);var E=m<this.n?-1:h.ucmp(this.p);return E===0?(h.words[0]=0,h.length=1):E>0?h.isub(this.p):h.strip!==void 0?h.strip():h._strip(),h},X.prototype.split=function(c,h){c.iushrn(this.n,0,h)},X.prototype.imulK=function(c){return c.imul(this.k)};function V(){X.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}i(V,X),V.prototype.split=function(c,h){for(var m=4194303,E=Math.min(c.length,9),S=0;S<E;S++)h.words[S]=c.words[S];if(h.length=E,c.length<=9){c.words[0]=0,c.length=1;return}var O=c.words[9];for(h.words[h.length++]=O&m,S=10;S<c.length;S++){var C=c.words[S]|0;c.words[S-10]=(C&m)<<4|O>>>22,O=C}O>>>=22,c.words[S-10]=O,O===0&&c.length>10?c.length-=10:c.length-=9},V.prototype.imulK=function(c){c.words[c.length]=0,c.words[c.length+1]=0,c.length+=2;for(var h=0,m=0;m<c.length;m++){var E=c.words[m]|0;h+=E*977,c.words[m]=h&67108863,h=E*64+(h/67108864|0)}return c.words[c.length-1]===0&&(c.length--,c.words[c.length-1]===0&&c.length--),c};function Y(){X.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}i(Y,X);function U(){X.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}i(U,X);function G(){X.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}i(G,X),G.prototype.imulK=function(c){for(var h=0,m=0;m<c.length;m++){var E=(c.words[m]|0)*19+h,S=E&67108863;E>>>=26,c.words[m]=S,h=E}return h!==0&&(c.words[c.length++]=h),c},s._prime=function(c){if(L[c])return L[c];var h;if(c==="k256")h=new V;else if(c==="p224")h=new Y;else if(c==="p192")h=new U;else if(c==="p25519")h=new G;else throw new Error("Unknown prime "+c);return L[c]=h,h};function M(w){if(typeof w=="string"){var c=s._prime(w);this.m=c.p,this.prime=c}else r(w.gtn(1),"modulus must be greater than 1"),this.m=w,this.prime=null}M.prototype._verify1=function(c){r(c.negative===0,"red works only with positives"),r(c.red,"red works only with red numbers")},M.prototype._verify2=function(c,h){r((c.negative|h.negative)===0,"red works only with positives"),r(c.red&&c.red===h.red,"red works only with red numbers")},M.prototype.imod=function(c){return this.prime?this.prime.ireduce(c)._forceRed(this):(f(c,c.umod(this.m)._forceRed(this)),c)},M.prototype.neg=function(c){return c.isZero()?c.clone():this.m.sub(c)._forceRed(this)},M.prototype.add=function(c,h){this._verify2(c,h);var m=c.add(h);return m.cmp(this.m)>=0&&m.isub(this.m),m._forceRed(this)},M.prototype.iadd=function(c,h){this._verify2(c,h);var m=c.iadd(h);return m.cmp(this.m)>=0&&m.isub(this.m),m},M.prototype.sub=function(c,h){this._verify2(c,h);var m=c.sub(h);return m.cmpn(0)<0&&m.iadd(this.m),m._forceRed(this)},M.prototype.isub=function(c,h){this._verify2(c,h);var m=c.isub(h);return m.cmpn(0)<0&&m.iadd(this.m),m},M.prototype.shl=function(c,h){return this._verify1(c),this.imod(c.ushln(h))},M.prototype.imul=function(c,h){return this._verify2(c,h),this.imod(c.imul(h))},M.prototype.mul=function(c,h){return this._verify2(c,h),this.imod(c.mul(h))},M.prototype.isqr=function(c){return this.imul(c,c.clone())},M.prototype.sqr=function(c){return this.mul(c,c)},M.prototype.sqrt=function(c){if(c.isZero())return c.clone();var h=this.m.andln(3);if(r(h%2===1),h===3){var m=this.m.add(new s(1)).iushrn(2);return this.pow(c,m)}for(var E=this.m.subn(1),S=0;!E.isZero()&&E.andln(1)===0;)S++,E.iushrn(1);r(!E.isZero());var O=new s(1).toRed(this),C=O.redNeg(),R=this.m.subn(1).iushrn(1),y=this.m.bitLength();for(y=new s(2*y*y).toRed(this);this.pow(y,R).cmp(C)!==0;)y.redIAdd(C);for(var T=this.pow(y,E),ae=this.pow(c,E.addn(1).iushrn(1)),ne=this.pow(c,E),le=S;ne.cmp(O)!==0;){for(var Fe=ne,Ee=0;Fe.cmp(O)!==0;Ee++)Fe=Fe.redSqr();r(Ee<le);var Ae=this.pow(T,new s(1).iushln(le-Ee-1));ae=ae.redMul(Ae),T=Ae.redSqr(),ne=ne.redMul(T),le=Ee}return ae},M.prototype.invm=function(c){var h=c._invmp(this.m);return h.negative!==0?(h.negative=0,this.imod(h).redNeg()):this.imod(h)},M.prototype.pow=function(c,h){if(h.isZero())return new s(1).toRed(this);if(h.cmpn(1)===0)return c.clone();var m=4,E=new Array(1<<m);E[0]=new s(1).toRed(this),E[1]=c;for(var S=2;S<E.length;S++)E[S]=this.mul(E[S-1],c);var O=E[0],C=0,R=0,y=h.bitLength()%26;for(y===0&&(y=26),S=h.length-1;S>=0;S--){for(var T=h.words[S],ae=y-1;ae>=0;ae--){var ne=T>>ae&1;if(O!==E[0]&&(O=this.sqr(O)),ne===0&&C===0){R=0;continue}C<<=1,C|=ne,R++,!(R!==m&&(S!==0||ae!==0))&&(O=this.mul(O,E[C]),R=0,C=0)}y=26}return O},M.prototype.convertTo=function(c){var h=c.umod(this.m);return h===c?h.clone():h},M.prototype.convertFrom=function(c){var h=c.clone();return h.red=null,h},s.mont=function(c){return new D(c)};function D(w){M.call(this,w),this.shift=this.m.bitLength(),this.shift%26!==0&&(this.shift+=26-this.shift%26),this.r=new s(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}i(D,M),D.prototype.convertTo=function(c){return this.imod(c.ushln(this.shift))},D.prototype.convertFrom=function(c){var h=this.imod(c.mul(this.rinv));return h.red=null,h},D.prototype.imul=function(c,h){if(c.isZero()||h.isZero())return c.words[0]=0,c.length=1,c;var m=c.imul(h),E=m.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),S=m.isub(E).iushrn(this.shift),O=S;return S.cmp(this.m)>=0?O=S.isub(this.m):S.cmpn(0)<0&&(O=S.iadd(this.m)),O._forceRed(this)},D.prototype.mul=function(c,h){if(c.isZero()||h.isZero())return new s(0)._forceRed(this);var m=c.mul(h),E=m.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),S=m.isub(E).iushrn(this.shift),O=S;return S.cmp(this.m)>=0?O=S.isub(this.m):S.cmpn(0)<0&&(O=S.iadd(this.m)),O._forceRed(this)},D.prototype.invm=function(c){var h=this.imod(c._invmp(this.m).mul(this.r2));return h._forceRed(this)}})(n,Zt)})(ga);var ma=ga.exports;const Mt=Vn(ma);var Wo={exports:{}};/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */(function(n,e){var t=te,r=t.Buffer;function i(o,a){for(var u in o)a[u]=o[u]}r.from&&r.alloc&&r.allocUnsafe&&r.allocUnsafeSlow?n.exports=t:(i(t,e),e.Buffer=s);function s(o,a,u){return r(o,a,u)}s.prototype=Object.create(r.prototype),i(r,s),s.from=function(o,a,u){if(typeof o=="number")throw new TypeError("Argument must not be a number");return r(o,a,u)},s.alloc=function(o,a,u){if(typeof o!="number")throw new TypeError("Argument must be a number");var l=r(o);return a!==void 0?typeof u=="string"?l.fill(a,u):l.fill(a):l.fill(0),l},s.allocUnsafe=function(o){if(typeof o!="number")throw new TypeError("Argument must be a number");return r(o)},s.allocUnsafeSlow=function(o){if(typeof o!="number")throw new TypeError("Argument must be a number");return t.SlowBuffer(o)}})(Wo,Wo.exports);var v0=Wo.exports,Fi=v0.Buffer;function S0(n){if(n.length>=255)throw new TypeError("Alphabet too long");for(var e=new Uint8Array(256),t=0;t<e.length;t++)e[t]=255;for(var r=0;r<n.length;r++){var i=n.charAt(r),s=i.charCodeAt(0);if(e[s]!==255)throw new TypeError(i+" is ambiguous");e[s]=r}var o=n.length,a=n.charAt(0),u=Math.log(o)/Math.log(256),l=Math.log(256)/Math.log(o);function f(g){if((Array.isArray(g)||g instanceof Uint8Array)&&(g=Fi.from(g)),!Fi.isBuffer(g))throw new TypeError("Expected Buffer");if(g.length===0)return"";for(var v=0,x=0,A=0,N=g.length;A!==N&&g[A]===0;)A++,v++;for(var K=(N-A)*l+1>>>0,P=new Uint8Array(K);A!==N;){for(var $=g[A],L=0,X=K-1;($!==0||L<x)&&X!==-1;X--,L++)$+=256*P[X]>>>0,P[X]=$%o>>>0,$=$/o>>>0;if($!==0)throw new Error("Non-zero carry");x=L,A++}for(var V=K-x;V!==K&&P[V]===0;)V++;for(var Y=a.repeat(v);V<K;++V)Y+=n.charAt(P[V]);return Y}function _(g){if(typeof g!="string")throw new TypeError("Expected String");if(g.length===0)return Fi.alloc(0);for(var v=0,x=0,A=0;g[v]===a;)x++,v++;for(var N=(g.length-v)*u+1>>>0,K=new Uint8Array(N);v<g.length;){var P=g.charCodeAt(v);if(P>255)return;var $=e[P];if($===255)return;for(var L=0,X=N-1;($!==0||L<A)&&X!==-1;X--,L++)$+=o*K[X]>>>0,K[X]=$%256>>>0,$=$/256>>>0;if($!==0)throw new Error("Non-zero carry");A=L,v++}for(var V=N-A;V!==N&&K[V]===0;)V++;var Y=Fi.allocUnsafe(x+(N-V));Y.fill(0,0,x);for(var U=x;V!==N;)Y[U++]=K[V++];return Y}function I(g){var v=_(g);if(v)return v;throw new Error("Non-base"+o+" character")}return{encode:f,decodeUnsafe:_,decode:I}}var I0=S0,k0=I0,T0="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz",ll=k0(T0);const Et=Vn(ll),vc=Zu;var It={};function Lr(n,e,t){return e<=n&&n<=t}function As(n){if(n===void 0)return{};if(n===Object(n))return n;throw TypeError("Could not convert argument to dictionary")}function x0(n){for(var e=String(n),t=e.length,r=0,i=[];r<t;){var s=e.charCodeAt(r);if(s<55296||s>57343)i.push(s);else if(56320<=s&&s<=57343)i.push(65533);else if(55296<=s&&s<=56319)if(r===t-1)i.push(65533);else{var o=n.charCodeAt(r+1);if(56320<=o&&o<=57343){var a=s&1023,u=o&1023;i.push(65536+(a<<10)+u),r+=1}else i.push(65533)}r+=1}return i}function O0(n){for(var e="",t=0;t<n.length;++t){var r=n[t];r<=65535?e+=String.fromCharCode(r):(r-=65536,e+=String.fromCharCode((r>>10)+55296,(r&1023)+56320))}return e}var ns=-1;function wa(n){this.tokens=[].slice.call(n)}wa.prototype={endOfStream:function(){return!this.tokens.length},read:function(){return this.tokens.length?this.tokens.shift():ns},prepend:function(n){if(Array.isArray(n))for(var e=n;e.length;)this.tokens.unshift(e.pop());else this.tokens.unshift(n)},push:function(n){if(Array.isArray(n))for(var e=n;e.length;)this.tokens.push(e.shift());else this.tokens.push(n)}};var $n=-1;function mo(n,e){if(n)throw TypeError("Decoder error");return e||65533}var is="utf-8";function ss(n,e){if(!(this instanceof ss))return new ss(n,e);if(n=n!==void 0?String(n).toLowerCase():is,n!==is)throw new Error("Encoding not supported. Only utf-8 is supported");e=As(e),this._streaming=!1,this._BOMseen=!1,this._decoder=null,this._fatal=!!e.fatal,this._ignoreBOM=!!e.ignoreBOM,Object.defineProperty(this,"encoding",{value:"utf-8"}),Object.defineProperty(this,"fatal",{value:this._fatal}),Object.defineProperty(this,"ignoreBOM",{value:this._ignoreBOM})}ss.prototype={decode:function(e,t){var r;typeof e=="object"&&e instanceof ArrayBuffer?r=new Uint8Array(e):typeof e=="object"&&"buffer"in e&&e.buffer instanceof ArrayBuffer?r=new Uint8Array(e.buffer,e.byteOffset,e.byteLength):r=new Uint8Array(0),t=As(t),this._streaming||(this._decoder=new N0({fatal:this._fatal}),this._BOMseen=!1),this._streaming=!!t.stream;for(var i=new wa(r),s=[],o;!i.endOfStream()&&(o=this._decoder.handler(i,i.read()),o!==$n);)o!==null&&(Array.isArray(o)?s.push.apply(s,o):s.push(o));if(!this._streaming){do{if(o=this._decoder.handler(i,i.read()),o===$n)break;o!==null&&(Array.isArray(o)?s.push.apply(s,o):s.push(o))}while(!i.endOfStream());this._decoder=null}return s.length&&["utf-8"].indexOf(this.encoding)!==-1&&!this._ignoreBOM&&!this._BOMseen&&(s[0]===65279?(this._BOMseen=!0,s.shift()):this._BOMseen=!0),O0(s)}};function os(n,e){if(!(this instanceof os))return new os(n,e);if(n=n!==void 0?String(n).toLowerCase():is,n!==is)throw new Error("Encoding not supported. Only utf-8 is supported");e=As(e),this._streaming=!1,this._encoder=null,this._options={fatal:!!e.fatal},Object.defineProperty(this,"encoding",{value:"utf-8"})}os.prototype={encode:function(e,t){e=e?String(e):"",t=As(t),this._streaming||(this._encoder=new C0(this._options)),this._streaming=!!t.stream;for(var r=[],i=new wa(x0(e)),s;!i.endOfStream()&&(s=this._encoder.handler(i,i.read()),s!==$n);)Array.isArray(s)?r.push.apply(r,s):r.push(s);if(!this._streaming){for(;s=this._encoder.handler(i,i.read()),s!==$n;)Array.isArray(s)?r.push.apply(r,s):r.push(s);this._encoder=null}return new Uint8Array(r)}};function N0(n){var e=n.fatal,t=0,r=0,i=0,s=128,o=191;this.handler=function(a,u){if(u===ns&&i!==0)return i=0,mo(e);if(u===ns)return $n;if(i===0){if(Lr(u,0,127))return u;if(Lr(u,194,223))i=1,t=u-192;else if(Lr(u,224,239))u===224&&(s=160),u===237&&(o=159),i=2,t=u-224;else if(Lr(u,240,244))u===240&&(s=144),u===244&&(o=143),i=3,t=u-240;else return mo(e);return t=t<<6*i,null}if(!Lr(u,s,o))return t=i=r=0,s=128,o=191,a.prepend(u),mo(e);if(s=128,o=191,r+=1,t+=u-128<<6*(i-r),r!==i)return null;var l=t;return t=i=r=0,l}}function C0(n){n.fatal,this.handler=function(e,t){if(t===ns)return $n;if(Lr(t,0,127))return t;var r,i;Lr(t,128,2047)?(r=1,i=192):Lr(t,2048,65535)?(r=2,i=224):Lr(t,65536,1114111)&&(r=3,i=240);for(var s=[(t>>6*r)+i];r>0;){var o=t>>6*(r-1);s.push(128|o&63),r-=1}return s}}const B0=Object.freeze(Object.defineProperty({__proto__:null,TextDecoder:ss,TextEncoder:os},Symbol.toStringTag,{value:"Module"})),M0=gs(B0);var L0=Zt&&Zt.__createBinding||(Object.create?function(n,e,t,r){r===void 0&&(r=t),Object.defineProperty(n,r,{enumerable:!0,get:function(){return e[t]}})}:function(n,e,t,r){r===void 0&&(r=t),n[r]=e[t]}),P0=Zt&&Zt.__setModuleDefault||(Object.create?function(n,e){Object.defineProperty(n,"default",{enumerable:!0,value:e})}:function(n,e){n.default=e}),Rr=Zt&&Zt.__decorate||function(n,e,t,r){var i=arguments.length,s=i<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,t):r,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,e,t,r);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s},U0=Zt&&Zt.__importStar||function(n){if(n&&n.__esModule)return n;var e={};if(n!=null)for(var t in n)t!=="default"&&Object.hasOwnProperty.call(n,t)&&L0(e,n,t);return P0(e,n),e},hl=Zt&&Zt.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(It,"__esModule",{value:!0});var fl=It.deserializeUnchecked=wl=It.deserialize=ml=It.serialize=It.BinaryReader=It.BinaryWriter=It.BorshError=It.baseDecode=It.baseEncode=void 0;const Zr=hl(ma),dl=hl(ll),D0=U0(M0),F0=typeof TextDecoder!="function"?D0.TextDecoder:TextDecoder,H0=new F0("utf-8",{fatal:!0});function z0(n){return typeof n=="string"&&(n=Buffer.from(n,"utf8")),dl.default.encode(Buffer.from(n))}It.baseEncode=z0;function $0(n){return Buffer.from(dl.default.decode(n))}It.baseDecode=$0;const wo=1024;class Pt extends Error{constructor(e){super(e),this.fieldPath=[],this.originalMessage=e}addToFieldPath(e){this.fieldPath.splice(0,0,e),this.message=this.originalMessage+": "+this.fieldPath.join(".")}}It.BorshError=Pt;class pl{constructor(){this.buf=Buffer.alloc(wo),this.length=0}maybeResize(){this.buf.length<16+this.length&&(this.buf=Buffer.concat([this.buf,Buffer.alloc(wo)]))}writeU8(e){this.maybeResize(),this.buf.writeUInt8(e,this.length),this.length+=1}writeU16(e){this.maybeResize(),this.buf.writeUInt16LE(e,this.length),this.length+=2}writeU32(e){this.maybeResize(),this.buf.writeUInt32LE(e,this.length),this.length+=4}writeU64(e){this.maybeResize(),this.writeBuffer(Buffer.from(new Zr.default(e).toArray("le",8)))}writeU128(e){this.maybeResize(),this.writeBuffer(Buffer.from(new Zr.default(e).toArray("le",16)))}writeU256(e){this.maybeResize(),this.writeBuffer(Buffer.from(new Zr.default(e).toArray("le",32)))}writeU512(e){this.maybeResize(),this.writeBuffer(Buffer.from(new Zr.default(e).toArray("le",64)))}writeBuffer(e){this.buf=Buffer.concat([Buffer.from(this.buf.subarray(0,this.length)),e,Buffer.alloc(wo)]),this.length+=e.length}writeString(e){this.maybeResize();const t=Buffer.from(e,"utf8");this.writeU32(t.length),this.writeBuffer(t)}writeFixedArray(e){this.writeBuffer(Buffer.from(e))}writeArray(e,t){this.maybeResize(),this.writeU32(e.length);for(const r of e)this.maybeResize(),t(r)}toArray(){return this.buf.subarray(0,this.length)}}It.BinaryWriter=pl;function Ar(n,e,t){const r=t.value;t.value=function(...i){try{return r.apply(this,i)}catch(s){if(s instanceof RangeError){const o=s.code;if(["ERR_BUFFER_OUT_OF_BOUNDS","ERR_OUT_OF_RANGE"].indexOf(o)>=0)throw new Pt("Reached the end of buffer when deserializing")}throw s}}}class Yt{constructor(e){this.buf=e,this.offset=0}readU8(){const e=this.buf.readUInt8(this.offset);return this.offset+=1,e}readU16(){const e=this.buf.readUInt16LE(this.offset);return this.offset+=2,e}readU32(){const e=this.buf.readUInt32LE(this.offset);return this.offset+=4,e}readU64(){const e=this.readBuffer(8);return new Zr.default(e,"le")}readU128(){const e=this.readBuffer(16);return new Zr.default(e,"le")}readU256(){const e=this.readBuffer(32);return new Zr.default(e,"le")}readU512(){const e=this.readBuffer(64);return new Zr.default(e,"le")}readBuffer(e){if(this.offset+e>this.buf.length)throw new Pt(`Expected buffer length ${e} isn't within bounds`);const t=this.buf.slice(this.offset,this.offset+e);return this.offset+=e,t}readString(){const e=this.readU32(),t=this.readBuffer(e);try{return H0.decode(t)}catch(r){throw new Pt(`Error decoding UTF-8 string: ${r}`)}}readFixedArray(e){return new Uint8Array(this.readBuffer(e))}readArray(e){const t=this.readU32(),r=Array();for(let i=0;i<t;++i)r.push(e());return r}}Rr([Ar],Yt.prototype,"readU8",null);Rr([Ar],Yt.prototype,"readU16",null);Rr([Ar],Yt.prototype,"readU32",null);Rr([Ar],Yt.prototype,"readU64",null);Rr([Ar],Yt.prototype,"readU128",null);Rr([Ar],Yt.prototype,"readU256",null);Rr([Ar],Yt.prototype,"readU512",null);Rr([Ar],Yt.prototype,"readString",null);Rr([Ar],Yt.prototype,"readFixedArray",null);Rr([Ar],Yt.prototype,"readArray",null);It.BinaryReader=Yt;function yl(n){return n.charAt(0).toUpperCase()+n.slice(1)}function on(n,e,t,r,i){try{if(typeof r=="string")i[`write${yl(r)}`](t);else if(r instanceof Array)if(typeof r[0]=="number"){if(t.length!==r[0])throw new Pt(`Expecting byte array of length ${r[0]}, but got ${t.length} bytes`);i.writeFixedArray(t)}else if(r.length===2&&typeof r[1]=="number"){if(t.length!==r[1])throw new Pt(`Expecting byte array of length ${r[1]}, but got ${t.length} bytes`);for(let s=0;s<r[1];s++)on(n,null,t[s],r[0],i)}else i.writeArray(t,s=>{on(n,e,s,r[0],i)});else if(r.kind!==void 0)switch(r.kind){case"option":{t==null?i.writeU8(0):(i.writeU8(1),on(n,e,t,r.type,i));break}case"map":{i.writeU32(t.size),t.forEach((s,o)=>{on(n,e,o,r.key,i),on(n,e,s,r.value,i)});break}default:throw new Pt(`FieldType ${r} unrecognized`)}else gl(n,t,i)}catch(s){throw s instanceof Pt&&s.addToFieldPath(e),s}}function gl(n,e,t){if(typeof e.borshSerialize=="function"){e.borshSerialize(t);return}const r=n.get(e.constructor);if(!r)throw new Pt(`Class ${e.constructor.name} is missing in schema`);if(r.kind==="struct")r.fields.map(([i,s])=>{on(n,i,e[i],s,t)});else if(r.kind==="enum"){const i=e[r.field];for(let s=0;s<r.values.length;++s){const[o,a]=r.values[s];if(o===i){t.writeU8(s),on(n,o,e[o],a,t);break}}}else throw new Pt(`Unexpected schema kind: ${r.kind} for ${e.constructor.name}`)}function K0(n,e,t=pl){const r=new t;return gl(n,e,r),r.toArray()}var ml=It.serialize=K0;function an(n,e,t,r){try{if(typeof t=="string")return r[`read${yl(t)}`]();if(t instanceof Array){if(typeof t[0]=="number")return r.readFixedArray(t[0]);if(typeof t[1]=="number"){const i=[];for(let s=0;s<t[1];s++)i.push(an(n,null,t[0],r));return i}else return r.readArray(()=>an(n,e,t[0],r))}if(t.kind==="option")return r.readU8()?an(n,e,t.type,r):void 0;if(t.kind==="map"){let i=new Map;const s=r.readU32();for(let o=0;o<s;o++){const a=an(n,e,t.key,r),u=an(n,e,t.value,r);i.set(a,u)}return i}return _a(n,t,r)}catch(i){throw i instanceof Pt&&i.addToFieldPath(e),i}}function _a(n,e,t){if(typeof e.borshDeserialize=="function")return e.borshDeserialize(t);const r=n.get(e);if(!r)throw new Pt(`Class ${e.name} is missing in schema`);if(r.kind==="struct"){const i={};for(const[s,o]of n.get(e).fields)i[s]=an(n,s,o,t);return new e(i)}if(r.kind==="enum"){const i=t.readU8();if(i>=r.values.length)throw new Pt(`Enum index: ${i} is out of range`);const[s,o]=r.values[i],a=an(n,s,o,t);return new e({[s]:a})}throw new Pt(`Unexpected schema kind: ${r.kind} for ${e.constructor.name}`)}function W0(n,e,t,r=Yt){const i=new r(t),s=_a(n,e,i);if(i.offset<t.length)throw new Pt(`Unexpected ${t.length-i.offset} bytes after deserialized data`);return s}var wl=It.deserialize=W0;function G0(n,e,t,r=Yt){const i=new r(t);return _a(n,e,i)}fl=It.deserializeUnchecked=G0;var W={};Object.defineProperty(W,"__esModule",{value:!0});W.s16=W.s8=W.nu64be=W.u48be=W.u40be=W.u32be=W.u24be=W.u16be=St=W.nu64=W.u48=W.u40=ce=W.u32=W.u24=er=W.u16=ve=W.u8=Xr=W.offset=W.greedy=W.Constant=W.UTF8=W.CString=W.Blob=W.Boolean=W.BitField=W.BitStructure=W.VariantLayout=W.Union=W.UnionLayoutDiscriminator=W.UnionDiscriminator=W.Structure=W.Sequence=W.DoubleBE=W.Double=W.FloatBE=W.Float=W.NearInt64BE=W.NearInt64=W.NearUInt64BE=W.NearUInt64=W.IntBE=W.Int=W.UIntBE=W.UInt=W.OffsetLayout=W.GreedyCount=W.ExternalLayout=W.bindConstructorLayout=W.nameWithProperty=W.Layout=W.uint8ArrayToBuffer=W.checkUint8Array=void 0;W.constant=W.utf8=W.cstr=Le=W.blob=W.unionLayoutDiscriminator=W.union=kt=W.seq=W.bits=ue=W.struct=W.f64be=W.f64=W.f32be=W.f32=W.ns64be=W.s48be=W.s40be=W.s32be=W.s24be=W.s16be=Vt=W.ns64=W.s48=W.s40=W.s32=W.s24=void 0;const ba=te;function Yn(n){if(!(n instanceof Uint8Array))throw new TypeError("b must be a Uint8Array")}W.checkUint8Array=Yn;function xe(n){return Yn(n),ba.Buffer.from(n.buffer,n.byteOffset,n.length)}W.uint8ArrayToBuffer=xe;let Be=class{constructor(e,t){if(!Number.isInteger(e))throw new TypeError("span must be an integer");this.span=e,this.property=t}makeDestinationObject(){return{}}getSpan(e,t){if(0>this.span)throw new RangeError("indeterminate span");return this.span}replicate(e){const t=Object.create(this.constructor.prototype);return Object.assign(t,this),t.property=e,t}fromArray(e){}};W.Layout=Be;function Ea(n,e){return e.property?n+"["+e.property+"]":n}W.nameWithProperty=Ea;function q0(n,e){if(typeof n!="function")throw new TypeError("Class must be constructor");if(Object.prototype.hasOwnProperty.call(n,"layout_"))throw new Error("Class is already bound to a layout");if(!(e&&e instanceof Be))throw new TypeError("layout must be a Layout");if(Object.prototype.hasOwnProperty.call(e,"boundConstructor_"))throw new Error("layout is already bound to a constructor");n.layout_=e,e.boundConstructor_=n,e.makeDestinationObject=()=>new n,Object.defineProperty(n.prototype,"encode",{value(t,r){return e.encode(this,t,r)},writable:!0}),Object.defineProperty(n,"decode",{value(t,r){return e.decode(t,r)},writable:!0})}W.bindConstructorLayout=q0;let Ht=class extends Be{isCount(){throw new Error("ExternalLayout is abstract")}};W.ExternalLayout=Ht;let _l=class extends Ht{constructor(e=1,t){if(!Number.isInteger(e)||0>=e)throw new TypeError("elementSpan must be a (positive) integer");super(-1,t),this.elementSpan=e}isCount(){return!0}decode(e,t=0){Yn(e);const r=e.length-t;return Math.floor(r/this.elementSpan)}encode(e,t,r){return 0}};W.GreedyCount=_l;let Ra=class extends Ht{constructor(e,t=0,r){if(!(e instanceof Be))throw new TypeError("layout must be a Layout");if(!Number.isInteger(t))throw new TypeError("offset must be integer or undefined");super(e.span,r||e.property),this.layout=e,this.offset=t}isCount(){return this.layout instanceof tr||this.layout instanceof cr}decode(e,t=0){return this.layout.decode(e,t+this.offset)}encode(e,t,r=0){return this.layout.encode(e,t,r+this.offset)}};W.OffsetLayout=Ra;let tr=class extends Be{constructor(e,t){if(super(e,t),6<this.span)throw new RangeError("span must not exceed 6 bytes")}decode(e,t=0){return xe(e).readUIntLE(t,this.span)}encode(e,t,r=0){return xe(t).writeUIntLE(e,r,this.span),this.span}};W.UInt=tr;let cr=class extends Be{constructor(e,t){if(super(e,t),6<this.span)throw new RangeError("span must not exceed 6 bytes")}decode(e,t=0){return xe(e).readUIntBE(t,this.span)}encode(e,t,r=0){return xe(t).writeUIntBE(e,r,this.span),this.span}};W.UIntBE=cr;let wn=class extends Be{constructor(e,t){if(super(e,t),6<this.span)throw new RangeError("span must not exceed 6 bytes")}decode(e,t=0){return xe(e).readIntLE(t,this.span)}encode(e,t,r=0){return xe(t).writeIntLE(e,r,this.span),this.span}};W.Int=wn;let Xn=class extends Be{constructor(e,t){if(super(e,t),6<this.span)throw new RangeError("span must not exceed 6 bytes")}decode(e,t=0){return xe(e).readIntBE(t,this.span)}encode(e,t,r=0){return xe(t).writeIntBE(e,r,this.span),this.span}};W.IntBE=Xn;const Go=Math.pow(2,32);function vs(n){const e=Math.floor(n/Go),t=n-e*Go;return{hi32:e,lo32:t}}function Ss(n,e){return n*Go+e}let bl=class extends Be{constructor(e){super(8,e)}decode(e,t=0){const r=xe(e),i=r.readUInt32LE(t),s=r.readUInt32LE(t+4);return Ss(s,i)}encode(e,t,r=0){const i=vs(e),s=xe(t);return s.writeUInt32LE(i.lo32,r),s.writeUInt32LE(i.hi32,r+4),8}};W.NearUInt64=bl;let El=class extends Be{constructor(e){super(8,e)}decode(e,t=0){const r=xe(e),i=r.readUInt32BE(t),s=r.readUInt32BE(t+4);return Ss(i,s)}encode(e,t,r=0){const i=vs(e),s=xe(t);return s.writeUInt32BE(i.hi32,r),s.writeUInt32BE(i.lo32,r+4),8}};W.NearUInt64BE=El;let Rl=class extends Be{constructor(e){super(8,e)}decode(e,t=0){const r=xe(e),i=r.readUInt32LE(t),s=r.readInt32LE(t+4);return Ss(s,i)}encode(e,t,r=0){const i=vs(e),s=xe(t);return s.writeUInt32LE(i.lo32,r),s.writeInt32LE(i.hi32,r+4),8}};W.NearInt64=Rl;let Al=class extends Be{constructor(e){super(8,e)}decode(e,t=0){const r=xe(e),i=r.readInt32BE(t),s=r.readUInt32BE(t+4);return Ss(i,s)}encode(e,t,r=0){const i=vs(e),s=xe(t);return s.writeInt32BE(i.hi32,r),s.writeUInt32BE(i.lo32,r+4),8}};W.NearInt64BE=Al;let vl=class extends Be{constructor(e){super(4,e)}decode(e,t=0){return xe(e).readFloatLE(t)}encode(e,t,r=0){return xe(t).writeFloatLE(e,r),4}};W.Float=vl;let Sl=class extends Be{constructor(e){super(4,e)}decode(e,t=0){return xe(e).readFloatBE(t)}encode(e,t,r=0){return xe(t).writeFloatBE(e,r),4}};W.FloatBE=Sl;let Il=class extends Be{constructor(e){super(8,e)}decode(e,t=0){return xe(e).readDoubleLE(t)}encode(e,t,r=0){return xe(t).writeDoubleLE(e,r),8}};W.Double=Il;let kl=class extends Be{constructor(e){super(8,e)}decode(e,t=0){return xe(e).readDoubleBE(t)}encode(e,t,r=0){return xe(t).writeDoubleBE(e,r),8}};W.DoubleBE=kl;let Tl=class extends Be{constructor(e,t,r){if(!(e instanceof Be))throw new TypeError("elementLayout must be a Layout");if(!(t instanceof Ht&&t.isCount()||Number.isInteger(t)&&0<=t))throw new TypeError("count must be non-negative integer or an unsigned integer ExternalLayout");let i=-1;!(t instanceof Ht)&&0<e.span&&(i=t*e.span),super(i,r),this.elementLayout=e,this.count=t}getSpan(e,t=0){if(0<=this.span)return this.span;let r=0,i=this.count;if(i instanceof Ht&&(i=i.decode(e,t)),0<this.elementLayout.span)r=i*this.elementLayout.span;else{let s=0;for(;s<i;)r+=this.elementLayout.getSpan(e,t+r),++s}return r}decode(e,t=0){const r=[];let i=0,s=this.count;for(s instanceof Ht&&(s=s.decode(e,t));i<s;)r.push(this.elementLayout.decode(e,t)),t+=this.elementLayout.getSpan(e,t),i+=1;return r}encode(e,t,r=0){const i=this.elementLayout,s=e.reduce((o,a)=>o+i.encode(a,t,r+o),0);return this.count instanceof Ht&&this.count.encode(e.length,t,r),s}};W.Sequence=Tl;let xl=class extends Be{constructor(e,t,r){if(!(Array.isArray(e)&&e.reduce((s,o)=>s&&o instanceof Be,!0)))throw new TypeError("fields must be array of Layout instances");typeof t=="boolean"&&r===void 0&&(r=t,t=void 0);for(const s of e)if(0>s.span&&s.property===void 0)throw new Error("fields cannot contain unnamed variable-length layout");let i=-1;try{i=e.reduce((s,o)=>s+o.getSpan(),0)}catch{}super(i,t),this.fields=e,this.decodePrefixes=!!r}getSpan(e,t=0){if(0<=this.span)return this.span;let r=0;try{r=this.fields.reduce((i,s)=>{const o=s.getSpan(e,t);return t+=o,i+o},0)}catch{throw new RangeError("indeterminate span")}return r}decode(e,t=0){Yn(e);const r=this.makeDestinationObject();for(const i of this.fields)if(i.property!==void 0&&(r[i.property]=i.decode(e,t)),t+=i.getSpan(e,t),this.decodePrefixes&&e.length===t)break;return r}encode(e,t,r=0){const i=r;let s=0,o=0;for(const a of this.fields){let u=a.span;if(o=0<u?u:0,a.property!==void 0){const l=e[a.property];l!==void 0&&(o=a.encode(l,t,r),0>u&&(u=a.getSpan(t,r)))}s=r,r+=u}return s+o-i}fromArray(e){const t=this.makeDestinationObject();for(const r of this.fields)r.property!==void 0&&0<e.length&&(t[r.property]=e.shift());return t}layoutFor(e){if(typeof e!="string")throw new TypeError("property must be string");for(const t of this.fields)if(t.property===e)return t}offsetOf(e){if(typeof e!="string")throw new TypeError("property must be string");let t=0;for(const r of this.fields){if(r.property===e)return t;0>r.span?t=-1:0<=t&&(t+=r.span)}}};W.Structure=xl;let Aa=class{constructor(e){this.property=e}decode(e,t){throw new Error("UnionDiscriminator is abstract")}encode(e,t,r){throw new Error("UnionDiscriminator is abstract")}};W.UnionDiscriminator=Aa;let as=class extends Aa{constructor(e,t){if(!(e instanceof Ht&&e.isCount()))throw new TypeError("layout must be an unsigned integer ExternalLayout");super(t||e.property||"variant"),this.layout=e}decode(e,t){return this.layout.decode(e,t)}encode(e,t,r){return this.layout.encode(e,t,r)}};W.UnionLayoutDiscriminator=as;let va=class extends Be{constructor(e,t,r){let i;if(e instanceof tr||e instanceof cr)i=new as(new Ra(e));else if(e instanceof Ht&&e.isCount())i=new as(e);else if(e instanceof Aa)i=e;else throw new TypeError("discr must be a UnionDiscriminator or an unsigned integer layout");if(t===void 0&&(t=null),!(t===null||t instanceof Be))throw new TypeError("defaultLayout must be null or a Layout");if(t!==null){if(0>t.span)throw new Error("defaultLayout must have constant span");t.property===void 0&&(t=t.replicate("content"))}let s=-1;t&&(s=t.span,0<=s&&(e instanceof tr||e instanceof cr)&&(s+=i.layout.span)),super(s,r),this.discriminator=i,this.usesPrefixDiscriminator=e instanceof tr||e instanceof cr,this.defaultLayout=t,this.registry={};let o=this.defaultGetSourceVariant.bind(this);this.getSourceVariant=function(a){return o(a)},this.configGetSourceVariant=function(a){o=a.bind(this)}}getSpan(e,t=0){if(0<=this.span)return this.span;const r=this.getVariant(e,t);if(!r)throw new Error("unable to determine span for unrecognized variant");return r.getSpan(e,t)}defaultGetSourceVariant(e){if(Object.prototype.hasOwnProperty.call(e,this.discriminator.property)){if(this.defaultLayout&&this.defaultLayout.property&&Object.prototype.hasOwnProperty.call(e,this.defaultLayout.property))return;const t=this.registry[e[this.discriminator.property]];if(t&&(!t.layout||t.property&&Object.prototype.hasOwnProperty.call(e,t.property)))return t}else for(const t in this.registry){const r=this.registry[t];if(r.property&&Object.prototype.hasOwnProperty.call(e,r.property))return r}throw new Error("unable to infer src variant")}decode(e,t=0){let r;const i=this.discriminator,s=i.decode(e,t),o=this.registry[s];if(o===void 0){const a=this.defaultLayout;let u=0;this.usesPrefixDiscriminator&&(u=i.layout.span),r=this.makeDestinationObject(),r[i.property]=s,r[a.property]=a.decode(e,t+u)}else r=o.decode(e,t);return r}encode(e,t,r=0){const i=this.getSourceVariant(e);if(i===void 0){const s=this.discriminator,o=this.defaultLayout;let a=0;return this.usesPrefixDiscriminator&&(a=s.layout.span),s.encode(e[s.property],t,r),a+o.encode(e[o.property],t,r+a)}return i.encode(e,t,r)}addVariant(e,t,r){const i=new Ol(this,e,t,r);return this.registry[e]=i,i}getVariant(e,t=0){let r;return e instanceof Uint8Array?r=this.discriminator.decode(e,t):r=e,this.registry[r]}};W.Union=va;let Ol=class extends Be{constructor(e,t,r,i){if(!(e instanceof va))throw new TypeError("union must be a Union");if(!Number.isInteger(t)||0>t)throw new TypeError("variant must be a (non-negative) integer");if(typeof r=="string"&&i===void 0&&(i=r,r=null),r){if(!(r instanceof Be))throw new TypeError("layout must be a Layout");if(e.defaultLayout!==null&&0<=r.span&&r.span>e.defaultLayout.span)throw new Error("variant span exceeds span of containing union");if(typeof i!="string")throw new TypeError("variant must have a String property")}let s=e.span;0>e.span&&(s=r?r.span:0,0<=s&&e.usesPrefixDiscriminator&&(s+=e.discriminator.layout.span)),super(s,i),this.union=e,this.variant=t,this.layout=r||null}getSpan(e,t=0){if(0<=this.span)return this.span;let r=0;this.union.usesPrefixDiscriminator&&(r=this.union.discriminator.layout.span);let i=0;return this.layout&&(i=this.layout.getSpan(e,t+r)),r+i}decode(e,t=0){const r=this.makeDestinationObject();if(this!==this.union.getVariant(e,t))throw new Error("variant mismatch");let i=0;return this.union.usesPrefixDiscriminator&&(i=this.union.discriminator.layout.span),this.layout?r[this.property]=this.layout.decode(e,t+i):this.property?r[this.property]=!0:this.union.usesPrefixDiscriminator&&(r[this.union.discriminator.property]=this.variant),r}encode(e,t,r=0){let i=0;if(this.union.usesPrefixDiscriminator&&(i=this.union.discriminator.layout.span),this.layout&&!Object.prototype.hasOwnProperty.call(e,this.property))throw new TypeError("variant lacks property "+this.property);this.union.discriminator.encode(this.variant,t,r);let s=i;if(this.layout&&(this.layout.encode(e[this.property],t,r+i),s+=this.layout.getSpan(t,r+i),0<=this.union.span&&s>this.union.span))throw new Error("encoded variant overruns containing union");return s}fromArray(e){if(this.layout)return this.layout.fromArray(e)}};W.VariantLayout=Ol;function On(n){return 0>n&&(n+=4294967296),n}let Sa=class extends Be{constructor(e,t,r){if(!(e instanceof tr||e instanceof cr))throw new TypeError("word must be a UInt or UIntBE layout");if(typeof t=="string"&&r===void 0&&(r=t,t=!1),4<e.span)throw new RangeError("word cannot exceed 32 bits");super(e.span,r),this.word=e,this.msb=!!t,this.fields=[];let i=0;this._packedSetValue=function(s){return i=On(s),this},this._packedGetValue=function(){return i}}decode(e,t=0){const r=this.makeDestinationObject(),i=this.word.decode(e,t);this._packedSetValue(i);for(const s of this.fields)s.property!==void 0&&(r[s.property]=s.decode(e));return r}encode(e,t,r=0){const i=this.word.decode(t,r);this._packedSetValue(i);for(const s of this.fields)if(s.property!==void 0){const o=e[s.property];o!==void 0&&s.encode(o)}return this.word.encode(this._packedGetValue(),t,r)}addField(e,t){const r=new Ia(this,e,t);return this.fields.push(r),r}addBoolean(e){const t=new Nl(this,e);return this.fields.push(t),t}fieldFor(e){if(typeof e!="string")throw new TypeError("property must be string");for(const t of this.fields)if(t.property===e)return t}};W.BitStructure=Sa;let Ia=class{constructor(e,t,r){if(!(e instanceof Sa))throw new TypeError("container must be a BitStructure");if(!Number.isInteger(t)||0>=t)throw new TypeError("bits must be positive integer");const i=8*e.span,s=e.fields.reduce((o,a)=>o+a.bits,0);if(t+s>i)throw new Error("bits too long for span remainder ("+(i-s)+" of "+i+" remain)");this.container=e,this.bits=t,this.valueMask=(1<<t)-1,t===32&&(this.valueMask=4294967295),this.start=s,this.container.msb&&(this.start=i-s-t),this.wordMask=On(this.valueMask<<this.start),this.property=r}decode(e,t){const r=this.container._packedGetValue();return On(r&this.wordMask)>>>this.start}encode(e){if(typeof e!="number"||!Number.isInteger(e)||e!==On(e&this.valueMask))throw new TypeError(Ea("BitField.encode",this)+" value must be integer not exceeding "+this.valueMask);const t=this.container._packedGetValue(),r=On(e<<this.start);this.container._packedSetValue(On(t&~this.wordMask)|r)}};W.BitField=Ia;let Nl=class extends Ia{constructor(e,t){super(e,1,t)}decode(e,t){return!!super.decode(e,t)}encode(e){typeof e=="boolean"&&(e=+e),super.encode(e)}};W.Boolean=Nl;let Cl=class extends Be{constructor(e,t){if(!(e instanceof Ht&&e.isCount()||Number.isInteger(e)&&0<=e))throw new TypeError("length must be positive integer or an unsigned integer ExternalLayout");let r=-1;e instanceof Ht||(r=e),super(r,t),this.length=e}getSpan(e,t){let r=this.span;return 0>r&&(r=this.length.decode(e,t)),r}decode(e,t=0){let r=this.span;return 0>r&&(r=this.length.decode(e,t)),xe(e).slice(t,t+r)}encode(e,t,r){let i=this.length;if(this.length instanceof Ht&&(i=e.length),!(e instanceof Uint8Array&&i===e.length))throw new TypeError(Ea("Blob.encode",this)+" requires (length "+i+") Uint8Array as src");if(r+i>t.length)throw new RangeError("encoding overruns Uint8Array");const s=xe(e);return xe(t).write(s.toString("hex"),r,i,"hex"),this.length instanceof Ht&&this.length.encode(i,t,r),i}};W.Blob=Cl;let Bl=class extends Be{constructor(e){super(-1,e)}getSpan(e,t=0){Yn(e);let r=t;for(;r<e.length&&e[r]!==0;)r+=1;return 1+r-t}decode(e,t=0){const r=this.getSpan(e,t);return xe(e).slice(t,t+r-1).toString("utf-8")}encode(e,t,r=0){typeof e!="string"&&(e=String(e));const i=ba.Buffer.from(e,"utf8"),s=i.length;if(r+s>t.length)throw new RangeError("encoding overruns Buffer");const o=xe(t);return i.copy(o,r),o[r+s]=0,s+1}};W.CString=Bl;let Ml=class extends Be{constructor(e,t){if(typeof e=="string"&&t===void 0&&(t=e,e=void 0),e===void 0)e=-1;else if(!Number.isInteger(e))throw new TypeError("maxSpan must be an integer");super(-1,t),this.maxSpan=e}getSpan(e,t=0){return Yn(e),e.length-t}decode(e,t=0){const r=this.getSpan(e,t);if(0<=this.maxSpan&&this.maxSpan<r)throw new RangeError("text length exceeds maxSpan");return xe(e).slice(t,t+r).toString("utf-8")}encode(e,t,r=0){typeof e!="string"&&(e=String(e));const i=ba.Buffer.from(e,"utf8"),s=i.length;if(0<=this.maxSpan&&this.maxSpan<s)throw new RangeError("text length exceeds maxSpan");if(r+s>t.length)throw new RangeError("encoding overruns Buffer");return i.copy(xe(t),r),s}};W.UTF8=Ml;let Ll=class extends Be{constructor(e,t){super(0,t),this.value=e}decode(e,t){return this.value}encode(e,t,r){return 0}};W.Constant=Ll;W.greedy=(n,e)=>new _l(n,e);var Xr=W.offset=(n,e,t)=>new Ra(n,e,t),ve=W.u8=n=>new tr(1,n),er=W.u16=n=>new tr(2,n);W.u24=n=>new tr(3,n);var ce=W.u32=n=>new tr(4,n);W.u40=n=>new tr(5,n);W.u48=n=>new tr(6,n);var St=W.nu64=n=>new bl(n);W.u16be=n=>new cr(2,n);W.u24be=n=>new cr(3,n);W.u32be=n=>new cr(4,n);W.u40be=n=>new cr(5,n);W.u48be=n=>new cr(6,n);W.nu64be=n=>new El(n);W.s8=n=>new wn(1,n);W.s16=n=>new wn(2,n);W.s24=n=>new wn(3,n);W.s32=n=>new wn(4,n);W.s40=n=>new wn(5,n);W.s48=n=>new wn(6,n);var Vt=W.ns64=n=>new Rl(n);W.s16be=n=>new Xn(2,n);W.s24be=n=>new Xn(3,n);W.s32be=n=>new Xn(4,n);W.s40be=n=>new Xn(5,n);W.s48be=n=>new Xn(6,n);W.ns64be=n=>new Al(n);W.f32=n=>new vl(n);W.f32be=n=>new Sl(n);W.f64=n=>new Il(n);W.f64be=n=>new kl(n);var ue=W.struct=(n,e,t)=>new xl(n,e,t);W.bits=(n,e,t)=>new Sa(n,e,t);var kt=W.seq=(n,e,t)=>new Tl(n,e,t);W.union=(n,e,t)=>new va(n,e,t);W.unionLayoutDiscriminator=(n,e)=>new as(n,e);var Le=W.blob=(n,e)=>new Cl(n,e);W.cstr=n=>new Bl(n);W.utf8=(n,e)=>new Ml(n,e);W.constant=(n,e)=>new Ll(n,e);var V0=8078e3,j0=8078001,Z0=8078004,Y0=8078005,X0=8078006,J0=8078011;function Pl(n){return Array.isArray(n)?"%5B"+n.map(Pl).join("%2C%20")+"%5D":typeof n=="bigint"?`${n}n`:encodeURIComponent(String(n!=null&&Object.getPrototypeOf(n)===null?{...n}:n))}function Q0([n,e]){return`${n}=${Pl(e)}`}function ey(n){const e=Object.entries(n).map(Q0).join("&");return btoa(e)}function ty(n,e={}){{let t=`Solana error #${n}; Decode this error by running \`npx @solana/errors decode -- ${n}`;return Object.keys(e).length&&(t+=` '${ey(e)}'`),`${t}\``}}var Ln=class extends Error{constructor(...[e,t]){let r,i;if(t){const{cause:o,...a}=t;o&&(i={cause:o}),Object.keys(a).length>0&&(r=a)}const s=ty(e,r);super(s,i);me(this,"cause",this.cause);me(this,"context");this.context={__code:e,...r},this.name="SolanaError"}};function ry(n,e){return"fixedSize"in e?e.fixedSize:e.getSizeFromValue(n)}function ny(n){return Object.freeze({...n,encode:e=>{const t=new Uint8Array(ry(e,n));return n.write(e,t,0),t}})}function iy(n){return Object.freeze({...n,decode:(e,t=0)=>n.read(e,t)[0]})}function Tn(n){return"fixedSize"in n&&typeof n.fixedSize=="number"}function sy(n,e){if(Tn(n)!==Tn(e))throw new Ln(Z0);if(Tn(n)&&Tn(e)&&n.fixedSize!==e.fixedSize)throw new Ln(Y0,{decoderFixedSize:e.fixedSize,encoderFixedSize:n.fixedSize});if(!Tn(n)&&!Tn(e)&&n.maxSize!==e.maxSize)throw new Ln(X0,{decoderMaxSize:e.maxSize,encoderMaxSize:n.maxSize});return{...e,...n,decode:e.decode,encode:n.encode,read:e.read,write:n.write}}function oy(n,e,t=0){if(e.length-t<=0)throw new Ln(V0,{codecDescription:n})}function ay(n,e,t,r=0){const i=t.length-r;if(i<e)throw new Ln(j0,{bytesLength:i,codecDescription:n,expected:e})}function cy(n,e,t,r){if(r<e||r>t)throw new Ln(J0,{codecDescription:n,max:t,min:e,value:r})}function Ul(n){return(n==null?void 0:n.endian)!==1}function uy(n){return ny({fixedSize:n.size,write(e,t,r){n.range&&cy(n.name,n.range[0],n.range[1],e);const i=new ArrayBuffer(n.size);return n.set(new DataView(i),e,Ul(n.config)),t.set(new Uint8Array(i),r),r+n.size}})}function ly(n){return iy({fixedSize:n.size,read(e,t=0){oy(n.name,e,t),ay(n.name,n.size,e,t);const r=new DataView(hy(e,t,n.size));return[n.get(r,Ul(n.config)),t+n.size]}})}function hy(n,e,t){const r=n.byteOffset+(e??0),i=t??n.byteLength;return n.buffer.slice(r,r+i)}var Dl=(n={})=>uy({config:n,name:"u64",range:[0n,BigInt("0xffffffffffffffff")],set:(e,t,r)=>e.setBigUint64(0,BigInt(t),r),size:8}),fy=(n={})=>ly({config:n,get:(e,t)=>e.getBigUint64(0,t),name:"u64",size:8}),dy=(n={})=>sy(Dl(n),fy(n));let py=class extends TypeError{constructor(e,t){let r;const{message:i,explanation:s,...o}=e,{path:a}=e,u=a.length===0?i:`At path: ${a.join(".")} -- ${i}`;super(s??u),s!=null&&(this.cause=u),Object.assign(this,o),this.name=this.constructor.name,this.failures=()=>r??(r=[e,...t()])}};function yy(n){return vi(n)&&typeof n[Symbol.iterator]=="function"}function vi(n){return typeof n=="object"&&n!=null}function cs(n){return vi(n)&&!Array.isArray(n)}function ur(n){return typeof n=="symbol"?n.toString():typeof n=="string"?JSON.stringify(n):`${n}`}function gy(n){const{done:e,value:t}=n.next();return e?void 0:t}function my(n,e,t,r){if(n===!0)return;n===!1?n={}:typeof n=="string"&&(n={message:n});const{path:i,branch:s}=e,{type:o}=t,{refinement:a,message:u=`Expected a value of type \`${o}\`${a?` with refinement \`${a}\``:""}, but received: \`${ur(r)}\``}=n;return{value:r,type:o,refinement:a,key:i[i.length-1],path:i,branch:s,...n,message:u}}function*Sc(n,e,t,r){yy(n)||(n=[n]);for(const i of n){const s=my(i,e,t,r);s&&(yield s)}}function*ka(n,e,t={}){const{path:r=[],branch:i=[n],coerce:s=!1,mask:o=!1}=t,a={path:r,branch:i,mask:o};s&&(n=e.coercer(n,a));let u="valid";for(const l of e.validator(n,a))l.explanation=t.message,u="not_valid",yield[l,void 0];for(let[l,f,_]of e.entries(n,a)){const I=ka(f,_,{path:l===void 0?r:[...r,l],branch:l===void 0?i:[...i,f],coerce:s,mask:o,message:t.message});for(const g of I)g[0]?(u=g[0].refinement!=null?"not_refined":"not_valid",yield[g[0],void 0]):s&&(f=g[1],l===void 0?n=f:n instanceof Map?n.set(l,f):n instanceof Set?n.add(f):vi(n)&&(f!==void 0||l in n)&&(n[l]=f))}if(u!=="not_valid")for(const l of e.refiner(n,a))l.explanation=t.message,u="not_refined",yield[l,void 0];u==="valid"&&(yield[void 0,n])}let vr=class{constructor(e){const{type:t,schema:r,validator:i,refiner:s,coercer:o=u=>u,entries:a=function*(){}}=e;this.type=t,this.schema=r,this.entries=a,this.coercer=o,i?this.validator=(u,l)=>{const f=i(u,l);return Sc(f,l,this,u)}:this.validator=()=>[],s?this.refiner=(u,l)=>{const f=s(u,l);return Sc(f,l,this,u)}:this.refiner=()=>[]}assert(e,t){return Fl(e,this,t)}create(e,t){return ee(e,this,t)}is(e){return Hl(e,this)}mask(e,t){return wy(e,this,t)}validate(e,t={}){return Si(e,this,t)}};function Fl(n,e,t){const r=Si(n,e,{message:t});if(r[0])throw r[0]}function ee(n,e,t){const r=Si(n,e,{coerce:!0,message:t});if(r[0])throw r[0];return r[1]}function wy(n,e,t){const r=Si(n,e,{coerce:!0,mask:!0,message:t});if(r[0])throw r[0];return r[1]}function Hl(n,e){return!Si(n,e)[0]}function Si(n,e,t={}){const r=ka(n,e,t),i=gy(r);return i[0]?[new py(i[0],function*(){for(const o of r)o[0]&&(yield o[0])}),void 0]:[void 0,i[1]]}function _n(n,e){return new vr({type:n,schema:null,validator:e})}function _y(){return _n("any",()=>!0)}function ie(n){return new vr({type:"array",schema:n,*entries(e){if(n&&Array.isArray(e))for(const[t,r]of e.entries())yield[t,r,n]},coercer(e){return Array.isArray(e)?e.slice():e},validator(e){return Array.isArray(e)||`Expected an array value, but received: ${ur(e)}`}})}function Er(){return _n("boolean",n=>typeof n=="boolean")}function Ta(n){return _n("instance",e=>e instanceof n||`Expected a \`${n.name}\` instance, but received: ${ur(e)}`)}function je(n){const e=ur(n),t=typeof n;return new vr({type:"literal",schema:t==="string"||t==="number"||t==="boolean"?n:null,validator(r){return r===n||`Expected the literal \`${e}\`, but received: ${ur(r)}`}})}function by(){return _n("never",()=>!1)}function se(n){return new vr({...n,validator:(e,t)=>e===null||n.validator(e,t),refiner:(e,t)=>e===null||n.refiner(e,t)})}function H(){return _n("number",n=>typeof n=="number"&&!isNaN(n)||`Expected a number, but received: ${ur(n)}`)}function fe(n){return new vr({...n,validator:(e,t)=>e===void 0||n.validator(e,t),refiner:(e,t)=>e===void 0||n.refiner(e,t)})}function zl(n,e){return new vr({type:"record",schema:null,*entries(t){if(vi(t))for(const r in t){const i=t[r];yield[r,r,n],yield[r,i,e]}},validator(t){return cs(t)||`Expected an object, but received: ${ur(t)}`},coercer(t){return cs(t)?{...t}:t}})}function Q(){return _n("string",n=>typeof n=="string"||`Expected a string, but received: ${ur(n)}`)}function xa(n){const e=by();return new vr({type:"tuple",schema:null,*entries(t){if(Array.isArray(t)){const r=Math.max(n.length,t.length);for(let i=0;i<r;i++)yield[i,t[i],n[i]||e]}},validator(t){return Array.isArray(t)||`Expected an array, but received: ${ur(t)}`},coercer(t){return Array.isArray(t)?t.slice():t}})}function J(n){const e=Object.keys(n);return new vr({type:"type",schema:n,*entries(t){if(vi(t))for(const r of e)yield[r,t[r],n[r]]},validator(t){return cs(t)||`Expected an object, but received: ${ur(t)}`},coercer(t){return cs(t)?{...t}:t}})}function Ut(n){const e=n.map(t=>t.type).join(" | ");return new vr({type:"union",schema:null,coercer(t,r){for(const i of n){const[s,o]=i.validate(t,{coerce:!0,mask:r.mask});if(!s)return o}return t},validator(t,r){const i=[];for(const s of n){const[...o]=ka(t,s,r),[a]=o;if(a[0])for(const[u]of o)u&&i.push(u);else return[]}return[`Expected the value to satisfy a union of \`${e}\`, but received: ${ur(t)}`,...i]}})}function Jn(){return _n("unknown",()=>!0)}function Ii(n,e,t){return new vr({...n,coercer:(r,i)=>Hl(r,e)?n.coercer(t(r,i),i):n.coercer(r,i)})}var Hi,Ey=new Uint8Array(16);function $l(){if(!Hi&&(Hi=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto),!Hi))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Hi(Ey)}const Ry=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function Is(n){return typeof n=="string"&&Ry.test(n)}var vt=[];for(var _o=0;_o<256;++_o)vt.push((_o+256).toString(16).substr(1));function ks(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,t=(vt[n[e+0]]+vt[n[e+1]]+vt[n[e+2]]+vt[n[e+3]]+"-"+vt[n[e+4]]+vt[n[e+5]]+"-"+vt[n[e+6]]+vt[n[e+7]]+"-"+vt[n[e+8]]+vt[n[e+9]]+"-"+vt[n[e+10]]+vt[n[e+11]]+vt[n[e+12]]+vt[n[e+13]]+vt[n[e+14]]+vt[n[e+15]]).toLowerCase();if(!Is(t))throw TypeError("Stringified UUID is invalid");return t}var Ic,bo,Eo=0,Ro=0;function Ay(n,e,t){var r=e&&t||0,i=e||new Array(16);n=n||{};var s=n.node||Ic,o=n.clockseq!==void 0?n.clockseq:bo;if(s==null||o==null){var a=n.random||(n.rng||$l)();s==null&&(s=Ic=[a[0]|1,a[1],a[2],a[3],a[4],a[5]]),o==null&&(o=bo=(a[6]<<8|a[7])&16383)}var u=n.msecs!==void 0?n.msecs:Date.now(),l=n.nsecs!==void 0?n.nsecs:Ro+1,f=u-Eo+(l-Ro)/1e4;if(f<0&&n.clockseq===void 0&&(o=o+1&16383),(f<0||u>Eo)&&n.nsecs===void 0&&(l=0),l>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");Eo=u,Ro=l,bo=o,u+=122192928e5;var _=((u&268435455)*1e4+l)%4294967296;i[r++]=_>>>24&255,i[r++]=_>>>16&255,i[r++]=_>>>8&255,i[r++]=_&255;var I=u/4294967296*1e4&268435455;i[r++]=I>>>8&255,i[r++]=I&255,i[r++]=I>>>24&15|16,i[r++]=I>>>16&255,i[r++]=o>>>8|128,i[r++]=o&255;for(var g=0;g<6;++g)i[r+g]=s[g];return e||ks(i)}function Kl(n){if(!Is(n))throw TypeError("Invalid UUID");var e,t=new Uint8Array(16);return t[0]=(e=parseInt(n.slice(0,8),16))>>>24,t[1]=e>>>16&255,t[2]=e>>>8&255,t[3]=e&255,t[4]=(e=parseInt(n.slice(9,13),16))>>>8,t[5]=e&255,t[6]=(e=parseInt(n.slice(14,18),16))>>>8,t[7]=e&255,t[8]=(e=parseInt(n.slice(19,23),16))>>>8,t[9]=e&255,t[10]=(e=parseInt(n.slice(24,36),16))/1099511627776&255,t[11]=e/4294967296&255,t[12]=e>>>24&255,t[13]=e>>>16&255,t[14]=e>>>8&255,t[15]=e&255,t}function vy(n){n=unescape(encodeURIComponent(n));for(var e=[],t=0;t<n.length;++t)e.push(n.charCodeAt(t));return e}var Sy="6ba7b810-9dad-11d1-80b4-00c04fd430c8",Iy="6ba7b811-9dad-11d1-80b4-00c04fd430c8";function Wl(n,e,t){function r(i,s,o,a){if(typeof i=="string"&&(i=vy(i)),typeof s=="string"&&(s=Kl(s)),s.length!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");var u=new Uint8Array(16+i.length);if(u.set(s),u.set(i,s.length),u=t(u),u[6]=u[6]&15|e,u[8]=u[8]&63|128,o){a=a||0;for(var l=0;l<16;++l)o[a+l]=u[l];return o}return ks(u)}try{r.name=n}catch{}return r.DNS=Sy,r.URL=Iy,r}function ky(n){if(typeof n=="string"){var e=unescape(encodeURIComponent(n));n=new Uint8Array(e.length);for(var t=0;t<e.length;++t)n[t]=e.charCodeAt(t)}return Ty(xy(Oy(n),n.length*8))}function Ty(n){for(var e=[],t=n.length*32,r="0123456789abcdef",i=0;i<t;i+=8){var s=n[i>>5]>>>i%32&255,o=parseInt(r.charAt(s>>>4&15)+r.charAt(s&15),16);e.push(o)}return e}function Gl(n){return(n+64>>>9<<4)+14+1}function xy(n,e){n[e>>5]|=128<<e%32,n[Gl(e)-1]=e;for(var t=1732584193,r=-271733879,i=-1732584194,s=271733878,o=0;o<n.length;o+=16){var a=t,u=r,l=i,f=s;t=Ot(t,r,i,s,n[o],7,-680876936),s=Ot(s,t,r,i,n[o+1],12,-389564586),i=Ot(i,s,t,r,n[o+2],17,606105819),r=Ot(r,i,s,t,n[o+3],22,-1044525330),t=Ot(t,r,i,s,n[o+4],7,-176418897),s=Ot(s,t,r,i,n[o+5],12,1200080426),i=Ot(i,s,t,r,n[o+6],17,-1473231341),r=Ot(r,i,s,t,n[o+7],22,-45705983),t=Ot(t,r,i,s,n[o+8],7,1770035416),s=Ot(s,t,r,i,n[o+9],12,-1958414417),i=Ot(i,s,t,r,n[o+10],17,-42063),r=Ot(r,i,s,t,n[o+11],22,-1990404162),t=Ot(t,r,i,s,n[o+12],7,1804603682),s=Ot(s,t,r,i,n[o+13],12,-40341101),i=Ot(i,s,t,r,n[o+14],17,-1502002290),r=Ot(r,i,s,t,n[o+15],22,1236535329),t=Nt(t,r,i,s,n[o+1],5,-165796510),s=Nt(s,t,r,i,n[o+6],9,-1069501632),i=Nt(i,s,t,r,n[o+11],14,643717713),r=Nt(r,i,s,t,n[o],20,-373897302),t=Nt(t,r,i,s,n[o+5],5,-701558691),s=Nt(s,t,r,i,n[o+10],9,38016083),i=Nt(i,s,t,r,n[o+15],14,-660478335),r=Nt(r,i,s,t,n[o+4],20,-405537848),t=Nt(t,r,i,s,n[o+9],5,568446438),s=Nt(s,t,r,i,n[o+14],9,-1019803690),i=Nt(i,s,t,r,n[o+3],14,-187363961),r=Nt(r,i,s,t,n[o+8],20,1163531501),t=Nt(t,r,i,s,n[o+13],5,-1444681467),s=Nt(s,t,r,i,n[o+2],9,-51403784),i=Nt(i,s,t,r,n[o+7],14,1735328473),r=Nt(r,i,s,t,n[o+12],20,-1926607734),t=Ct(t,r,i,s,n[o+5],4,-378558),s=Ct(s,t,r,i,n[o+8],11,-2022574463),i=Ct(i,s,t,r,n[o+11],16,1839030562),r=Ct(r,i,s,t,n[o+14],23,-35309556),t=Ct(t,r,i,s,n[o+1],4,-1530992060),s=Ct(s,t,r,i,n[o+4],11,1272893353),i=Ct(i,s,t,r,n[o+7],16,-155497632),r=Ct(r,i,s,t,n[o+10],23,-1094730640),t=Ct(t,r,i,s,n[o+13],4,681279174),s=Ct(s,t,r,i,n[o],11,-358537222),i=Ct(i,s,t,r,n[o+3],16,-722521979),r=Ct(r,i,s,t,n[o+6],23,76029189),t=Ct(t,r,i,s,n[o+9],4,-640364487),s=Ct(s,t,r,i,n[o+12],11,-421815835),i=Ct(i,s,t,r,n[o+15],16,530742520),r=Ct(r,i,s,t,n[o+2],23,-995338651),t=Bt(t,r,i,s,n[o],6,-198630844),s=Bt(s,t,r,i,n[o+7],10,1126891415),i=Bt(i,s,t,r,n[o+14],15,-1416354905),r=Bt(r,i,s,t,n[o+5],21,-57434055),t=Bt(t,r,i,s,n[o+12],6,1700485571),s=Bt(s,t,r,i,n[o+3],10,-1894986606),i=Bt(i,s,t,r,n[o+10],15,-1051523),r=Bt(r,i,s,t,n[o+1],21,-2054922799),t=Bt(t,r,i,s,n[o+8],6,1873313359),s=Bt(s,t,r,i,n[o+15],10,-30611744),i=Bt(i,s,t,r,n[o+6],15,-1560198380),r=Bt(r,i,s,t,n[o+13],21,1309151649),t=Bt(t,r,i,s,n[o+4],6,-145523070),s=Bt(s,t,r,i,n[o+11],10,-1120210379),i=Bt(i,s,t,r,n[o+2],15,718787259),r=Bt(r,i,s,t,n[o+9],21,-343485551),t=Yr(t,a),r=Yr(r,u),i=Yr(i,l),s=Yr(s,f)}return[t,r,i,s]}function Oy(n){if(n.length===0)return[];for(var e=n.length*8,t=new Uint32Array(Gl(e)),r=0;r<e;r+=8)t[r>>5]|=(n[r/8]&255)<<r%32;return t}function Yr(n,e){var t=(n&65535)+(e&65535),r=(n>>16)+(e>>16)+(t>>16);return r<<16|t&65535}function Ny(n,e){return n<<e|n>>>32-e}function Ts(n,e,t,r,i,s){return Yr(Ny(Yr(Yr(e,n),Yr(r,s)),i),t)}function Ot(n,e,t,r,i,s,o){return Ts(e&t|~e&r,n,e,i,s,o)}function Nt(n,e,t,r,i,s,o){return Ts(e&r|t&~r,n,e,i,s,o)}function Ct(n,e,t,r,i,s,o){return Ts(e^t^r,n,e,i,s,o)}function Bt(n,e,t,r,i,s,o){return Ts(t^(e|~r),n,e,i,s,o)}var Cy=Wl("v3",48,ky);function By(n,e,t){n=n||{};var r=n.random||(n.rng||$l)();if(r[6]=r[6]&15|64,r[8]=r[8]&63|128,e){t=t||0;for(var i=0;i<16;++i)e[t+i]=r[i];return e}return ks(r)}function My(n,e,t,r){switch(n){case 0:return e&t^~e&r;case 1:return e^t^r;case 2:return e&t^e&r^t&r;case 3:return e^t^r}}function Ao(n,e){return n<<e|n>>>32-e}function Ly(n){var e=[1518500249,1859775393,2400959708,3395469782],t=[1732584193,4023233417,2562383102,271733878,3285377520];if(typeof n=="string"){var r=unescape(encodeURIComponent(n));n=[];for(var i=0;i<r.length;++i)n.push(r.charCodeAt(i))}else Array.isArray(n)||(n=Array.prototype.slice.call(n));n.push(128);for(var s=n.length/4+2,o=Math.ceil(s/16),a=new Array(o),u=0;u<o;++u){for(var l=new Uint32Array(16),f=0;f<16;++f)l[f]=n[u*64+f*4]<<24|n[u*64+f*4+1]<<16|n[u*64+f*4+2]<<8|n[u*64+f*4+3];a[u]=l}a[o-1][14]=(n.length-1)*8/Math.pow(2,32),a[o-1][14]=Math.floor(a[o-1][14]),a[o-1][15]=(n.length-1)*8&4294967295;for(var _=0;_<o;++_){for(var I=new Uint32Array(80),g=0;g<16;++g)I[g]=a[_][g];for(var v=16;v<80;++v)I[v]=Ao(I[v-3]^I[v-8]^I[v-14]^I[v-16],1);for(var x=t[0],A=t[1],N=t[2],K=t[3],P=t[4],$=0;$<80;++$){var L=Math.floor($/20),X=Ao(x,5)+My(L,A,N,K)+P+e[L]+I[$]>>>0;P=K,K=N,N=Ao(A,30)>>>0,A=x,x=X}t[0]=t[0]+x>>>0,t[1]=t[1]+A>>>0,t[2]=t[2]+N>>>0,t[3]=t[3]+K>>>0,t[4]=t[4]+P>>>0}return[t[0]>>24&255,t[0]>>16&255,t[0]>>8&255,t[0]&255,t[1]>>24&255,t[1]>>16&255,t[1]>>8&255,t[1]&255,t[2]>>24&255,t[2]>>16&255,t[2]>>8&255,t[2]&255,t[3]>>24&255,t[3]>>16&255,t[3]>>8&255,t[3]&255,t[4]>>24&255,t[4]>>16&255,t[4]>>8&255,t[4]&255]}var Py=Wl("v5",80,Ly);const Uy="00000000-0000-0000-0000-000000000000";function Dy(n){if(!Is(n))throw TypeError("Invalid UUID");return parseInt(n.substr(14,1),16)}const Fy=Object.freeze(Object.defineProperty({__proto__:null,NIL:Uy,parse:Kl,stringify:ks,v1:Ay,v3:Cy,v4:By,v5:Py,validate:Is,version:Dy},Symbol.toStringTag,{value:"Module"})),ql=gs(Fy),Hy=ql.v4,zy=function(n,e,t,r){if(typeof n!="string")throw new TypeError(n+" must be a string");r=r||{};const i=typeof r.version=="number"?r.version:2;if(i!==1&&i!==2)throw new TypeError(i+" must be 1 or 2");const s={method:n};if(i===2&&(s.jsonrpc="2.0"),e){if(typeof e!="object"&&!Array.isArray(e))throw new TypeError(e+" must be an object, array or omitted");s.params=e}if(typeof t>"u"){const o=typeof r.generator=="function"?r.generator:function(){return Hy()};s.id=o(s,r)}else i===2&&t===null?r.notificationIdNull&&(s.id=null):s.id=t;return s};var $y=zy;const Ky=ql.v4,Wy=$y,mi=function(n,e){if(!(this instanceof mi))return new mi(n,e);e||(e={}),this.options={reviver:typeof e.reviver<"u"?e.reviver:null,replacer:typeof e.replacer<"u"?e.replacer:null,generator:typeof e.generator<"u"?e.generator:function(){return Ky()},version:typeof e.version<"u"?e.version:2,notificationIdNull:typeof e.notificationIdNull=="boolean"?e.notificationIdNull:!1},this.callServer=n};var Gy=mi;mi.prototype.request=function(n,e,t,r){const i=this;let s=null;const o=Array.isArray(n)&&typeof e=="function";if(this.options.version===1&&o)throw new TypeError("JSON-RPC 1.0 does not support batching");if(o||!o&&n&&typeof n=="object"&&typeof e=="function")r=e,s=n;else{typeof t=="function"&&(r=t,t=void 0);const l=typeof r=="function";try{s=Wy(n,e,t,{generator:this.options.generator,version:this.options.version,notificationIdNull:this.options.notificationIdNull})}catch(f){if(l)return r(f);throw f}if(!l)return s}let u;try{u=JSON.stringify(s,this.options.replacer)}catch(l){return r(l)}return this.callServer(u,function(l,f){i._parseResponse(l,f,r)}),s};mi.prototype._parseResponse=function(n,e,t){if(n){t(n);return}if(!e)return t();let r;try{r=JSON.parse(e,this.options.reviver)}catch(i){return t(i)}if(t.length===3)if(Array.isArray(r)){const i=function(o){return typeof o.error<"u"},s=function(o){return!i(o)};return t(null,r.filter(i),r.filter(s))}else return t(null,r.error,r.result);t(null,r)};const qy=Vn(Gy);var Vl={exports:{}};(function(n){var e=Object.prototype.hasOwnProperty,t="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(t=!1));function i(u,l,f){this.fn=u,this.context=l,this.once=f||!1}function s(u,l,f,_,I){if(typeof f!="function")throw new TypeError("The listener must be a function");var g=new i(f,_||u,I),v=t?t+l:l;return u._events[v]?u._events[v].fn?u._events[v]=[u._events[v],g]:u._events[v].push(g):(u._events[v]=g,u._eventsCount++),u}function o(u,l){--u._eventsCount===0?u._events=new r:delete u._events[l]}function a(){this._events=new r,this._eventsCount=0}a.prototype.eventNames=function(){var l=[],f,_;if(this._eventsCount===0)return l;for(_ in f=this._events)e.call(f,_)&&l.push(t?_.slice(1):_);return Object.getOwnPropertySymbols?l.concat(Object.getOwnPropertySymbols(f)):l},a.prototype.listeners=function(l){var f=t?t+l:l,_=this._events[f];if(!_)return[];if(_.fn)return[_.fn];for(var I=0,g=_.length,v=new Array(g);I<g;I++)v[I]=_[I].fn;return v},a.prototype.listenerCount=function(l){var f=t?t+l:l,_=this._events[f];return _?_.fn?1:_.length:0},a.prototype.emit=function(l,f,_,I,g,v){var x=t?t+l:l;if(!this._events[x])return!1;var A=this._events[x],N=arguments.length,K,P;if(A.fn){switch(A.once&&this.removeListener(l,A.fn,void 0,!0),N){case 1:return A.fn.call(A.context),!0;case 2:return A.fn.call(A.context,f),!0;case 3:return A.fn.call(A.context,f,_),!0;case 4:return A.fn.call(A.context,f,_,I),!0;case 5:return A.fn.call(A.context,f,_,I,g),!0;case 6:return A.fn.call(A.context,f,_,I,g,v),!0}for(P=1,K=new Array(N-1);P<N;P++)K[P-1]=arguments[P];A.fn.apply(A.context,K)}else{var $=A.length,L;for(P=0;P<$;P++)switch(A[P].once&&this.removeListener(l,A[P].fn,void 0,!0),N){case 1:A[P].fn.call(A[P].context);break;case 2:A[P].fn.call(A[P].context,f);break;case 3:A[P].fn.call(A[P].context,f,_);break;case 4:A[P].fn.call(A[P].context,f,_,I);break;default:if(!K)for(L=1,K=new Array(N-1);L<N;L++)K[L-1]=arguments[L];A[P].fn.apply(A[P].context,K)}}return!0},a.prototype.on=function(l,f,_){return s(this,l,f,_,!1)},a.prototype.once=function(l,f,_){return s(this,l,f,_,!0)},a.prototype.removeListener=function(l,f,_,I){var g=t?t+l:l;if(!this._events[g])return this;if(!f)return o(this,g),this;var v=this._events[g];if(v.fn)v.fn===f&&(!I||v.once)&&(!_||v.context===_)&&o(this,g);else{for(var x=0,A=[],N=v.length;x<N;x++)(v[x].fn!==f||I&&!v[x].once||_&&v[x].context!==_)&&A.push(v[x]);A.length?this._events[g]=A.length===1?A[0]:A:o(this,g)}return this},a.prototype.removeAllListeners=function(l){var f;return l?(f=t?t+l:l,this._events[f]&&o(this,f)):(this._events=new r,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=t,a.EventEmitter=a,n.exports=a})(Vl);var Vy=Vl.exports;const jl=Vn(Vy);var jy=class extends jl{constructor(e,t,r){super();me(this,"socket");this.socket=new window.WebSocket(e,r),this.socket.onopen=()=>this.emit("open"),this.socket.onmessage=i=>this.emit("message",i.data),this.socket.onerror=i=>this.emit("error",i),this.socket.onclose=i=>{this.emit("close",i.code,i.reason)}}send(e,t,r){const i=r||t;try{this.socket.send(e),i()}catch(s){i(s)}}close(e,t){this.socket.close(e,t)}addEventListener(e,t,r){this.socket.addEventListener(e,t,r)}};function Zy(n,e){return new jy(n,e)}var Yy=class{encode(n){return JSON.stringify(n)}decode(n){return JSON.parse(n)}},Xy=class extends jl{constructor(e,t="ws://localhost:8080",{autoconnect:r=!0,reconnect:i=!0,reconnect_interval:s=1e3,max_reconnects:o=5,...a}={},u,l){super();me(this,"address");me(this,"rpc_id");me(this,"queue");me(this,"options");me(this,"autoconnect");me(this,"ready");me(this,"reconnect");me(this,"reconnect_timer_id");me(this,"reconnect_interval");me(this,"max_reconnects");me(this,"rest_options");me(this,"current_reconnects");me(this,"generate_request_id");me(this,"socket");me(this,"webSocketFactory");me(this,"dataPack");this.webSocketFactory=e,this.queue={},this.rpc_id=0,this.address=t,this.autoconnect=r,this.ready=!1,this.reconnect=i,this.reconnect_timer_id=void 0,this.reconnect_interval=s,this.max_reconnects=o,this.rest_options=a,this.current_reconnects=0,this.generate_request_id=u||(()=>typeof this.rpc_id=="number"?++this.rpc_id:Number(this.rpc_id)+1),l?this.dataPack=l:this.dataPack=new Yy,this.autoconnect&&this._connect(this.address,{autoconnect:this.autoconnect,reconnect:this.reconnect,reconnect_interval:this.reconnect_interval,max_reconnects:this.max_reconnects,...this.rest_options})}connect(){this.socket||this._connect(this.address,{autoconnect:this.autoconnect,reconnect:this.reconnect,reconnect_interval:this.reconnect_interval,max_reconnects:this.max_reconnects,...this.rest_options})}call(e,t,r,i){return!i&&typeof r=="object"&&(i=r,r=null),new Promise((s,o)=>{if(!this.ready)return o(new Error("socket not ready"));const a=this.generate_request_id(e,t),u={jsonrpc:"2.0",method:e,params:t||void 0,id:a};this.socket.send(this.dataPack.encode(u),i,l=>{if(l)return o(l);this.queue[a]={promise:[s,o]},r&&(this.queue[a].timeout=setTimeout(()=>{delete this.queue[a],o(new Error("reply timeout"))},r))})})}async login(e){const t=await this.call("rpc.login",e);if(!t)throw new Error("authentication failed");return t}async listMethods(){return await this.call("__listMethods")}notify(e,t){return new Promise((r,i)=>{if(!this.ready)return i(new Error("socket not ready"));const s={jsonrpc:"2.0",method:e,params:t};this.socket.send(this.dataPack.encode(s),o=>{if(o)return i(o);r()})})}async subscribe(e){typeof e=="string"&&(e=[e]);const t=await this.call("rpc.on",e);if(typeof e=="string"&&t[e]!=="ok")throw new Error("Failed subscribing to an event '"+e+"' with: "+t[e]);return t}async unsubscribe(e){typeof e=="string"&&(e=[e]);const t=await this.call("rpc.off",e);if(typeof e=="string"&&t[e]!=="ok")throw new Error("Failed unsubscribing from an event with: "+t);return t}close(e,t){this.socket.close(e||1e3,t)}setAutoReconnect(e){this.reconnect=e}setReconnectInterval(e){this.reconnect_interval=e}setMaxReconnects(e){this.max_reconnects=e}_connect(e,t){clearTimeout(this.reconnect_timer_id),this.socket=this.webSocketFactory(e,t),this.socket.addEventListener("open",()=>{this.ready=!0,this.emit("open"),this.current_reconnects=0}),this.socket.addEventListener("message",({data:r})=>{r instanceof ArrayBuffer&&(r=te.Buffer.from(r).toString());try{r=this.dataPack.decode(r)}catch{return}if(r.notification&&this.listeners(r.notification).length){if(!Object.keys(r.params).length)return this.emit(r.notification);const i=[r.notification];if(r.params.constructor===Object)i.push(r.params);else for(let s=0;s<r.params.length;s++)i.push(r.params[s]);return Promise.resolve().then(()=>{this.emit.apply(this,i)})}if(!this.queue[r.id])return r.method?Promise.resolve().then(()=>{this.emit(r.method,r==null?void 0:r.params)}):void 0;"error"in r=="result"in r&&this.queue[r.id].promise[1](new Error('Server response malformed. Response must include either "result" or "error", but not both.')),this.queue[r.id].timeout&&clearTimeout(this.queue[r.id].timeout),r.error?this.queue[r.id].promise[1](r.error):this.queue[r.id].promise[0](r.result),delete this.queue[r.id]}),this.socket.addEventListener("error",r=>this.emit("error",r)),this.socket.addEventListener("close",({code:r,reason:i})=>{this.ready&&setTimeout(()=>this.emit("close",r,i),0),this.ready=!1,this.socket=void 0,r!==1e3&&(this.current_reconnects++,this.reconnect&&(this.max_reconnects>this.current_reconnects||this.max_reconnects===0)&&(this.reconnect_timer_id=setTimeout(()=>this._connect(e,t),this.reconnect_interval)))})}};const Jy=BigInt(0),ni=BigInt(1),Qy=BigInt(2),eg=BigInt(7),tg=BigInt(256),rg=BigInt(113),Zl=[],Yl=[],Xl=[];for(let n=0,e=ni,t=1,r=0;n<24;n++){[t,r]=[r,(2*t+3*r)%5],Zl.push(2*(5*r+t)),Yl.push((n+1)*(n+2)/2%64);let i=Jy;for(let s=0;s<7;s++)e=(e<<ni^(e>>eg)*rg)%tg,e&Qy&&(i^=ni<<(ni<<BigInt(s))-ni);Xl.push(i)}const Jl=Vu(Xl,!0),ng=Jl[0],ig=Jl[1],kc=(n,e,t)=>t>32?xp(n,e,t):kp(n,e,t),Tc=(n,e,t)=>t>32?Op(n,e,t):Tp(n,e,t);function sg(n,e=24){const t=new Uint32Array(10);for(let r=24-e;r<24;r++){for(let o=0;o<10;o++)t[o]=n[o]^n[o+10]^n[o+20]^n[o+30]^n[o+40];for(let o=0;o<10;o+=2){const a=(o+8)%10,u=(o+2)%10,l=t[u],f=t[u+1],_=kc(l,f,1)^t[a],I=Tc(l,f,1)^t[a+1];for(let g=0;g<50;g+=10)n[o+g]^=_,n[o+g+1]^=I}let i=n[2],s=n[3];for(let o=0;o<24;o++){const a=Yl[o],u=kc(i,s,a),l=Tc(i,s,a),f=Zl[o];i=n[f],s=n[f+1],n[f]=u,n[f+1]=l}for(let o=0;o<50;o+=10){for(let a=0;a<10;a++)t[a]=n[o+a];for(let a=0;a<10;a++)n[o+a]^=~t[(a+2)%10]&t[(a+4)%10]}n[0]^=ng[r],n[1]^=ig[r]}en(t)}class Oa extends fa{constructor(e,t,r,i=!1,s=24){if(super(),this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,this.enableXOF=!1,this.blockLen=e,this.suffix=t,this.outputLen=r,this.enableXOF=i,this.rounds=s,yi(r),!(0<e&&e<200))throw new Error("only keccak-f1600 function is supported");this.state=new Uint8Array(200),this.state32=mp(this.state)}clone(){return this._cloneInto()}keccak(){fc(this.state32),sg(this.state32,this.rounds),fc(this.state32),this.posOut=0,this.pos=0}update(e){Fn(this),e=ws(e),rr(e);const{blockLen:t,state:r}=this,i=e.length;for(let s=0;s<i;){const o=Math.min(t-this.pos,i-s);for(let a=0;a<o;a++)r[this.pos++]^=e[s++];this.pos===t&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:t,pos:r,blockLen:i}=this;e[r]^=t,t&128&&r===i-1&&this.keccak(),e[i-1]^=128,this.keccak()}writeInto(e){Fn(this,!1),rr(e),this.finish();const t=this.state,{blockLen:r}=this;for(let i=0,s=e.length;i<s;){this.posOut>=r&&this.keccak();const o=Math.min(r-this.posOut,s-i);e.set(t.subarray(this.posOut,this.posOut+o),i),this.posOut+=o,i+=o}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return yi(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(Ku(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,en(this.state)}_cloneInto(e){const{blockLen:t,suffix:r,outputLen:i,rounds:s,enableXOF:o}=this;return e||(e=new Oa(t,r,i,o,s)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=s,e.suffix=r,e.outputLen=i,e.enableXOF=o,e.destroyed=this.destroyed,e}}const og=(n,e,t)=>da(()=>new Oa(e,n,t)),xc=og(1,136,256/8);class Ql extends fa{constructor(e,t){super(),this.finished=!1,this.destroyed=!1,gp(e);const r=ws(t);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const i=this.blockLen,s=new Uint8Array(i);s.set(r.length>i?e.create().update(r).digest():r);for(let o=0;o<s.length;o++)s[o]^=54;this.iHash.update(s),this.oHash=e.create();for(let o=0;o<s.length;o++)s[o]^=106;this.oHash.update(s),en(s)}update(e){return Fn(this),this.iHash.update(e),this}digestInto(e){Fn(this),rr(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:t,iHash:r,finished:i,destroyed:s,blockLen:o,outputLen:a}=this;return e=e,e.finished=i,e.destroyed=s,e.blockLen=o,e.outputLen=a,e.oHash=t._cloneInto(e.oHash),e.iHash=r._cloneInto(e.iHash),e}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const eh=(n,e,t)=>new Ql(n,e).update(t).digest();eh.create=(n,e)=>new Ql(n,e);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function Oc(n){n.lowS!==void 0&&pn("lowS",n.lowS),n.prehash!==void 0&&pn("prehash",n.prehash)}class ag extends Error{constructor(e=""){super(e)}}const Cr={Err:ag,_tlv:{encode:(n,e)=>{const{Err:t}=Cr;if(n<0||n>256)throw new t("tlv.encode: wrong tag");if(e.length&1)throw new t("tlv.encode: unpadded data");const r=e.length/2,i=Di(r);if(i.length/2&128)throw new t("tlv.encode: long form length too big");const s=r>127?Di(i.length/2|128):"";return Di(n)+s+i+e},decode(n,e){const{Err:t}=Cr;let r=0;if(n<0||n>256)throw new t("tlv.encode: wrong tag");if(e.length<2||e[r++]!==n)throw new t("tlv.decode: wrong tlv");const i=e[r++],s=!!(i&128);let o=0;if(!s)o=i;else{const u=i&127;if(!u)throw new t("tlv.decode(long): indefinite length not supported");if(u>4)throw new t("tlv.decode(long): byte length is too big");const l=e.subarray(r,r+u);if(l.length!==u)throw new t("tlv.decode: length bytes not complete");if(l[0]===0)throw new t("tlv.decode(long): zero leftmost byte");for(const f of l)o=o<<8|f;if(r+=u,o<128)throw new t("tlv.decode(long): not minimal encoding")}const a=e.subarray(r,r+o);if(a.length!==o)throw new t("tlv.decode: wrong value length");return{v:a,l:e.subarray(r+o)}}},_int:{encode(n){const{Err:e}=Cr;if(n<ui)throw new e("integer: negative integers are not allowed");let t=Di(n);if(Number.parseInt(t[0],16)&8&&(t="00"+t),t.length&1)throw new e("unexpected DER parsing assertion: unpadded hex");return t},decode(n){const{Err:e}=Cr;if(n[0]&128)throw new e("invalid signature integer: negative");if(n[0]===0&&!(n[1]&128))throw new e("invalid signature integer: unnecessary leading zero");return _s(n)}},toSig(n){const{Err:e,_int:t,_tlv:r}=Cr,i=rt("signature",n),{v:s,l:o}=r.decode(48,i);if(o.length)throw new e("invalid signature: left bytes after parsing");const{v:a,l:u}=r.decode(2,s),{v:l,l:f}=r.decode(2,u);if(f.length)throw new e("invalid signature: left bytes after parsing");return{r:t.decode(a),s:t.decode(l)}},hexFromSig(n){const{_tlv:e,_int:t}=Cr,r=e.encode(2,t.encode(n.r)),i=e.encode(2,t.encode(n.s)),s=r+i;return e.encode(48,s)}},ui=BigInt(0),li=BigInt(1),cg=BigInt(2),zi=BigInt(3),ug=BigInt(4);function lg(n,e,t){function r(i){const s=n.sqr(i),o=n.mul(s,i);return n.add(n.add(o,n.mul(i,e)),t)}return r}function th(n,e,t){const{BYTES:r}=n;function i(s){let o;if(typeof s=="bigint")o=s;else{let a=rt("private key",s);if(e){if(!e.includes(a.length*2))throw new Error("invalid private key");const u=new Uint8Array(r);u.set(a,u.length-a.length),a=u}try{o=n.fromBytes(a)}catch{throw new Error(`invalid private key: expected ui8a of size ${r}, got ${typeof s}`)}}if(t&&(o=n.create(o)),!n.isValidNot0(o))throw new Error("invalid private key: out of range [1..N-1]");return o}return i}function hg(n,e={}){const{Fp:t,Fn:r}=ul("weierstrass",n,e),{h:i,n:s}=n;Ai(e,{},{allowInfinityPoint:"boolean",clearCofactor:"function",isTorsionFree:"function",fromBytes:"function",toBytes:"function",endo:"object",wrapPrivateKey:"boolean"});const{endo:o}=e;if(o&&(!t.is0(n.a)||typeof o.beta!="bigint"||typeof o.splitScalar!="function"))throw new Error('invalid endo: expected "beta": bigint and "splitScalar": function');function a(){if(!t.isOdd)throw new Error("compression is not supported: Field does not have .isOdd()")}function u(Y,U,G){const{x:M,y:D}=U.toAffine(),w=t.toBytes(M);if(pn("isCompressed",G),G){a();const c=!t.isOdd(D);return Dr(rh(c),w)}else return Dr(Uint8Array.of(4),w,t.toBytes(D))}function l(Y){rr(Y);const U=t.BYTES,G=U+1,M=2*U+1,D=Y.length,w=Y[0],c=Y.subarray(1);if(D===G&&(w===2||w===3)){const h=t.fromBytes(c);if(!t.isValid(h))throw new Error("bad point: is not on curve, wrong x");const m=I(h);let E;try{E=t.sqrt(m)}catch(C){const R=C instanceof Error?": "+C.message:"";throw new Error("bad point: is not on curve, sqrt error"+R)}a();const S=t.isOdd(E);return(w&1)===1!==S&&(E=t.neg(E)),{x:h,y:E}}else if(D===M&&w===4){const h=t.fromBytes(c.subarray(U*0,U*1)),m=t.fromBytes(c.subarray(U*1,U*2));if(!g(h,m))throw new Error("bad point: is not on curve");return{x:h,y:m}}else throw new Error(`bad point: got length ${D}, expected compressed=${G} or uncompressed=${M}`)}const f=e.toBytes||u,_=e.fromBytes||l,I=lg(t,n.a,n.b);function g(Y,U){const G=t.sqr(U),M=I(Y);return t.eql(G,M)}if(!g(n.Gx,n.Gy))throw new Error("bad curve params: generator point");const v=t.mul(t.pow(n.a,zi),ug),x=t.mul(t.sqr(n.b),BigInt(27));if(t.is0(t.add(v,x)))throw new Error("bad curve params: a or b");function A(Y,U,G=!1){if(!t.isValid(U)||G&&t.is0(U))throw new Error(`bad point coordinate ${Y}`);return U}function N(Y){if(!(Y instanceof L))throw new Error("ProjectivePoint expected")}const K=rs((Y,U)=>{const{px:G,py:M,pz:D}=Y;if(t.eql(D,t.ONE))return{x:G,y:M};const w=Y.is0();U==null&&(U=w?t.ONE:t.inv(D));const c=t.mul(G,U),h=t.mul(M,U),m=t.mul(D,U);if(w)return{x:t.ZERO,y:t.ZERO};if(!t.eql(m,t.ONE))throw new Error("invZ was invalid");return{x:c,y:h}}),P=rs(Y=>{if(Y.is0()){if(e.allowInfinityPoint&&!t.is0(Y.py))return;throw new Error("bad point: ZERO")}const{x:U,y:G}=Y.toAffine();if(!t.isValid(U)||!t.isValid(G))throw new Error("bad point: x or y not field elements");if(!g(U,G))throw new Error("bad point: equation left != right");if(!Y.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});function $(Y,U,G,M,D){return G=new L(t.mul(G.px,Y),G.py,G.pz),U=ci(M,U),G=ci(D,G),U.add(G)}class L{constructor(U,G,M){this.px=A("x",U),this.py=A("y",G,!0),this.pz=A("z",M),Object.freeze(this)}static fromAffine(U){const{x:G,y:M}=U||{};if(!U||!t.isValid(G)||!t.isValid(M))throw new Error("invalid affine point");if(U instanceof L)throw new Error("projective point not allowed");return t.is0(G)&&t.is0(M)?L.ZERO:new L(G,M,t.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(U){return il(L,"pz",U)}static fromBytes(U){return rr(U),L.fromHex(U)}static fromHex(U){const G=L.fromAffine(_(rt("pointHex",U)));return G.assertValidity(),G}static fromPrivateKey(U){const G=th(r,e.allowedPrivateKeyLengths,e.wrapPrivateKey);return L.BASE.multiply(G(U))}static msm(U,G){return cl(L,r,U,G)}precompute(U=8,G=!0){return V.setWindowSize(this,U),G||this.multiply(zi),this}_setWindowSize(U){this.precompute(U)}assertValidity(){P(this)}hasEvenY(){const{y:U}=this.toAffine();if(!t.isOdd)throw new Error("Field doesn't support isOdd");return!t.isOdd(U)}equals(U){N(U);const{px:G,py:M,pz:D}=this,{px:w,py:c,pz:h}=U,m=t.eql(t.mul(G,h),t.mul(w,D)),E=t.eql(t.mul(M,h),t.mul(c,D));return m&&E}negate(){return new L(this.px,t.neg(this.py),this.pz)}double(){const{a:U,b:G}=n,M=t.mul(G,zi),{px:D,py:w,pz:c}=this;let h=t.ZERO,m=t.ZERO,E=t.ZERO,S=t.mul(D,D),O=t.mul(w,w),C=t.mul(c,c),R=t.mul(D,w);return R=t.add(R,R),E=t.mul(D,c),E=t.add(E,E),h=t.mul(U,E),m=t.mul(M,C),m=t.add(h,m),h=t.sub(O,m),m=t.add(O,m),m=t.mul(h,m),h=t.mul(R,h),E=t.mul(M,E),C=t.mul(U,C),R=t.sub(S,C),R=t.mul(U,R),R=t.add(R,E),E=t.add(S,S),S=t.add(E,S),S=t.add(S,C),S=t.mul(S,R),m=t.add(m,S),C=t.mul(w,c),C=t.add(C,C),S=t.mul(C,R),h=t.sub(h,S),E=t.mul(C,O),E=t.add(E,E),E=t.add(E,E),new L(h,m,E)}add(U){N(U);const{px:G,py:M,pz:D}=this,{px:w,py:c,pz:h}=U;let m=t.ZERO,E=t.ZERO,S=t.ZERO;const O=n.a,C=t.mul(n.b,zi);let R=t.mul(G,w),y=t.mul(M,c),T=t.mul(D,h),ae=t.add(G,M),ne=t.add(w,c);ae=t.mul(ae,ne),ne=t.add(R,y),ae=t.sub(ae,ne),ne=t.add(G,D);let le=t.add(w,h);return ne=t.mul(ne,le),le=t.add(R,T),ne=t.sub(ne,le),le=t.add(M,D),m=t.add(c,h),le=t.mul(le,m),m=t.add(y,T),le=t.sub(le,m),S=t.mul(O,ne),m=t.mul(C,T),S=t.add(m,S),m=t.sub(y,S),S=t.add(y,S),E=t.mul(m,S),y=t.add(R,R),y=t.add(y,R),T=t.mul(O,T),ne=t.mul(C,ne),y=t.add(y,T),T=t.sub(R,T),T=t.mul(O,T),ne=t.add(ne,T),R=t.mul(y,ne),E=t.add(E,R),R=t.mul(le,ne),m=t.mul(ae,m),m=t.sub(m,R),R=t.mul(ae,y),S=t.mul(le,S),S=t.add(S,R),new L(m,E,S)}subtract(U){return this.add(U.negate())}is0(){return this.equals(L.ZERO)}multiply(U){const{endo:G}=e;if(!r.isValidNot0(U))throw new Error("invalid scalar: out of range");let M,D;const w=c=>V.wNAFCached(this,c,L.normalizeZ);if(G){const{k1neg:c,k1:h,k2neg:m,k2:E}=G.splitScalar(U),{p:S,f:O}=w(h),{p:C,f:R}=w(E);D=O.add(R),M=$(G.beta,S,C,c,m)}else{const{p:c,f:h}=w(U);M=c,D=h}return L.normalizeZ([M,D])[0]}multiplyUnsafe(U){const{endo:G}=e,M=this;if(!r.isValid(U))throw new Error("invalid scalar: out of range");if(U===ui||M.is0())return L.ZERO;if(U===li)return M;if(V.hasPrecomputes(this))return this.multiply(U);if(G){const{k1neg:D,k1:w,k2neg:c,k2:h}=G.splitScalar(U),{p1:m,p2:E}=i0(L,M,w,h);return $(G.beta,m,E,D,c)}else return V.wNAFCachedUnsafe(M,U)}multiplyAndAddUnsafe(U,G,M){const D=this.multiplyUnsafe(G).add(U.multiplyUnsafe(M));return D.is0()?void 0:D}toAffine(U){return K(this,U)}isTorsionFree(){const{isTorsionFree:U}=e;return i===li?!0:U?U(L,this):V.wNAFCachedUnsafe(this,s).is0()}clearCofactor(){const{clearCofactor:U}=e;return i===li?this:U?U(L,this):this.multiplyUnsafe(i)}toBytes(U=!0){return pn("isCompressed",U),this.assertValidity(),f(L,this,U)}toRawBytes(U=!0){return this.toBytes(U)}toHex(U=!0){return Hn(this.toBytes(U))}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}}L.BASE=new L(n.Gx,n.Gy,t.ONE),L.ZERO=new L(t.ZERO,t.ONE,t.ZERO),L.Fp=t,L.Fn=r;const X=r.BITS,V=al(L,e.endo?Math.ceil(X/2):X);return L}function rh(n){return Uint8Array.of(n?2:3)}function fg(n,e,t={}){Ai(e,{hash:"function"},{hmac:"function",lowS:"boolean",randomBytes:"function",bits2int:"function",bits2int_modN:"function"});const r=e.randomBytes||Gu,i=e.hmac||((M,...D)=>eh(e.hash,M,Dr(...D))),{Fp:s,Fn:o}=n,{ORDER:a,BITS:u}=o;function l(M){const D=a>>li;return M>D}function f(M){return l(M)?o.neg(M):M}function _(M,D){if(!o.isValidNot0(D))throw new Error(`invalid signature ${M}: out of range 1..CURVE.n`)}class I{constructor(D,w,c){_("r",D),_("s",w),this.r=D,this.s=w,c!=null&&(this.recovery=c),Object.freeze(this)}static fromCompact(D){const w=o.BYTES,c=rt("compactSignature",D,w*2);return new I(o.fromBytes(c.subarray(0,w)),o.fromBytes(c.subarray(w,w*2)))}static fromDER(D){const{r:w,s:c}=Cr.toSig(rt("DER",D));return new I(w,c)}assertValidity(){}addRecoveryBit(D){return new I(this.r,this.s,D)}recoverPublicKey(D){const w=s.ORDER,{r:c,s:h,recovery:m}=this;if(m==null||![0,1,2,3].includes(m))throw new Error("recovery id invalid");if(a*cg<w&&m>1)throw new Error("recovery id is ambiguous for h>1 curve");const S=m===2||m===3?c+a:c;if(!s.isValid(S))throw new Error("recovery id 2 or 3 invalid");const O=s.toBytes(S),C=n.fromHex(Dr(rh((m&1)===0),O)),R=o.inv(S),y=P(rt("msgHash",D)),T=o.create(-y*R),ae=o.create(h*R),ne=n.BASE.multiplyUnsafe(T).add(C.multiplyUnsafe(ae));if(ne.is0())throw new Error("point at infinify");return ne.assertValidity(),ne}hasHighS(){return l(this.s)}normalizeS(){return this.hasHighS()?new I(this.r,o.neg(this.s),this.recovery):this}toBytes(D){if(D==="compact")return Dr(o.toBytes(this.r),o.toBytes(this.s));if(D==="der")return ha(Cr.hexFromSig(this));throw new Error("invalid format")}toDERRawBytes(){return this.toBytes("der")}toDERHex(){return Hn(this.toBytes("der"))}toCompactRawBytes(){return this.toBytes("compact")}toCompactHex(){return Hn(this.toBytes("compact"))}}const g=th(o,t.allowedPrivateKeyLengths,t.wrapPrivateKey),v={isValidPrivateKey(M){try{return g(M),!0}catch{return!1}},normPrivateKeyToScalar:g,randomPrivateKey:()=>{const M=a;return t0(r(nl(M)),M)},precompute(M=8,D=n.BASE){return D.precompute(M,!1)}};function x(M,D=!0){return n.fromPrivateKey(M).toBytes(D)}function A(M){if(typeof M=="bigint")return!1;if(M instanceof n)return!0;const w=rt("key",M).length,c=s.BYTES,h=c+1,m=2*c+1;if(!(t.allowedPrivateKeyLengths||o.BYTES===h))return w===h||w===m}function N(M,D,w=!0){if(A(M)===!0)throw new Error("first arg must be private key");if(A(D)===!1)throw new Error("second arg must be public key");return n.fromHex(D).multiply(g(M)).toBytes(w)}const K=e.bits2int||function(M){if(M.length>8192)throw new Error("input is too large");const D=_s(M),w=M.length*8-u;return w>0?D>>BigInt(w):D},P=e.bits2int_modN||function(M){return o.create(K(M))},$=Es(u);function L(M){return Cn("num < 2^"+u,M,ui,$),o.toBytes(M)}function X(M,D,w=V){if(["recovered","canonical"].some(ae=>ae in w))throw new Error("sign() legacy options not supported");const{hash:c}=e;let{lowS:h,prehash:m,extraEntropy:E}=w;h==null&&(h=!0),M=rt("msgHash",M),Oc(w),m&&(M=rt("prehashed msgHash",c(M)));const S=P(M),O=g(D),C=[L(O),L(S)];if(E!=null&&E!==!1){const ae=E===!0?r(s.BYTES):E;C.push(rt("extraEntropy",ae))}const R=Dr(...C),y=S;function T(ae){const ne=K(ae);if(!o.isValidNot0(ne))return;const le=o.inv(ne),Fe=n.BASE.multiply(ne).toAffine(),Ee=o.create(Fe.x);if(Ee===ui)return;const Ae=o.create(le*o.create(y+Ee*O));if(Ae===ui)return;let Ir=(Fe.x===Ee?0:2)|Number(Fe.y&li),Ne=Ae;return h&&l(Ae)&&(Ne=f(Ae),Ir^=1),new I(Ee,Ne,Ir)}return{seed:R,k2sig:T}}const V={lowS:e.lowS,prehash:!1},Y={lowS:e.lowS,prehash:!1};function U(M,D,w=V){const{seed:c,k2sig:h}=X(M,D,w);return Gp(e.hash.outputLen,o.BYTES,i)(c,h)}n.BASE.precompute(8);function G(M,D,w,c=Y){const h=M;D=rt("msgHash",D),w=rt("publicKey",w),Oc(c);const{lowS:m,prehash:E,format:S}=c;if("strict"in c)throw new Error("options.strict was renamed to lowS");if(S!==void 0&&!["compact","der","js"].includes(S))throw new Error('format must be "compact", "der" or "js"');const O=typeof h=="string"||la(h),C=!O&&!S&&typeof h=="object"&&h!==null&&typeof h.r=="bigint"&&typeof h.s=="bigint";if(!O&&!C)throw new Error("invalid signature, expected Uint8Array, hex string or Signature instance");let R,y;try{if(C)if(S===void 0||S==="js")R=new I(h.r,h.s);else throw new Error("invalid format");if(O){try{S!=="compact"&&(R=I.fromDER(h))}catch(Ne){if(!(Ne instanceof Cr.Err))throw Ne}!R&&S!=="der"&&(R=I.fromCompact(h))}y=n.fromHex(w)}catch{return!1}if(!R||m&&R.hasHighS())return!1;E&&(D=e.hash(D));const{r:T,s:ae}=R,ne=P(D),le=o.inv(ae),Fe=o.create(ne*le),Ee=o.create(T*le),Ae=n.BASE.multiplyUnsafe(Fe).add(y.multiplyUnsafe(Ee));return Ae.is0()?!1:o.create(Ae.x)===T}return Object.freeze({getPublicKey:x,getSharedSecret:N,sign:U,verify:G,utils:v,Point:n,Signature:I})}function dg(n){const e={a:n.a,b:n.b,p:n.Fp.ORDER,n:n.n,h:n.h,Gx:n.Gx,Gy:n.Gy},t=n.Fp,r=jn(e.n,n.nBitLength),i={Fp:t,Fn:r,allowedPrivateKeyLengths:n.allowedPrivateKeyLengths,allowInfinityPoint:n.allowInfinityPoint,endo:n.endo,wrapPrivateKey:n.wrapPrivateKey,isTorsionFree:n.isTorsionFree,clearCofactor:n.clearCofactor,fromBytes:n.fromBytes,toBytes:n.toBytes};return{CURVE:e,curveOpts:i}}function pg(n){const{CURVE:e,curveOpts:t}=dg(n),r={hash:n.hash,hmac:n.hmac,randomBytes:n.randomBytes,lowS:n.lowS,bits2int:n.bits2int,bits2int_modN:n.bits2int_modN};return{CURVE:e,curveOpts:t,ecdsaOpts:r}}function yg(n,e){return Object.assign({},e,{ProjectivePoint:e.Point,CURVE:n})}function gg(n){const{CURVE:e,curveOpts:t,ecdsaOpts:r}=pg(n),i=hg(e,t),s=fg(i,r,t);return yg(n,s)}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function mg(n,e){const t=r=>gg({...n,hash:r});return{...t(e),create:t}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const us={p:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),n:BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),h:BigInt(1),a:BigInt(0),b:BigInt(7),Gx:BigInt("0x79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"),Gy:BigInt("0x483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8")};BigInt(0);const wg=BigInt(1),qo=BigInt(2),Nc=(n,e)=>(n+e/qo)/e;function _g(n){const e=us.p,t=BigInt(3),r=BigInt(6),i=BigInt(11),s=BigInt(22),o=BigInt(23),a=BigInt(44),u=BigInt(88),l=n*n*n%e,f=l*l*n%e,_=et(f,t,e)*f%e,I=et(_,t,e)*f%e,g=et(I,qo,e)*l%e,v=et(g,i,e)*g%e,x=et(v,s,e)*v%e,A=et(x,a,e)*x%e,N=et(A,u,e)*A%e,K=et(N,a,e)*x%e,P=et(K,t,e)*f%e,$=et(P,o,e)*v%e,L=et($,r,e)*l%e,X=et(L,qo,e);if(!Vo.eql(Vo.sqr(X),n))throw new Error("Cannot find square root");return X}const Vo=jn(us.p,void 0,void 0,{sqrt:_g}),Na=mg({...us,Fp:Vo,lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:n=>{const e=us.n,t=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),r=-wg*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),i=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),s=t,o=BigInt("0x100000000000000000000000000000000"),a=Nc(s*n,e),u=Nc(-r*n,e);let l=nt(n-a*t-u*i,e),f=nt(-a*r-u*s,e);const _=l>o,I=f>o;if(_&&(l=e-l),I&&(f=e-f),l>o||f>o)throw new Error("splitScalar: Endomorphism failed, k="+n);return{k1neg:_,k1:l,k2neg:I,k2:f}}}},Zu),bg=Zn.utils.randomPrivateKey,Cc=()=>{const n=Zn.utils.randomPrivateKey(),e=ls(n),t=new Uint8Array(64);return t.set(n),t.set(e,32),{publicKey:e,secretKey:t}},ls=Zn.getPublicKey;function Bc(n){try{return Zn.ExtendedPoint.fromHex(n),!0}catch{return!1}}const Ca=(n,e)=>Zn.sign(n,e.slice(0,32)),Eg=Zn.verify,be=n=>te.Buffer.isBuffer(n)?n:n instanceof Uint8Array?te.Buffer.from(n.buffer,n.byteOffset,n.byteLength):te.Buffer.from(n);let Ba=class{constructor(e){Object.assign(this,e)}encode(){return te.Buffer.from(ml(hi,this))}static decode(e){return wl(hi,this,e)}static decodeUnchecked(e){return fl(hi,this,e)}};class Rg extends Ba{constructor(e){if(super(e),this.enum="",Object.keys(e).length!==1)throw new Error("Enum can only take single value");Object.keys(e).map(t=>{this.enum=t})}}const hi=new Map;var nh;const ih=32,br=32;function Ag(n){return n._bn!==void 0}let Mc=1;class j extends Ba{constructor(e){if(super({}),this._bn=void 0,Ag(e))this._bn=e._bn;else{if(typeof e=="string"){const t=Et.decode(e);if(t.length!=br)throw new Error("Invalid public key input");this._bn=new Mt(t)}else this._bn=new Mt(e);if(this._bn.byteLength()>br)throw new Error("Invalid public key input")}}static unique(){const e=new j(Mc);return Mc+=1,new j(e.toBuffer())}equals(e){return this._bn.eq(e._bn)}toBase58(){return Et.encode(this.toBytes())}toJSON(){return this.toBase58()}toBytes(){const e=this.toBuffer();return new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}toBuffer(){const e=this._bn.toArrayLike(te.Buffer);if(e.length===br)return e;const t=te.Buffer.alloc(32);return e.copy(t,32-e.length),t}get[Symbol.toStringTag](){return`PublicKey(${this.toString()})`}toString(){return this.toBase58()}static async createWithSeed(e,t,r){const i=te.Buffer.concat([e.toBuffer(),te.Buffer.from(t),r.toBuffer()]),s=vc(i);return new j(s)}static createProgramAddressSync(e,t){let r=te.Buffer.alloc(0);e.forEach(function(s){if(s.length>ih)throw new TypeError("Max seed length exceeded");r=te.Buffer.concat([r,be(s)])}),r=te.Buffer.concat([r,t.toBuffer(),te.Buffer.from("ProgramDerivedAddress")]);const i=vc(r);if(Bc(i))throw new Error("Invalid seeds, address must fall off the curve");return new j(i)}static async createProgramAddress(e,t){return this.createProgramAddressSync(e,t)}static findProgramAddressSync(e,t){let r=255,i;for(;r!=0;){try{const s=e.concat(te.Buffer.from([r]));i=this.createProgramAddressSync(s,t)}catch(s){if(s instanceof TypeError)throw s;r--;continue}return[i,r]}throw new Error("Unable to find a viable program address nonce")}static async findProgramAddress(e,t){return this.findProgramAddressSync(e,t)}static isOnCurve(e){const t=new j(e);return Bc(t.toBytes())}}nh=j;j.default=new nh("11111111111111111111111111111111");hi.set(j,{kind:"struct",fields:[["_bn","u256"]]});class vg{constructor(e){if(this._publicKey=void 0,this._secretKey=void 0,e){const t=be(e);if(e.length!==64)throw new Error("bad secret key size");this._publicKey=t.slice(32,64),this._secretKey=t.slice(0,32)}else this._secretKey=be(bg()),this._publicKey=be(ls(this._secretKey))}get publicKey(){return new j(this._publicKey)}get secretKey(){return te.Buffer.concat([this._secretKey,this._publicKey],64)}}const Sg=new j("BPFLoader1111111111111111111111111111111111"),Jr=1232,xs=127,wi=64;class Ma extends Error{constructor(e){super(`Signature ${e} has expired: block height exceeded.`),this.signature=void 0,this.signature=e}}Object.defineProperty(Ma.prototype,"name",{value:"TransactionExpiredBlockheightExceededError"});class La extends Error{constructor(e,t){super(`Transaction was not confirmed in ${t.toFixed(2)} seconds. It is unknown if it succeeded or failed. Check signature ${e} using the Solana Explorer or CLI tools.`),this.signature=void 0,this.signature=e}}Object.defineProperty(La.prototype,"name",{value:"TransactionExpiredTimeoutError"});class Bn extends Error{constructor(e){super(`Signature ${e} has expired: the nonce is no longer valid.`),this.signature=void 0,this.signature=e}}Object.defineProperty(Bn.prototype,"name",{value:"TransactionExpiredNonceInvalidError"});class _i{constructor(e,t){this.staticAccountKeys=void 0,this.accountKeysFromLookups=void 0,this.staticAccountKeys=e,this.accountKeysFromLookups=t}keySegments(){const e=[this.staticAccountKeys];return this.accountKeysFromLookups&&(e.push(this.accountKeysFromLookups.writable),e.push(this.accountKeysFromLookups.readonly)),e}get(e){for(const t of this.keySegments()){if(e<t.length)return t[e];e-=t.length}}get length(){return this.keySegments().flat().length}compileInstructions(e){if(this.length>256)throw new Error("Account index overflow encountered during compilation");const r=new Map;this.keySegments().flat().forEach((s,o)=>{r.set(s.toBase58(),o)});const i=s=>{const o=r.get(s.toBase58());if(o===void 0)throw new Error("Encountered an unknown instruction account key during compilation");return o};return e.map(s=>({programIdIndex:i(s.programId),accountKeyIndexes:s.keys.map(o=>i(o.pubkey)),data:s.data}))}}const Re=(n="publicKey")=>Le(32,n),Ig=(n="signature")=>Le(64,n),hn=(n="string")=>{const e=ue([ce("length"),ce("lengthPadding"),Le(Xr(ce(),-8),"chars")],n),t=e.decode.bind(e),r=e.encode.bind(e),i=e;return i.decode=(s,o)=>t(s,o).chars.toString(),i.encode=(s,o,a)=>{const u={chars:te.Buffer.from(s,"utf8")};return r(u,o,a)},i.alloc=s=>ce().span+ce().span+te.Buffer.from(s,"utf8").length,i},kg=(n="authorized")=>ue([Re("staker"),Re("withdrawer")],n),Tg=(n="lockup")=>ue([Vt("unixTimestamp"),Vt("epoch"),Re("custodian")],n),xg=(n="voteInit")=>ue([Re("nodePubkey"),Re("authorizedVoter"),Re("authorizedWithdrawer"),ve("commission")],n),Og=(n="voteAuthorizeWithSeedArgs")=>ue([ce("voteAuthorizationType"),Re("currentAuthorityDerivedKeyOwnerPubkey"),hn("currentAuthorityDerivedKeySeed"),Re("newAuthorized")],n);function sh(n,e){const t=i=>{if(i.span>=0)return i.span;if(typeof i.alloc=="function")return i.alloc(e[i.property]);if("count"in i&&"elementLayout"in i){const s=e[i.property];if(Array.isArray(s))return s.length*t(i.elementLayout)}else if("fields"in i)return sh({layout:i},e[i.property]);return 0};let r=0;return n.layout.fields.forEach(i=>{r+=t(i)}),r}function Dt(n){let e=0,t=0;for(;;){let r=n.shift();if(e|=(r&127)<<t*7,t+=1,!(r&128))break}return e}function jt(n,e){let t=e;for(;;){let r=t&127;if(t>>=7,t==0){n.push(r);break}else r|=128,n.push(r)}}function Te(n,e){if(!n)throw new Error(e||"Assertion failed")}class Os{constructor(e,t){this.payer=void 0,this.keyMetaMap=void 0,this.payer=e,this.keyMetaMap=t}static compile(e,t){const r=new Map,i=o=>{const a=o.toBase58();let u=r.get(a);return u===void 0&&(u={isSigner:!1,isWritable:!1,isInvoked:!1},r.set(a,u)),u},s=i(t);s.isSigner=!0,s.isWritable=!0;for(const o of e){i(o.programId).isInvoked=!0;for(const a of o.keys){const u=i(a.pubkey);u.isSigner||(u.isSigner=a.isSigner),u.isWritable||(u.isWritable=a.isWritable)}}return new Os(t,r)}getMessageComponents(){const e=[...this.keyMetaMap.entries()];Te(e.length<=256,"Max static account keys length exceeded");const t=e.filter(([,u])=>u.isSigner&&u.isWritable),r=e.filter(([,u])=>u.isSigner&&!u.isWritable),i=e.filter(([,u])=>!u.isSigner&&u.isWritable),s=e.filter(([,u])=>!u.isSigner&&!u.isWritable),o={numRequiredSignatures:t.length+r.length,numReadonlySignedAccounts:r.length,numReadonlyUnsignedAccounts:s.length};{Te(t.length>0,"Expected at least one writable signer key");const[u]=t[0];Te(u===this.payer.toBase58(),"Expected first writable signer key to be the fee payer")}const a=[...t.map(([u])=>new j(u)),...r.map(([u])=>new j(u)),...i.map(([u])=>new j(u)),...s.map(([u])=>new j(u))];return[o,a]}extractTableLookup(e){const[t,r]=this.drainKeysFoundInLookupTable(e.state.addresses,o=>!o.isSigner&&!o.isInvoked&&o.isWritable),[i,s]=this.drainKeysFoundInLookupTable(e.state.addresses,o=>!o.isSigner&&!o.isInvoked&&!o.isWritable);if(!(t.length===0&&i.length===0))return[{accountKey:e.key,writableIndexes:t,readonlyIndexes:i},{writable:r,readonly:s}]}drainKeysFoundInLookupTable(e,t){const r=new Array,i=new Array;for(const[s,o]of this.keyMetaMap.entries())if(t(o)){const a=new j(s),u=e.findIndex(l=>l.equals(a));u>=0&&(Te(u<256,"Max lookup table index exceeded"),r.push(u),i.push(a),this.keyMetaMap.delete(s))}return[r,i]}}const oh="Reached end of buffer unexpectedly";function mr(n){if(n.length===0)throw new Error(oh);return n.shift()}function Ft(n,...e){const[t]=e;if(e.length===2?t+(e[1]??0)>n.length:t>=n.length)throw new Error(oh);return n.splice(...e)}class lr{constructor(e){this.header=void 0,this.accountKeys=void 0,this.recentBlockhash=void 0,this.instructions=void 0,this.indexToProgramIds=new Map,this.header=e.header,this.accountKeys=e.accountKeys.map(t=>new j(t)),this.recentBlockhash=e.recentBlockhash,this.instructions=e.instructions,this.instructions.forEach(t=>this.indexToProgramIds.set(t.programIdIndex,this.accountKeys[t.programIdIndex]))}get version(){return"legacy"}get staticAccountKeys(){return this.accountKeys}get compiledInstructions(){return this.instructions.map(e=>({programIdIndex:e.programIdIndex,accountKeyIndexes:e.accounts,data:Et.decode(e.data)}))}get addressTableLookups(){return[]}getAccountKeys(){return new _i(this.staticAccountKeys)}static compile(e){const t=Os.compile(e.instructions,e.payerKey),[r,i]=t.getMessageComponents(),o=new _i(i).compileInstructions(e.instructions).map(a=>({programIdIndex:a.programIdIndex,accounts:a.accountKeyIndexes,data:Et.encode(a.data)}));return new lr({header:r,accountKeys:i,recentBlockhash:e.recentBlockhash,instructions:o})}isAccountSigner(e){return e<this.header.numRequiredSignatures}isAccountWritable(e){const t=this.header.numRequiredSignatures;if(e>=this.header.numRequiredSignatures){const r=e-t,s=this.accountKeys.length-t-this.header.numReadonlyUnsignedAccounts;return r<s}else{const r=t-this.header.numReadonlySignedAccounts;return e<r}}isProgramId(e){return this.indexToProgramIds.has(e)}programIds(){return[...this.indexToProgramIds.values()]}nonProgramIds(){return this.accountKeys.filter((e,t)=>!this.isProgramId(t))}serialize(){const e=this.accountKeys.length;let t=[];jt(t,e);const r=this.instructions.map(_=>{const{accounts:I,programIdIndex:g}=_,v=Array.from(Et.decode(_.data));let x=[];jt(x,I.length);let A=[];return jt(A,v.length),{programIdIndex:g,keyIndicesCount:te.Buffer.from(x),keyIndices:I,dataLength:te.Buffer.from(A),data:v}});let i=[];jt(i,r.length);let s=te.Buffer.alloc(Jr);te.Buffer.from(i).copy(s);let o=i.length;r.forEach(_=>{const g=ue([ve("programIdIndex"),Le(_.keyIndicesCount.length,"keyIndicesCount"),kt(ve("keyIndex"),_.keyIndices.length,"keyIndices"),Le(_.dataLength.length,"dataLength"),kt(ve("userdatum"),_.data.length,"data")]).encode(_,s,o);o+=g}),s=s.slice(0,o);const a=ue([Le(1,"numRequiredSignatures"),Le(1,"numReadonlySignedAccounts"),Le(1,"numReadonlyUnsignedAccounts"),Le(t.length,"keyCount"),kt(Re("key"),e,"keys"),Re("recentBlockhash")]),u={numRequiredSignatures:te.Buffer.from([this.header.numRequiredSignatures]),numReadonlySignedAccounts:te.Buffer.from([this.header.numReadonlySignedAccounts]),numReadonlyUnsignedAccounts:te.Buffer.from([this.header.numReadonlyUnsignedAccounts]),keyCount:te.Buffer.from(t),keys:this.accountKeys.map(_=>be(_.toBytes())),recentBlockhash:Et.decode(this.recentBlockhash)};let l=te.Buffer.alloc(2048);const f=a.encode(u,l);return s.copy(l,f),l.slice(0,f+s.length)}static from(e){let t=[...e];const r=mr(t);if(r!==(r&xs))throw new Error("Versioned messages must be deserialized with VersionedMessage.deserialize()");const i=mr(t),s=mr(t),o=Dt(t);let a=[];for(let I=0;I<o;I++){const g=Ft(t,0,br);a.push(new j(te.Buffer.from(g)))}const u=Ft(t,0,br),l=Dt(t);let f=[];for(let I=0;I<l;I++){const g=mr(t),v=Dt(t),x=Ft(t,0,v),A=Dt(t),N=Ft(t,0,A),K=Et.encode(te.Buffer.from(N));f.push({programIdIndex:g,accounts:x,data:K})}const _={header:{numRequiredSignatures:r,numReadonlySignedAccounts:i,numReadonlyUnsignedAccounts:s},recentBlockhash:Et.encode(te.Buffer.from(u)),accountKeys:a,instructions:f};return new lr(_)}}class yn{constructor(e){this.header=void 0,this.staticAccountKeys=void 0,this.recentBlockhash=void 0,this.compiledInstructions=void 0,this.addressTableLookups=void 0,this.header=e.header,this.staticAccountKeys=e.staticAccountKeys,this.recentBlockhash=e.recentBlockhash,this.compiledInstructions=e.compiledInstructions,this.addressTableLookups=e.addressTableLookups}get version(){return 0}get numAccountKeysFromLookups(){let e=0;for(const t of this.addressTableLookups)e+=t.readonlyIndexes.length+t.writableIndexes.length;return e}getAccountKeys(e){let t;if(e&&"accountKeysFromLookups"in e&&e.accountKeysFromLookups){if(this.numAccountKeysFromLookups!=e.accountKeysFromLookups.writable.length+e.accountKeysFromLookups.readonly.length)throw new Error("Failed to get account keys because of a mismatch in the number of account keys from lookups");t=e.accountKeysFromLookups}else if(e&&"addressLookupTableAccounts"in e&&e.addressLookupTableAccounts)t=this.resolveAddressTableLookups(e.addressLookupTableAccounts);else if(this.addressTableLookups.length>0)throw new Error("Failed to get account keys because address table lookups were not resolved");return new _i(this.staticAccountKeys,t)}isAccountSigner(e){return e<this.header.numRequiredSignatures}isAccountWritable(e){const t=this.header.numRequiredSignatures,r=this.staticAccountKeys.length;if(e>=r){const i=e-r,s=this.addressTableLookups.reduce((o,a)=>o+a.writableIndexes.length,0);return i<s}else if(e>=this.header.numRequiredSignatures){const i=e-t,o=r-t-this.header.numReadonlyUnsignedAccounts;return i<o}else{const i=t-this.header.numReadonlySignedAccounts;return e<i}}resolveAddressTableLookups(e){const t={writable:[],readonly:[]};for(const r of this.addressTableLookups){const i=e.find(s=>s.key.equals(r.accountKey));if(!i)throw new Error(`Failed to find address lookup table account for table key ${r.accountKey.toBase58()}`);for(const s of r.writableIndexes)if(s<i.state.addresses.length)t.writable.push(i.state.addresses[s]);else throw new Error(`Failed to find address for index ${s} in address lookup table ${r.accountKey.toBase58()}`);for(const s of r.readonlyIndexes)if(s<i.state.addresses.length)t.readonly.push(i.state.addresses[s]);else throw new Error(`Failed to find address for index ${s} in address lookup table ${r.accountKey.toBase58()}`)}return t}static compile(e){const t=Os.compile(e.instructions,e.payerKey),r=new Array,i={writable:new Array,readonly:new Array},s=e.addressLookupTableAccounts||[];for(const f of s){const _=t.extractTableLookup(f);if(_!==void 0){const[I,{writable:g,readonly:v}]=_;r.push(I),i.writable.push(...g),i.readonly.push(...v)}}const[o,a]=t.getMessageComponents(),l=new _i(a,i).compileInstructions(e.instructions);return new yn({header:o,staticAccountKeys:a,recentBlockhash:e.recentBlockhash,compiledInstructions:l,addressTableLookups:r})}serialize(){const e=Array();jt(e,this.staticAccountKeys.length);const t=this.serializeInstructions(),r=Array();jt(r,this.compiledInstructions.length);const i=this.serializeAddressTableLookups(),s=Array();jt(s,this.addressTableLookups.length);const o=ue([ve("prefix"),ue([ve("numRequiredSignatures"),ve("numReadonlySignedAccounts"),ve("numReadonlyUnsignedAccounts")],"header"),Le(e.length,"staticAccountKeysLength"),kt(Re(),this.staticAccountKeys.length,"staticAccountKeys"),Re("recentBlockhash"),Le(r.length,"instructionsLength"),Le(t.length,"serializedInstructions"),Le(s.length,"addressTableLookupsLength"),Le(i.length,"serializedAddressTableLookups")]),a=new Uint8Array(Jr),l=o.encode({prefix:128,header:this.header,staticAccountKeysLength:new Uint8Array(e),staticAccountKeys:this.staticAccountKeys.map(f=>f.toBytes()),recentBlockhash:Et.decode(this.recentBlockhash),instructionsLength:new Uint8Array(r),serializedInstructions:t,addressTableLookupsLength:new Uint8Array(s),serializedAddressTableLookups:i},a);return a.slice(0,l)}serializeInstructions(){let e=0;const t=new Uint8Array(Jr);for(const r of this.compiledInstructions){const i=Array();jt(i,r.accountKeyIndexes.length);const s=Array();jt(s,r.data.length);const o=ue([ve("programIdIndex"),Le(i.length,"encodedAccountKeyIndexesLength"),kt(ve(),r.accountKeyIndexes.length,"accountKeyIndexes"),Le(s.length,"encodedDataLength"),Le(r.data.length,"data")]);e+=o.encode({programIdIndex:r.programIdIndex,encodedAccountKeyIndexesLength:new Uint8Array(i),accountKeyIndexes:r.accountKeyIndexes,encodedDataLength:new Uint8Array(s),data:r.data},t,e)}return t.slice(0,e)}serializeAddressTableLookups(){let e=0;const t=new Uint8Array(Jr);for(const r of this.addressTableLookups){const i=Array();jt(i,r.writableIndexes.length);const s=Array();jt(s,r.readonlyIndexes.length);const o=ue([Re("accountKey"),Le(i.length,"encodedWritableIndexesLength"),kt(ve(),r.writableIndexes.length,"writableIndexes"),Le(s.length,"encodedReadonlyIndexesLength"),kt(ve(),r.readonlyIndexes.length,"readonlyIndexes")]);e+=o.encode({accountKey:r.accountKey.toBytes(),encodedWritableIndexesLength:new Uint8Array(i),writableIndexes:r.writableIndexes,encodedReadonlyIndexesLength:new Uint8Array(s),readonlyIndexes:r.readonlyIndexes},t,e)}return t.slice(0,e)}static deserialize(e){let t=[...e];const r=mr(t),i=r&xs;Te(r!==i,"Expected versioned message but received legacy message");const s=i;Te(s===0,`Expected versioned message with version 0 but found version ${s}`);const o={numRequiredSignatures:mr(t),numReadonlySignedAccounts:mr(t),numReadonlyUnsignedAccounts:mr(t)},a=[],u=Dt(t);for(let v=0;v<u;v++)a.push(new j(Ft(t,0,br)));const l=Et.encode(Ft(t,0,br)),f=Dt(t),_=[];for(let v=0;v<f;v++){const x=mr(t),A=Dt(t),N=Ft(t,0,A),K=Dt(t),P=new Uint8Array(Ft(t,0,K));_.push({programIdIndex:x,accountKeyIndexes:N,data:P})}const I=Dt(t),g=[];for(let v=0;v<I;v++){const x=new j(Ft(t,0,br)),A=Dt(t),N=Ft(t,0,A),K=Dt(t),P=Ft(t,0,K);g.push({accountKey:x,writableIndexes:N,readonlyIndexes:P})}return new yn({header:o,staticAccountKeys:a,recentBlockhash:l,compiledInstructions:_,addressTableLookups:g})}}const Pa={deserializeMessageVersion(n){const e=n[0],t=e&xs;return t===e?"legacy":t},deserialize:n=>{const e=Pa.deserializeMessageVersion(n);if(e==="legacy")return lr.from(n);if(e===0)return yn.deserialize(n);throw new Error(`Transaction message version ${e} deserialization is not supported`)}};let Nr=function(n){return n[n.BLOCKHEIGHT_EXCEEDED=0]="BLOCKHEIGHT_EXCEEDED",n[n.PROCESSED=1]="PROCESSED",n[n.TIMED_OUT=2]="TIMED_OUT",n[n.NONCE_INVALID=3]="NONCE_INVALID",n}({});const Ng=te.Buffer.alloc(wi).fill(0);class Ce{constructor(e){this.keys=void 0,this.programId=void 0,this.data=te.Buffer.alloc(0),this.programId=e.programId,this.keys=e.keys,e.data&&(this.data=e.data)}toJSON(){return{keys:this.keys.map(({pubkey:e,isSigner:t,isWritable:r})=>({pubkey:e.toJSON(),isSigner:t,isWritable:r})),programId:this.programId.toJSON(),data:[...this.data]}}}class ke{get signature(){return this.signatures.length>0?this.signatures[0].signature:null}constructor(e){if(this.signatures=[],this.feePayer=void 0,this.instructions=[],this.recentBlockhash=void 0,this.lastValidBlockHeight=void 0,this.nonceInfo=void 0,this.minNonceContextSlot=void 0,this._message=void 0,this._json=void 0,!!e)if(e.feePayer&&(this.feePayer=e.feePayer),e.signatures&&(this.signatures=e.signatures),Object.prototype.hasOwnProperty.call(e,"nonceInfo")){const{minContextSlot:t,nonceInfo:r}=e;this.minNonceContextSlot=t,this.nonceInfo=r}else if(Object.prototype.hasOwnProperty.call(e,"lastValidBlockHeight")){const{blockhash:t,lastValidBlockHeight:r}=e;this.recentBlockhash=t,this.lastValidBlockHeight=r}else{const{recentBlockhash:t,nonceInfo:r}=e;r&&(this.nonceInfo=r),this.recentBlockhash=t}}toJSON(){return{recentBlockhash:this.recentBlockhash||null,feePayer:this.feePayer?this.feePayer.toJSON():null,nonceInfo:this.nonceInfo?{nonce:this.nonceInfo.nonce,nonceInstruction:this.nonceInfo.nonceInstruction.toJSON()}:null,instructions:this.instructions.map(e=>e.toJSON()),signers:this.signatures.map(({publicKey:e})=>e.toJSON())}}add(...e){if(e.length===0)throw new Error("No instructions");return e.forEach(t=>{"instructions"in t?this.instructions=this.instructions.concat(t.instructions):"data"in t&&"programId"in t&&"keys"in t?this.instructions.push(t):this.instructions.push(new Ce(t))}),this}compileMessage(){if(this._message&&JSON.stringify(this.toJSON())===JSON.stringify(this._json))return this._message;let e,t;if(this.nonceInfo?(e=this.nonceInfo.nonce,this.instructions[0]!=this.nonceInfo.nonceInstruction?t=[this.nonceInfo.nonceInstruction,...this.instructions]:t=this.instructions):(e=this.recentBlockhash,t=this.instructions),!e)throw new Error("Transaction recentBlockhash required");t.length<1&&console.warn("No instructions provided");let r;if(this.feePayer)r=this.feePayer;else if(this.signatures.length>0&&this.signatures[0].publicKey)r=this.signatures[0].publicKey;else throw new Error("Transaction fee payer required");for(let x=0;x<t.length;x++)if(t[x].programId===void 0)throw new Error(`Transaction instruction index ${x} has undefined program id`);const i=[],s=[];t.forEach(x=>{x.keys.forEach(N=>{s.push({...N})});const A=x.programId.toString();i.includes(A)||i.push(A)}),i.forEach(x=>{s.push({pubkey:new j(x),isSigner:!1,isWritable:!1})});const o=[];s.forEach(x=>{const A=x.pubkey.toString(),N=o.findIndex(K=>K.pubkey.toString()===A);N>-1?(o[N].isWritable=o[N].isWritable||x.isWritable,o[N].isSigner=o[N].isSigner||x.isSigner):o.push(x)}),o.sort(function(x,A){if(x.isSigner!==A.isSigner)return x.isSigner?-1:1;if(x.isWritable!==A.isWritable)return x.isWritable?-1:1;const N={localeMatcher:"best fit",usage:"sort",sensitivity:"variant",ignorePunctuation:!1,numeric:!1,caseFirst:"lower"};return x.pubkey.toBase58().localeCompare(A.pubkey.toBase58(),"en",N)});const a=o.findIndex(x=>x.pubkey.equals(r));if(a>-1){const[x]=o.splice(a,1);x.isSigner=!0,x.isWritable=!0,o.unshift(x)}else o.unshift({pubkey:r,isSigner:!0,isWritable:!0});for(const x of this.signatures){const A=o.findIndex(N=>N.pubkey.equals(x.publicKey));if(A>-1)o[A].isSigner||(o[A].isSigner=!0,console.warn("Transaction references a signature that is unnecessary, only the fee payer and instruction signer accounts should sign a transaction. This behavior is deprecated and will throw an error in the next major version release."));else throw new Error(`unknown signer: ${x.publicKey.toString()}`)}let u=0,l=0,f=0;const _=[],I=[];o.forEach(({pubkey:x,isSigner:A,isWritable:N})=>{A?(_.push(x.toString()),u+=1,N||(l+=1)):(I.push(x.toString()),N||(f+=1))});const g=_.concat(I),v=t.map(x=>{const{data:A,programId:N}=x;return{programIdIndex:g.indexOf(N.toString()),accounts:x.keys.map(K=>g.indexOf(K.pubkey.toString())),data:Et.encode(A)}});return v.forEach(x=>{Te(x.programIdIndex>=0),x.accounts.forEach(A=>Te(A>=0))}),new lr({header:{numRequiredSignatures:u,numReadonlySignedAccounts:l,numReadonlyUnsignedAccounts:f},accountKeys:g,recentBlockhash:e,instructions:v})}_compile(){const e=this.compileMessage(),t=e.accountKeys.slice(0,e.header.numRequiredSignatures);return this.signatures.length===t.length&&this.signatures.every((i,s)=>t[s].equals(i.publicKey))||(this.signatures=t.map(r=>({signature:null,publicKey:r}))),e}serializeMessage(){return this._compile().serialize()}async getEstimatedFee(e){return(await e.getFeeForMessage(this.compileMessage())).value}setSigners(...e){if(e.length===0)throw new Error("No signers");const t=new Set;this.signatures=e.filter(r=>{const i=r.toString();return t.has(i)?!1:(t.add(i),!0)}).map(r=>({signature:null,publicKey:r}))}sign(...e){if(e.length===0)throw new Error("No signers");const t=new Set,r=[];for(const s of e){const o=s.publicKey.toString();t.has(o)||(t.add(o),r.push(s))}this.signatures=r.map(s=>({signature:null,publicKey:s.publicKey}));const i=this._compile();this._partialSign(i,...r)}partialSign(...e){if(e.length===0)throw new Error("No signers");const t=new Set,r=[];for(const s of e){const o=s.publicKey.toString();t.has(o)||(t.add(o),r.push(s))}const i=this._compile();this._partialSign(i,...r)}_partialSign(e,...t){const r=e.serialize();t.forEach(i=>{const s=Ca(r,i.secretKey);this._addSignature(i.publicKey,be(s))})}addSignature(e,t){this._compile(),this._addSignature(e,t)}_addSignature(e,t){Te(t.length===64);const r=this.signatures.findIndex(i=>e.equals(i.publicKey));if(r<0)throw new Error(`unknown signer: ${e.toString()}`);this.signatures[r].signature=te.Buffer.from(t)}verifySignatures(e=!0){return!this._getMessageSignednessErrors(this.serializeMessage(),e)}_getMessageSignednessErrors(e,t){const r={};for(const{signature:i,publicKey:s}of this.signatures)i===null?t&&(r.missing||(r.missing=[])).push(s):Eg(i,e,s.toBytes())||(r.invalid||(r.invalid=[])).push(s);return r.invalid||r.missing?r:void 0}serialize(e){const{requireAllSignatures:t,verifySignatures:r}=Object.assign({requireAllSignatures:!0,verifySignatures:!0},e),i=this.serializeMessage();if(r){const s=this._getMessageSignednessErrors(i,t);if(s){let o="Signature verification failed.";throw s.invalid&&(o+=`
Invalid signature for public key${s.invalid.length===1?"":"(s)"} [\`${s.invalid.map(a=>a.toBase58()).join("`, `")}\`].`),s.missing&&(o+=`
Missing signature for public key${s.missing.length===1?"":"(s)"} [\`${s.missing.map(a=>a.toBase58()).join("`, `")}\`].`),new Error(o)}}return this._serialize(i)}_serialize(e){const{signatures:t}=this,r=[];jt(r,t.length);const i=r.length+t.length*64+e.length,s=te.Buffer.alloc(i);return Te(t.length<256),te.Buffer.from(r).copy(s,0),t.forEach(({signature:o},a)=>{o!==null&&(Te(o.length===64,"signature has invalid length"),te.Buffer.from(o).copy(s,r.length+a*64))}),e.copy(s,r.length+t.length*64),Te(s.length<=Jr,`Transaction too large: ${s.length} > ${Jr}`),s}get keys(){return Te(this.instructions.length===1),this.instructions[0].keys.map(e=>e.pubkey)}get programId(){return Te(this.instructions.length===1),this.instructions[0].programId}get data(){return Te(this.instructions.length===1),this.instructions[0].data}static from(e){let t=[...e];const r=Dt(t);let i=[];for(let s=0;s<r;s++){const o=Ft(t,0,wi);i.push(Et.encode(te.Buffer.from(o)))}return ke.populate(lr.from(t),i)}static populate(e,t=[]){const r=new ke;return r.recentBlockhash=e.recentBlockhash,e.header.numRequiredSignatures>0&&(r.feePayer=e.accountKeys[0]),t.forEach((i,s)=>{const o={signature:i==Et.encode(Ng)?null:Et.decode(i),publicKey:e.accountKeys[s]};r.signatures.push(o)}),e.instructions.forEach(i=>{const s=i.accounts.map(o=>{const a=e.accountKeys[o];return{pubkey:a,isSigner:r.signatures.some(u=>u.publicKey.toString()===a.toString())||e.isAccountSigner(o),isWritable:e.isAccountWritable(o)}});r.instructions.push(new Ce({keys:s,programId:e.accountKeys[i.programIdIndex],data:Et.decode(i.data)}))}),r._message=e,r._json=r.toJSON(),r}}class Ua{constructor(e){this.payerKey=void 0,this.instructions=void 0,this.recentBlockhash=void 0,this.payerKey=e.payerKey,this.instructions=e.instructions,this.recentBlockhash=e.recentBlockhash}static decompile(e,t){const{header:r,compiledInstructions:i,recentBlockhash:s}=e,{numRequiredSignatures:o,numReadonlySignedAccounts:a,numReadonlyUnsignedAccounts:u}=r,l=o-a;Te(l>0,"Message header is invalid");const f=e.staticAccountKeys.length-o-u;Te(f>=0,"Message header is invalid");const _=e.getAccountKeys(t),I=_.get(0);if(I===void 0)throw new Error("Failed to decompile message because no account keys were found");const g=[];for(const v of i){const x=[];for(const N of v.accountKeyIndexes){const K=_.get(N);if(K===void 0)throw new Error(`Failed to find key for account key index ${N}`);const P=N<o;let $;P?$=N<l:N<_.staticAccountKeys.length?$=N-o<f:$=N-_.staticAccountKeys.length<_.accountKeysFromLookups.writable.length,x.push({pubkey:K,isSigner:N<r.numRequiredSignatures,isWritable:$})}const A=_.get(v.programIdIndex);if(A===void 0)throw new Error(`Failed to find program id for program id index ${v.programIdIndex}`);g.push(new Ce({programId:A,data:be(v.data),keys:x}))}return new Ua({payerKey:I,instructions:g,recentBlockhash:s})}compileToLegacyMessage(){return lr.compile({payerKey:this.payerKey,recentBlockhash:this.recentBlockhash,instructions:this.instructions})}compileToV0Message(e){return yn.compile({payerKey:this.payerKey,recentBlockhash:this.recentBlockhash,instructions:this.instructions,addressLookupTableAccounts:e})}}class Da{get version(){return this.message.version}constructor(e,t){if(this.signatures=void 0,this.message=void 0,t!==void 0)Te(t.length===e.header.numRequiredSignatures,"Expected signatures length to be equal to the number of required signatures"),this.signatures=t;else{const r=[];for(let i=0;i<e.header.numRequiredSignatures;i++)r.push(new Uint8Array(wi));this.signatures=r}this.message=e}serialize(){const e=this.message.serialize(),t=Array();jt(t,this.signatures.length);const r=ue([Le(t.length,"encodedSignaturesLength"),kt(Ig(),this.signatures.length,"signatures"),Le(e.length,"serializedMessage")]),i=new Uint8Array(2048),s=r.encode({encodedSignaturesLength:new Uint8Array(t),signatures:this.signatures,serializedMessage:e},i);return i.slice(0,s)}static deserialize(e){let t=[...e];const r=[],i=Dt(t);for(let o=0;o<i;o++)r.push(new Uint8Array(Ft(t,0,wi)));const s=Pa.deserialize(new Uint8Array(t));return new Da(s,r)}sign(e){const t=this.message.serialize(),r=this.message.staticAccountKeys.slice(0,this.message.header.numRequiredSignatures);for(const i of e){const s=r.findIndex(o=>o.equals(i.publicKey));Te(s>=0,`Cannot sign with non signer key ${i.publicKey.toBase58()}`),this.signatures[s]=Ca(t,i.secretKey)}}addSignature(e,t){Te(t.byteLength===64,"Signature must be 64 bytes long");const i=this.message.staticAccountKeys.slice(0,this.message.header.numRequiredSignatures).findIndex(s=>s.equals(e));Te(i>=0,`Can not add signature; \`${e.toBase58()}\` is not required to sign this transaction`),this.signatures[i]=t}}const Cg=160,Bg=64,Mg=Cg/Bg,ah=1e3/Mg,yr=new j("SysvarC1ock11111111111111111111111111111111"),Lg=new j("SysvarEpochSchedu1e111111111111111111111111"),Pg=new j("Sysvar1nstructions1111111111111111111111111"),Xi=new j("SysvarRecentB1ockHashes11111111111111111111"),Kn=new j("SysvarRent111111111111111111111111111111111"),Ug=new j("SysvarRewards111111111111111111111111111111"),Dg=new j("SysvarS1otHashes111111111111111111111111111"),Fg=new j("SysvarS1otHistory11111111111111111111111111"),Ji=new j("SysvarStakeHistory1111111111111111111111111");class tn extends Error{constructor({action:e,signature:t,transactionMessage:r,logs:i}){const s=i?`Logs: 
${JSON.stringify(i.slice(-10),null,2)}. `:"",o="\nCatch the `SendTransactionError` and call `getLogs()` on it for full details.";let a;switch(e){case"send":a=`Transaction ${t} resulted in an error. 
${r}. `+s+o;break;case"simulate":a=`Simulation failed. 
Message: ${r}. 
`+s+o;break;default:a=`Unknown action '${(u=>u)(e)}'`}super(a),this.signature=void 0,this.transactionMessage=void 0,this.transactionLogs=void 0,this.signature=t,this.transactionMessage=r,this.transactionLogs=i||void 0}get transactionError(){return{message:this.transactionMessage,logs:Array.isArray(this.transactionLogs)?this.transactionLogs:void 0}}get logs(){const e=this.transactionLogs;if(!(e!=null&&typeof e=="object"&&"then"in e))return e}async getLogs(e){return Array.isArray(this.transactionLogs)||(this.transactionLogs=new Promise((t,r)=>{e.getTransaction(this.signature).then(i=>{if(i&&i.meta&&i.meta.logMessages){const s=i.meta.logMessages;this.transactionLogs=s,t(s)}else r(new Error("Log messages not found"))}).catch(r)})),await this.transactionLogs}}const Hg={JSON_RPC_SERVER_ERROR_BLOCK_CLEANED_UP:-32001,JSON_RPC_SERVER_ERROR_SEND_TRANSACTION_PREFLIGHT_FAILURE:-32002,JSON_RPC_SERVER_ERROR_TRANSACTION_SIGNATURE_VERIFICATION_FAILURE:-32003,JSON_RPC_SERVER_ERROR_BLOCK_NOT_AVAILABLE:-32004,JSON_RPC_SERVER_ERROR_NODE_UNHEALTHY:-32005,JSON_RPC_SERVER_ERROR_TRANSACTION_PRECOMPILE_VERIFICATION_FAILURE:-32006,JSON_RPC_SERVER_ERROR_SLOT_SKIPPED:-32007,JSON_RPC_SERVER_ERROR_NO_SNAPSHOT:-32008,JSON_RPC_SERVER_ERROR_LONG_TERM_STORAGE_SLOT_SKIPPED:-32009,JSON_RPC_SERVER_ERROR_KEY_EXCLUDED_FROM_SECONDARY_INDEX:-32010,JSON_RPC_SERVER_ERROR_TRANSACTION_HISTORY_NOT_AVAILABLE:-32011,JSON_RPC_SCAN_ERROR:-32012,JSON_RPC_SERVER_ERROR_TRANSACTION_SIGNATURE_LEN_MISMATCH:-32013,JSON_RPC_SERVER_ERROR_BLOCK_STATUS_NOT_AVAILABLE_YET:-32014,JSON_RPC_SERVER_ERROR_UNSUPPORTED_TRANSACTION_VERSION:-32015,JSON_RPC_SERVER_ERROR_MIN_CONTEXT_SLOT_NOT_REACHED:-32016};class he extends Error{constructor({code:e,message:t,data:r},i){super(i!=null?`${i}: ${t}`:t),this.code=void 0,this.data=void 0,this.code=e,this.data=r,this.name="SolanaJSONRPCError"}}async function jo(n,e,t,r){const i=r&&{skipPreflight:r.skipPreflight,preflightCommitment:r.preflightCommitment||r.commitment,maxRetries:r.maxRetries,minContextSlot:r.minContextSlot},s=await n.sendTransaction(e,t,i);let o;if(e.recentBlockhash!=null&&e.lastValidBlockHeight!=null)o=(await n.confirmTransaction({abortSignal:r==null?void 0:r.abortSignal,signature:s,blockhash:e.recentBlockhash,lastValidBlockHeight:e.lastValidBlockHeight},r&&r.commitment)).value;else if(e.minNonceContextSlot!=null&&e.nonceInfo!=null){const{nonceInstruction:a}=e.nonceInfo,u=a.keys[0].pubkey;o=(await n.confirmTransaction({abortSignal:r==null?void 0:r.abortSignal,minContextSlot:e.minNonceContextSlot,nonceAccountPubkey:u,nonceValue:e.nonceInfo.nonce,signature:s},r&&r.commitment)).value}else(r==null?void 0:r.abortSignal)!=null&&console.warn("sendAndConfirmTransaction(): A transaction with a deprecated confirmation strategy was supplied along with an `abortSignal`. Only transactions having `lastValidBlockHeight` or a combination of `nonceInfo` and `minNonceContextSlot` are abortable."),o=(await n.confirmTransaction(s,r&&r.commitment)).value;if(o.err)throw s!=null?new tn({action:"send",signature:s,transactionMessage:`Status: (${JSON.stringify(o)})`}):new Error(`Transaction ${s} failed (${JSON.stringify(o)})`);return s}function cn(n){return new Promise(e=>setTimeout(e,n))}function Ie(n,e){const t=n.layout.span>=0?n.layout.span:sh(n,e),r=te.Buffer.alloc(t),i=Object.assign({instruction:n.index},e);return n.layout.encode(i,r),r}function Oe(n,e){let t;try{t=n.layout.decode(e)}catch(r){throw new Error("invalid instruction; "+r)}if(t.instruction!==n.index)throw new Error(`invalid instruction; instruction index mismatch ${t.instruction} != ${n.index}`);return t}const ch=St("lamportsPerSignature"),uh=ue([ce("version"),ce("state"),Re("authorizedPubkey"),Re("nonce"),ue([ch],"feeCalculator")]),Zo=uh.span;class Ns{constructor(e){this.authorizedPubkey=void 0,this.nonce=void 0,this.feeCalculator=void 0,this.authorizedPubkey=e.authorizedPubkey,this.nonce=e.nonce,this.feeCalculator=e.feeCalculator}static fromAccountData(e){const t=uh.decode(be(e),0);return new Ns({authorizedPubkey:new j(t.authorizedPubkey),nonce:new j(t.nonce).toString(),feeCalculator:t.feeCalculator})}}function Wn(n){const e=Le(8,n),t=e.decode.bind(e),r=e.encode.bind(e),i=e,s=dy();return i.decode=(o,a)=>{const u=t(o,a);return s.decode(u)},i.encode=(o,a,u)=>{const l=s.encode(o);return r(l,a,u)},i}class zg{constructor(){}static decodeInstructionType(e){this.checkProgramId(e.programId);const r=ce("instruction").decode(e.data);let i;for(const[s,o]of Object.entries(De))if(o.index==r){i=s;break}if(!i)throw new Error("Instruction type incorrect; not a SystemInstruction");return i}static decodeCreateAccount(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,2);const{lamports:t,space:r,programId:i}=Oe(De.Create,e.data);return{fromPubkey:e.keys[0].pubkey,newAccountPubkey:e.keys[1].pubkey,lamports:t,space:r,programId:new j(i)}}static decodeTransfer(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,2);const{lamports:t}=Oe(De.Transfer,e.data);return{fromPubkey:e.keys[0].pubkey,toPubkey:e.keys[1].pubkey,lamports:t}}static decodeTransferWithSeed(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,3);const{lamports:t,seed:r,programId:i}=Oe(De.TransferWithSeed,e.data);return{fromPubkey:e.keys[0].pubkey,basePubkey:e.keys[1].pubkey,toPubkey:e.keys[2].pubkey,lamports:t,seed:r,programId:new j(i)}}static decodeAllocate(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,1);const{space:t}=Oe(De.Allocate,e.data);return{accountPubkey:e.keys[0].pubkey,space:t}}static decodeAllocateWithSeed(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,1);const{base:t,seed:r,space:i,programId:s}=Oe(De.AllocateWithSeed,e.data);return{accountPubkey:e.keys[0].pubkey,basePubkey:new j(t),seed:r,space:i,programId:new j(s)}}static decodeAssign(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,1);const{programId:t}=Oe(De.Assign,e.data);return{accountPubkey:e.keys[0].pubkey,programId:new j(t)}}static decodeAssignWithSeed(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,1);const{base:t,seed:r,programId:i}=Oe(De.AssignWithSeed,e.data);return{accountPubkey:e.keys[0].pubkey,basePubkey:new j(t),seed:r,programId:new j(i)}}static decodeCreateWithSeed(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,2);const{base:t,seed:r,lamports:i,space:s,programId:o}=Oe(De.CreateWithSeed,e.data);return{fromPubkey:e.keys[0].pubkey,newAccountPubkey:e.keys[1].pubkey,basePubkey:new j(t),seed:r,lamports:i,space:s,programId:new j(o)}}static decodeNonceInitialize(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,3);const{authorized:t}=Oe(De.InitializeNonceAccount,e.data);return{noncePubkey:e.keys[0].pubkey,authorizedPubkey:new j(t)}}static decodeNonceAdvance(e){return this.checkProgramId(e.programId),this.checkKeyLength(e.keys,3),Oe(De.AdvanceNonceAccount,e.data),{noncePubkey:e.keys[0].pubkey,authorizedPubkey:e.keys[2].pubkey}}static decodeNonceWithdraw(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,5);const{lamports:t}=Oe(De.WithdrawNonceAccount,e.data);return{noncePubkey:e.keys[0].pubkey,toPubkey:e.keys[1].pubkey,authorizedPubkey:e.keys[4].pubkey,lamports:t}}static decodeNonceAuthorize(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,2);const{authorized:t}=Oe(De.AuthorizeNonceAccount,e.data);return{noncePubkey:e.keys[0].pubkey,authorizedPubkey:e.keys[1].pubkey,newAuthorizedPubkey:new j(t)}}static checkProgramId(e){if(!e.equals($e.programId))throw new Error("invalid instruction; programId is not SystemProgram")}static checkKeyLength(e,t){if(e.length<t)throw new Error(`invalid instruction; found ${e.length} keys, expected at least ${t}`)}}const De=Object.freeze({Create:{index:0,layout:ue([ce("instruction"),Vt("lamports"),Vt("space"),Re("programId")])},Assign:{index:1,layout:ue([ce("instruction"),Re("programId")])},Transfer:{index:2,layout:ue([ce("instruction"),Wn("lamports")])},CreateWithSeed:{index:3,layout:ue([ce("instruction"),Re("base"),hn("seed"),Vt("lamports"),Vt("space"),Re("programId")])},AdvanceNonceAccount:{index:4,layout:ue([ce("instruction")])},WithdrawNonceAccount:{index:5,layout:ue([ce("instruction"),Vt("lamports")])},InitializeNonceAccount:{index:6,layout:ue([ce("instruction"),Re("authorized")])},AuthorizeNonceAccount:{index:7,layout:ue([ce("instruction"),Re("authorized")])},Allocate:{index:8,layout:ue([ce("instruction"),Vt("space")])},AllocateWithSeed:{index:9,layout:ue([ce("instruction"),Re("base"),hn("seed"),Vt("space"),Re("programId")])},AssignWithSeed:{index:10,layout:ue([ce("instruction"),Re("base"),hn("seed"),Re("programId")])},TransferWithSeed:{index:11,layout:ue([ce("instruction"),Wn("lamports"),hn("seed"),Re("programId")])},UpgradeNonceAccount:{index:12,layout:ue([ce("instruction")])}});class $e{constructor(){}static createAccount(e){const t=De.Create,r=Ie(t,{lamports:e.lamports,space:e.space,programId:be(e.programId.toBuffer())});return new Ce({keys:[{pubkey:e.fromPubkey,isSigner:!0,isWritable:!0},{pubkey:e.newAccountPubkey,isSigner:!0,isWritable:!0}],programId:this.programId,data:r})}static transfer(e){let t,r;if("basePubkey"in e){const i=De.TransferWithSeed;t=Ie(i,{lamports:BigInt(e.lamports),seed:e.seed,programId:be(e.programId.toBuffer())}),r=[{pubkey:e.fromPubkey,isSigner:!1,isWritable:!0},{pubkey:e.basePubkey,isSigner:!0,isWritable:!1},{pubkey:e.toPubkey,isSigner:!1,isWritable:!0}]}else{const i=De.Transfer;t=Ie(i,{lamports:BigInt(e.lamports)}),r=[{pubkey:e.fromPubkey,isSigner:!0,isWritable:!0},{pubkey:e.toPubkey,isSigner:!1,isWritable:!0}]}return new Ce({keys:r,programId:this.programId,data:t})}static assign(e){let t,r;if("basePubkey"in e){const i=De.AssignWithSeed;t=Ie(i,{base:be(e.basePubkey.toBuffer()),seed:e.seed,programId:be(e.programId.toBuffer())}),r=[{pubkey:e.accountPubkey,isSigner:!1,isWritable:!0},{pubkey:e.basePubkey,isSigner:!0,isWritable:!1}]}else{const i=De.Assign;t=Ie(i,{programId:be(e.programId.toBuffer())}),r=[{pubkey:e.accountPubkey,isSigner:!0,isWritable:!0}]}return new Ce({keys:r,programId:this.programId,data:t})}static createAccountWithSeed(e){const t=De.CreateWithSeed,r=Ie(t,{base:be(e.basePubkey.toBuffer()),seed:e.seed,lamports:e.lamports,space:e.space,programId:be(e.programId.toBuffer())});let i=[{pubkey:e.fromPubkey,isSigner:!0,isWritable:!0},{pubkey:e.newAccountPubkey,isSigner:!1,isWritable:!0}];return e.basePubkey.equals(e.fromPubkey)||i.push({pubkey:e.basePubkey,isSigner:!0,isWritable:!1}),new Ce({keys:i,programId:this.programId,data:r})}static createNonceAccount(e){const t=new ke;"basePubkey"in e&&"seed"in e?t.add($e.createAccountWithSeed({fromPubkey:e.fromPubkey,newAccountPubkey:e.noncePubkey,basePubkey:e.basePubkey,seed:e.seed,lamports:e.lamports,space:Zo,programId:this.programId})):t.add($e.createAccount({fromPubkey:e.fromPubkey,newAccountPubkey:e.noncePubkey,lamports:e.lamports,space:Zo,programId:this.programId}));const r={noncePubkey:e.noncePubkey,authorizedPubkey:e.authorizedPubkey};return t.add(this.nonceInitialize(r)),t}static nonceInitialize(e){const t=De.InitializeNonceAccount,r=Ie(t,{authorized:be(e.authorizedPubkey.toBuffer())}),i={keys:[{pubkey:e.noncePubkey,isSigner:!1,isWritable:!0},{pubkey:Xi,isSigner:!1,isWritable:!1},{pubkey:Kn,isSigner:!1,isWritable:!1}],programId:this.programId,data:r};return new Ce(i)}static nonceAdvance(e){const t=De.AdvanceNonceAccount,r=Ie(t),i={keys:[{pubkey:e.noncePubkey,isSigner:!1,isWritable:!0},{pubkey:Xi,isSigner:!1,isWritable:!1},{pubkey:e.authorizedPubkey,isSigner:!0,isWritable:!1}],programId:this.programId,data:r};return new Ce(i)}static nonceWithdraw(e){const t=De.WithdrawNonceAccount,r=Ie(t,{lamports:e.lamports});return new Ce({keys:[{pubkey:e.noncePubkey,isSigner:!1,isWritable:!0},{pubkey:e.toPubkey,isSigner:!1,isWritable:!0},{pubkey:Xi,isSigner:!1,isWritable:!1},{pubkey:Kn,isSigner:!1,isWritable:!1},{pubkey:e.authorizedPubkey,isSigner:!0,isWritable:!1}],programId:this.programId,data:r})}static nonceAuthorize(e){const t=De.AuthorizeNonceAccount,r=Ie(t,{authorized:be(e.newAuthorizedPubkey.toBuffer())});return new Ce({keys:[{pubkey:e.noncePubkey,isSigner:!1,isWritable:!0},{pubkey:e.authorizedPubkey,isSigner:!0,isWritable:!1}],programId:this.programId,data:r})}static allocate(e){let t,r;if("basePubkey"in e){const i=De.AllocateWithSeed;t=Ie(i,{base:be(e.basePubkey.toBuffer()),seed:e.seed,space:e.space,programId:be(e.programId.toBuffer())}),r=[{pubkey:e.accountPubkey,isSigner:!1,isWritable:!0},{pubkey:e.basePubkey,isSigner:!0,isWritable:!1}]}else{const i=De.Allocate;t=Ie(i,{space:e.space}),r=[{pubkey:e.accountPubkey,isSigner:!0,isWritable:!0}]}return new Ce({keys:r,programId:this.programId,data:t})}}$e.programId=new j("11111111111111111111111111111111");const $g=Jr-300;class gn{constructor(){}static getMinNumSignatures(e){return 2*(Math.ceil(e/gn.chunkSize)+1+1)}static async load(e,t,r,i,s){{const _=await e.getMinimumBalanceForRentExemption(s.length),I=await e.getAccountInfo(r.publicKey,"confirmed");let g=null;if(I!==null){if(I.executable)return console.error("Program load failed, account is already executable"),!1;I.data.length!==s.length&&(g=g||new ke,g.add($e.allocate({accountPubkey:r.publicKey,space:s.length}))),I.owner.equals(i)||(g=g||new ke,g.add($e.assign({accountPubkey:r.publicKey,programId:i}))),I.lamports<_&&(g=g||new ke,g.add($e.transfer({fromPubkey:t.publicKey,toPubkey:r.publicKey,lamports:_-I.lamports})))}else g=new ke().add($e.createAccount({fromPubkey:t.publicKey,newAccountPubkey:r.publicKey,lamports:_>0?_:1,space:s.length,programId:i}));g!==null&&await jo(e,g,[t,r],{commitment:"confirmed"})}const o=ue([ce("instruction"),ce("offset"),ce("bytesLength"),ce("bytesLengthPadding"),kt(ve("byte"),Xr(ce(),-8),"bytes")]),a=gn.chunkSize;let u=0,l=s,f=[];for(;l.length>0;){const _=l.slice(0,a),I=te.Buffer.alloc(a+16);o.encode({instruction:0,offset:u,bytes:_,bytesLength:0,bytesLengthPadding:0},I);const g=new ke().add({keys:[{pubkey:r.publicKey,isSigner:!0,isWritable:!0}],programId:i,data:I});f.push(jo(e,g,[t,r],{commitment:"confirmed"})),e._rpcEndpoint.includes("solana.com")&&await cn(1e3/4),u+=a,l=l.slice(a)}await Promise.all(f);{const _=ue([ce("instruction")]),I=te.Buffer.alloc(_.span);_.encode({instruction:1},I);const g=new ke().add({keys:[{pubkey:r.publicKey,isSigner:!0,isWritable:!0},{pubkey:Kn,isSigner:!1,isWritable:!1}],programId:i,data:I}),v="processed",x=await e.sendTransaction(g,[t,r],{preflightCommitment:v}),{context:A,value:N}=await e.confirmTransaction({signature:x,lastValidBlockHeight:g.lastValidBlockHeight,blockhash:g.recentBlockhash},v);if(N.err)throw new Error(`Transaction ${x} failed (${JSON.stringify(N)})`);for(;;){try{if(await e.getSlot({commitment:v})>A.slot)break}catch{}await new Promise(K=>setTimeout(K,Math.round(ah/2)))}}return!0}}gn.chunkSize=$g;const Kg=new j("BPFLoader2111111111111111111111111111111111");class Wg{static getMinNumSignatures(e){return gn.getMinNumSignatures(e)}static load(e,t,r,i,s){return gn.load(e,t,r,s,i)}}function Gg(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var vo,Lc;function qg(){if(Lc)return vo;Lc=1;var n=Object.prototype.toString,e=Object.keys||function(r){var i=[];for(var s in r)i.push(s);return i};function t(r,i){var s,o,a,u,l,f,_;if(r===!0)return"true";if(r===!1)return"false";switch(typeof r){case"object":if(r===null)return null;if(r.toJSON&&typeof r.toJSON=="function")return t(r.toJSON(),i);if(_=n.call(r),_==="[object Array]"){for(a="[",o=r.length-1,s=0;s<o;s++)a+=t(r[s],!0)+",";return o>-1&&(a+=t(r[s],!0)),a+"]"}else if(_==="[object Object]"){for(u=e(r).sort(),o=u.length,a="",s=0;s<o;)l=u[s],f=t(r[l],!1),f!==void 0&&(a&&(a+=","),a+=JSON.stringify(l)+":"+f),s++;return"{"+a+"}"}else return JSON.stringify(r);case"function":case"undefined":return i?null:void 0;case"string":return JSON.stringify(r);default:return isFinite(r)?r:null}}return vo=function(r){var i=t(r,!1);if(i!==void 0)return""+i},vo}var Vg=qg(),Pc=Gg(Vg);const ii=32;function So(n){let e=0;for(;n>1;)n/=2,e++;return e}function jg(n){return n===0?1:(n--,n|=n>>1,n|=n>>2,n|=n>>4,n|=n>>8,n|=n>>16,n|=n>>32,n+1)}class lh{constructor(e,t,r,i,s){this.slotsPerEpoch=void 0,this.leaderScheduleSlotOffset=void 0,this.warmup=void 0,this.firstNormalEpoch=void 0,this.firstNormalSlot=void 0,this.slotsPerEpoch=e,this.leaderScheduleSlotOffset=t,this.warmup=r,this.firstNormalEpoch=i,this.firstNormalSlot=s}getEpoch(e){return this.getEpochAndSlotIndex(e)[0]}getEpochAndSlotIndex(e){if(e<this.firstNormalSlot){const t=So(jg(e+ii+1))-So(ii)-1,r=this.getSlotsInEpoch(t),i=e-(r-ii);return[t,i]}else{const t=e-this.firstNormalSlot,r=Math.floor(t/this.slotsPerEpoch),i=this.firstNormalEpoch+r,s=t%this.slotsPerEpoch;return[i,s]}}getFirstSlotInEpoch(e){return e<=this.firstNormalEpoch?(Math.pow(2,e)-1)*ii:(e-this.firstNormalEpoch)*this.slotsPerEpoch+this.firstNormalSlot}getLastSlotInEpoch(e){return this.getFirstSlotInEpoch(e)+this.getSlotsInEpoch(e)-1}getSlotsInEpoch(e){return e<this.firstNormalEpoch?Math.pow(2,e+So(ii)):this.slotsPerEpoch}}var Zg=globalThis.fetch;class Yg extends Xy{constructor(e,t,r){const i=s=>{const o=Zy(s,{autoconnect:!0,max_reconnects:5,reconnect:!0,reconnect_interval:1e3,...t});return"socket"in o?this.underlyingSocket=o.socket:this.underlyingSocket=o,o};super(i,e,t,r),this.underlyingSocket=void 0}call(...e){var r;const t=(r=this.underlyingSocket)==null?void 0:r.readyState;return t===1?super.call(...e):Promise.reject(new Error("Tried to call a JSON-RPC method `"+e[0]+"` but the socket was not `CONNECTING` or `OPEN` (`readyState` was "+t+")"))}notify(...e){var r;const t=(r=this.underlyingSocket)==null?void 0:r.readyState;return t===1?super.notify(...e):Promise.reject(new Error("Tried to send a JSON-RPC notification `"+e[0]+"` but the socket was not `CONNECTING` or `OPEN` (`readyState` was "+t+")"))}}function Xg(n,e){let t;try{t=n.layout.decode(e)}catch(r){throw new Error("invalid instruction; "+r)}if(t.typeIndex!==n.index)throw new Error(`invalid account data; account type mismatch ${t.typeIndex} != ${n.index}`);return t}const Uc=56;class Yo{constructor(e){this.key=void 0,this.state=void 0,this.key=e.key,this.state=e.state}isActive(){const e=BigInt("0xffffffffffffffff");return this.state.deactivationSlot===e}static deserialize(e){const t=Xg(Jg,e),r=e.length-Uc;Te(r>=0,"lookup table is invalid"),Te(r%32===0,"lookup table is invalid");const i=r/32,{addresses:s}=ue([kt(Re(),i,"addresses")]).decode(e.slice(Uc));return{deactivationSlot:t.deactivationSlot,lastExtendedSlot:t.lastExtendedSlot,lastExtendedSlotStartIndex:t.lastExtendedStartIndex,authority:t.authority.length!==0?new j(t.authority[0]):void 0,addresses:s.map(o=>new j(o))}}}const Jg={index:1,layout:ue([ce("typeIndex"),Wn("deactivationSlot"),St("lastExtendedSlot"),ve("lastExtendedStartIndex"),ve(),kt(Re(),Xr(ve(),-1),"authority")])},Qg=/^[^:]+:\/\/([^:[]+|\[[^\]]+\])(:\d+)?(.*)/i;function em(n){const e=n.match(Qg);if(e==null)throw TypeError(`Failed to validate endpoint URL \`${n}\``);const[t,r,i,s]=e,o=n.startsWith("https:")?"wss:":"ws:",a=i==null?null:parseInt(i.slice(1),10),u=a==null?"":`:${a+1}`;return`${o}//${r}${u}${s}`}const Ze=Ii(Ta(j),Q(),n=>new j(n)),hh=xa([Q(),je("base64")]),Fa=Ii(Ta(te.Buffer),hh,n=>te.Buffer.from(n[0],"base64")),fh=30*1e3;function tm(n){if(/^https?:/.test(n)===!1)throw new TypeError("Endpoint URL must start with `http:` or `https:`.");return n}function Ue(n){let e,t;if(typeof n=="string")e=n;else if(n){const{commitment:r,...i}=n;e=r,t=i}return{commitment:e,config:t}}function Dc(n){return n.map(e=>"memcmp"in e?{...e,memcmp:{...e.memcmp,encoding:e.memcmp.encoding??"base58"}}:e)}function dh(n){return Ut([J({jsonrpc:je("2.0"),id:Q(),result:n}),J({jsonrpc:je("2.0"),id:Q(),error:J({code:Jn(),message:Q(),data:fe(_y())})})])}const rm=dh(Jn());function _e(n){return Ii(dh(n),rm,e=>"error"in e?e:{...e,result:ee(e.result,n)})}function tt(n){return _e(J({context:J({slot:H()}),value:n}))}function Cs(n){return J({context:J({slot:H()}),value:n})}function Io(n,e){return n===0?new yn({header:e.header,staticAccountKeys:e.accountKeys.map(t=>new j(t)),recentBlockhash:e.recentBlockhash,compiledInstructions:e.instructions.map(t=>({programIdIndex:t.programIdIndex,accountKeyIndexes:t.accounts,data:Et.decode(t.data)})),addressTableLookups:e.addressTableLookups}):new lr(e)}const nm=J({foundation:H(),foundationTerm:H(),initial:H(),taper:H(),terminal:H()}),im=_e(ie(se(J({epoch:H(),effectiveSlot:H(),amount:H(),postBalance:H(),commission:fe(se(H()))})))),sm=ie(J({slot:H(),prioritizationFee:H()})),om=J({total:H(),validator:H(),foundation:H(),epoch:H()}),am=J({epoch:H(),slotIndex:H(),slotsInEpoch:H(),absoluteSlot:H(),blockHeight:fe(H()),transactionCount:fe(H())}),cm=J({slotsPerEpoch:H(),leaderScheduleSlotOffset:H(),warmup:Er(),firstNormalEpoch:H(),firstNormalSlot:H()}),um=zl(Q(),ie(H())),bn=se(Ut([J({}),Q()])),lm=J({err:bn}),hm=je("receivedSignature"),fm=J({"solana-core":Q(),"feature-set":fe(H())}),dm=J({program:Q(),programId:Ze,parsed:Jn()}),pm=J({programId:Ze,accounts:ie(Ze),data:Q()}),Fc=tt(J({err:se(Ut([J({}),Q()])),logs:se(ie(Q())),accounts:fe(se(ie(se(J({executable:Er(),owner:Q(),lamports:H(),data:ie(Q()),rentEpoch:fe(H())}))))),unitsConsumed:fe(H()),returnData:fe(se(J({programId:Q(),data:xa([Q(),je("base64")])}))),innerInstructions:fe(se(ie(J({index:H(),instructions:ie(Ut([dm,pm]))}))))})),ym=tt(J({byIdentity:zl(Q(),ie(H())),range:J({firstSlot:H(),lastSlot:H()})}));function gm(n,e,t,r,i,s){const o=t||Zg;let a;s!=null&&console.warn("You have supplied an `httpAgent` when creating a `Connection` in a browser environment.It has been ignored; `httpAgent` is only used in Node environments.");let u;return r&&(u=async(f,_)=>{const I=await new Promise((g,v)=>{try{r(f,_,(x,A)=>g([x,A]))}catch(x){v(x)}});return await o(...I)}),new qy(async(f,_)=>{const I={method:"POST",body:f,agent:a,headers:Object.assign({"Content-Type":"application/json"},e||{},gw)};try{let g=5,v,x=500;for(;u?v=await u(n,I):v=await o(n,I),!(v.status!==429||i===!0||(g-=1,g===0));)console.error(`Server responded with ${v.status} ${v.statusText}.  Retrying after ${x}ms delay...`),await cn(x),x*=2;const A=await v.text();v.ok?_(null,A):_(new Error(`${v.status} ${v.statusText}: ${A}`))}catch(g){g instanceof Error&&_(g)}},{})}function mm(n){return(e,t)=>new Promise((r,i)=>{n.request(e,t,(s,o)=>{if(s){i(s);return}r(o)})})}function wm(n){return e=>new Promise((t,r)=>{e.length===0&&t([]);const i=e.map(s=>n.request(s.methodName,s.args));n.request(i,(s,o)=>{if(s){r(s);return}t(o)})})}const _m=_e(nm),bm=_e(om),Em=_e(sm),Rm=_e(am),Am=_e(cm),vm=_e(um),Sm=_e(H()),Im=tt(J({total:H(),circulating:H(),nonCirculating:H(),nonCirculatingAccounts:ie(Ze)})),Xo=J({amount:Q(),uiAmount:se(H()),decimals:H(),uiAmountString:fe(Q())}),km=tt(ie(J({address:Ze,amount:Q(),uiAmount:se(H()),decimals:H(),uiAmountString:fe(Q())}))),Tm=tt(ie(J({pubkey:Ze,account:J({executable:Er(),owner:Ze,lamports:H(),data:Fa,rentEpoch:H()})}))),Jo=J({program:Q(),parsed:Jn(),space:H()}),xm=tt(ie(J({pubkey:Ze,account:J({executable:Er(),owner:Ze,lamports:H(),data:Jo,rentEpoch:H()})}))),Om=tt(ie(J({lamports:H(),address:Ze}))),bi=J({executable:Er(),owner:Ze,lamports:H(),data:Fa,rentEpoch:H()}),Nm=J({pubkey:Ze,account:bi}),Cm=Ii(Ut([Ta(te.Buffer),Jo]),Ut([hh,Jo]),n=>Array.isArray(n)?ee(n,Fa):n),Qo=J({executable:Er(),owner:Ze,lamports:H(),data:Cm,rentEpoch:H()}),Bm=J({pubkey:Ze,account:Qo}),Mm=J({state:Ut([je("active"),je("inactive"),je("activating"),je("deactivating")]),active:H(),inactive:H()}),Lm=_e(ie(J({signature:Q(),slot:H(),err:bn,memo:se(Q()),blockTime:fe(se(H()))}))),Pm=_e(ie(J({signature:Q(),slot:H(),err:bn,memo:se(Q()),blockTime:fe(se(H()))}))),Um=J({subscription:H(),result:Cs(bi)}),Dm=J({pubkey:Ze,account:bi}),Fm=J({subscription:H(),result:Cs(Dm)}),Hm=J({parent:H(),slot:H(),root:H()}),zm=J({subscription:H(),result:Hm}),$m=Ut([J({type:Ut([je("firstShredReceived"),je("completed"),je("optimisticConfirmation"),je("root")]),slot:H(),timestamp:H()}),J({type:je("createdBank"),parent:H(),slot:H(),timestamp:H()}),J({type:je("frozen"),slot:H(),timestamp:H(),stats:J({numTransactionEntries:H(),numSuccessfulTransactions:H(),numFailedTransactions:H(),maxTransactionsPerEntry:H()})}),J({type:je("dead"),slot:H(),timestamp:H(),err:Q()})]),Km=J({subscription:H(),result:$m}),Wm=J({subscription:H(),result:Cs(Ut([lm,hm]))}),Gm=J({subscription:H(),result:H()}),qm=J({pubkey:Q(),gossip:se(Q()),tpu:se(Q()),rpc:se(Q()),version:se(Q())}),Hc=J({votePubkey:Q(),nodePubkey:Q(),activatedStake:H(),epochVoteAccount:Er(),epochCredits:ie(xa([H(),H(),H()])),commission:H(),lastVote:H(),rootSlot:se(H())}),Vm=_e(J({current:ie(Hc),delinquent:ie(Hc)})),jm=Ut([je("processed"),je("confirmed"),je("finalized")]),Zm=J({slot:H(),confirmations:se(H()),err:bn,confirmationStatus:fe(jm)}),Ym=tt(ie(se(Zm))),Xm=_e(H()),ph=J({accountKey:Ze,writableIndexes:ie(H()),readonlyIndexes:ie(H())}),Ha=J({signatures:ie(Q()),message:J({accountKeys:ie(Q()),header:J({numRequiredSignatures:H(),numReadonlySignedAccounts:H(),numReadonlyUnsignedAccounts:H()}),instructions:ie(J({accounts:ie(H()),data:Q(),programIdIndex:H()})),recentBlockhash:Q(),addressTableLookups:fe(ie(ph))})}),yh=J({pubkey:Ze,signer:Er(),writable:Er(),source:fe(Ut([je("transaction"),je("lookupTable")]))}),gh=J({accountKeys:ie(yh),signatures:ie(Q())}),mh=J({parsed:Jn(),program:Q(),programId:Ze}),wh=J({accounts:ie(Ze),data:Q(),programId:Ze}),Jm=Ut([wh,mh]),Qm=Ut([J({parsed:Jn(),program:Q(),programId:Q()}),J({accounts:ie(Q()),data:Q(),programId:Q()})]),_h=Ii(Jm,Qm,n=>"accounts"in n?ee(n,wh):ee(n,mh)),bh=J({signatures:ie(Q()),message:J({accountKeys:ie(yh),instructions:ie(_h),recentBlockhash:Q(),addressTableLookups:fe(se(ie(ph)))})}),hs=J({accountIndex:H(),mint:Q(),owner:fe(Q()),programId:fe(Q()),uiTokenAmount:Xo}),Eh=J({writable:ie(Ze),readonly:ie(Ze)}),Bs=J({err:bn,fee:H(),innerInstructions:fe(se(ie(J({index:H(),instructions:ie(J({accounts:ie(H()),data:Q(),programIdIndex:H()}))})))),preBalances:ie(H()),postBalances:ie(H()),logMessages:fe(se(ie(Q()))),preTokenBalances:fe(se(ie(hs))),postTokenBalances:fe(se(ie(hs))),loadedAddresses:fe(Eh),computeUnitsConsumed:fe(H())}),za=J({err:bn,fee:H(),innerInstructions:fe(se(ie(J({index:H(),instructions:ie(_h)})))),preBalances:ie(H()),postBalances:ie(H()),logMessages:fe(se(ie(Q()))),preTokenBalances:fe(se(ie(hs))),postTokenBalances:fe(se(ie(hs))),loadedAddresses:fe(Eh),computeUnitsConsumed:fe(H())}),Qn=Ut([je(0),je("legacy")]),En=J({pubkey:Q(),lamports:H(),postBalance:se(H()),rewardType:se(Q()),commission:fe(se(H()))}),ew=_e(se(J({blockhash:Q(),previousBlockhash:Q(),parentSlot:H(),transactions:ie(J({transaction:Ha,meta:se(Bs),version:fe(Qn)})),rewards:fe(ie(En)),blockTime:se(H()),blockHeight:se(H())}))),tw=_e(se(J({blockhash:Q(),previousBlockhash:Q(),parentSlot:H(),rewards:fe(ie(En)),blockTime:se(H()),blockHeight:se(H())}))),rw=_e(se(J({blockhash:Q(),previousBlockhash:Q(),parentSlot:H(),transactions:ie(J({transaction:gh,meta:se(Bs),version:fe(Qn)})),rewards:fe(ie(En)),blockTime:se(H()),blockHeight:se(H())}))),nw=_e(se(J({blockhash:Q(),previousBlockhash:Q(),parentSlot:H(),transactions:ie(J({transaction:bh,meta:se(za),version:fe(Qn)})),rewards:fe(ie(En)),blockTime:se(H()),blockHeight:se(H())}))),iw=_e(se(J({blockhash:Q(),previousBlockhash:Q(),parentSlot:H(),transactions:ie(J({transaction:gh,meta:se(za),version:fe(Qn)})),rewards:fe(ie(En)),blockTime:se(H()),blockHeight:se(H())}))),sw=_e(se(J({blockhash:Q(),previousBlockhash:Q(),parentSlot:H(),rewards:fe(ie(En)),blockTime:se(H()),blockHeight:se(H())}))),ow=_e(se(J({blockhash:Q(),previousBlockhash:Q(),parentSlot:H(),transactions:ie(J({transaction:Ha,meta:se(Bs)})),rewards:fe(ie(En)),blockTime:se(H())}))),zc=_e(se(J({blockhash:Q(),previousBlockhash:Q(),parentSlot:H(),signatures:ie(Q()),blockTime:se(H())}))),ko=_e(se(J({slot:H(),meta:se(Bs),blockTime:fe(se(H())),transaction:Ha,version:fe(Qn)}))),$i=_e(se(J({slot:H(),transaction:bh,meta:se(za),blockTime:fe(se(H())),version:fe(Qn)}))),aw=tt(J({blockhash:Q(),lastValidBlockHeight:H()})),cw=tt(Er()),uw=J({slot:H(),numTransactions:H(),numSlots:H(),samplePeriodSecs:H()}),lw=_e(ie(uw)),hw=tt(se(J({feeCalculator:J({lamportsPerSignature:H()})}))),fw=_e(Q()),dw=_e(Q()),pw=J({err:bn,logs:ie(Q()),signature:Q()}),yw=J({result:Cs(pw),subscription:H()}),gw={"solana-client":"js/1.0.0-maintenance"};class Rh{constructor(e,t){this._commitment=void 0,this._confirmTransactionInitialTimeout=void 0,this._rpcEndpoint=void 0,this._rpcWsEndpoint=void 0,this._rpcClient=void 0,this._rpcRequest=void 0,this._rpcBatchRequest=void 0,this._rpcWebSocket=void 0,this._rpcWebSocketConnected=!1,this._rpcWebSocketHeartbeat=null,this._rpcWebSocketIdleTimeout=null,this._rpcWebSocketGeneration=0,this._disableBlockhashCaching=!1,this._pollingBlockhash=!1,this._blockhashInfo={latestBlockhash:null,lastFetch:0,transactionSignatures:[],simulatedSignatures:[]},this._nextClientSubscriptionId=0,this._subscriptionDisposeFunctionsByClientSubscriptionId={},this._subscriptionHashByClientSubscriptionId={},this._subscriptionStateChangeCallbacksByHash={},this._subscriptionCallbacksByServerSubscriptionId={},this._subscriptionsByHash={},this._subscriptionsAutoDisposedByRpc=new Set,this.getBlockHeight=(()=>{const l={};return async f=>{const{commitment:_,config:I}=Ue(f),g=this._buildArgs([],_,void 0,I),v=Pc(g);return l[v]=l[v]??(async()=>{try{const x=await this._rpcRequest("getBlockHeight",g),A=ee(x,_e(H()));if("error"in A)throw new he(A.error,"failed to get block height information");return A.result}finally{delete l[v]}})(),await l[v]}})();let r,i,s,o,a,u;t&&typeof t=="string"?this._commitment=t:t&&(this._commitment=t.commitment,this._confirmTransactionInitialTimeout=t.confirmTransactionInitialTimeout,r=t.wsEndpoint,i=t.httpHeaders,s=t.fetch,o=t.fetchMiddleware,a=t.disableRetryOnRateLimit,u=t.httpAgent),this._rpcEndpoint=tm(e),this._rpcWsEndpoint=r||em(e),this._rpcClient=gm(e,i,s,o,a,u),this._rpcRequest=mm(this._rpcClient),this._rpcBatchRequest=wm(this._rpcClient),this._rpcWebSocket=new Yg(this._rpcWsEndpoint,{autoconnect:!1,max_reconnects:1/0}),this._rpcWebSocket.on("open",this._wsOnOpen.bind(this)),this._rpcWebSocket.on("error",this._wsOnError.bind(this)),this._rpcWebSocket.on("close",this._wsOnClose.bind(this)),this._rpcWebSocket.on("accountNotification",this._wsOnAccountNotification.bind(this)),this._rpcWebSocket.on("programNotification",this._wsOnProgramAccountNotification.bind(this)),this._rpcWebSocket.on("slotNotification",this._wsOnSlotNotification.bind(this)),this._rpcWebSocket.on("slotsUpdatesNotification",this._wsOnSlotUpdatesNotification.bind(this)),this._rpcWebSocket.on("signatureNotification",this._wsOnSignatureNotification.bind(this)),this._rpcWebSocket.on("rootNotification",this._wsOnRootNotification.bind(this)),this._rpcWebSocket.on("logsNotification",this._wsOnLogsNotification.bind(this))}get commitment(){return this._commitment}get rpcEndpoint(){return this._rpcEndpoint}async getBalanceAndContext(e,t){const{commitment:r,config:i}=Ue(t),s=this._buildArgs([e.toBase58()],r,void 0,i),o=await this._rpcRequest("getBalance",s),a=ee(o,tt(H()));if("error"in a)throw new he(a.error,`failed to get balance for ${e.toBase58()}`);return a.result}async getBalance(e,t){return await this.getBalanceAndContext(e,t).then(r=>r.value).catch(r=>{throw new Error("failed to get balance of account "+e.toBase58()+": "+r)})}async getBlockTime(e){const t=await this._rpcRequest("getBlockTime",[e]),r=ee(t,_e(se(H())));if("error"in r)throw new he(r.error,`failed to get block time for slot ${e}`);return r.result}async getMinimumLedgerSlot(){const e=await this._rpcRequest("minimumLedgerSlot",[]),t=ee(e,_e(H()));if("error"in t)throw new he(t.error,"failed to get minimum ledger slot");return t.result}async getFirstAvailableBlock(){const e=await this._rpcRequest("getFirstAvailableBlock",[]),t=ee(e,Sm);if("error"in t)throw new he(t.error,"failed to get first available block");return t.result}async getSupply(e){let t={};typeof e=="string"?t={commitment:e}:e?t={...e,commitment:e&&e.commitment||this.commitment}:t={commitment:this.commitment};const r=await this._rpcRequest("getSupply",[t]),i=ee(r,Im);if("error"in i)throw new he(i.error,"failed to get supply");return i.result}async getTokenSupply(e,t){const r=this._buildArgs([e.toBase58()],t),i=await this._rpcRequest("getTokenSupply",r),s=ee(i,tt(Xo));if("error"in s)throw new he(s.error,"failed to get token supply");return s.result}async getTokenAccountBalance(e,t){const r=this._buildArgs([e.toBase58()],t),i=await this._rpcRequest("getTokenAccountBalance",r),s=ee(i,tt(Xo));if("error"in s)throw new he(s.error,"failed to get token account balance");return s.result}async getTokenAccountsByOwner(e,t,r){const{commitment:i,config:s}=Ue(r);let o=[e.toBase58()];"mint"in t?o.push({mint:t.mint.toBase58()}):o.push({programId:t.programId.toBase58()});const a=this._buildArgs(o,i,"base64",s),u=await this._rpcRequest("getTokenAccountsByOwner",a),l=ee(u,Tm);if("error"in l)throw new he(l.error,`failed to get token accounts owned by account ${e.toBase58()}`);return l.result}async getParsedTokenAccountsByOwner(e,t,r){let i=[e.toBase58()];"mint"in t?i.push({mint:t.mint.toBase58()}):i.push({programId:t.programId.toBase58()});const s=this._buildArgs(i,r,"jsonParsed"),o=await this._rpcRequest("getTokenAccountsByOwner",s),a=ee(o,xm);if("error"in a)throw new he(a.error,`failed to get token accounts owned by account ${e.toBase58()}`);return a.result}async getLargestAccounts(e){const t={...e,commitment:e&&e.commitment||this.commitment},r=t.filter||t.commitment?[t]:[],i=await this._rpcRequest("getLargestAccounts",r),s=ee(i,Om);if("error"in s)throw new he(s.error,"failed to get largest accounts");return s.result}async getTokenLargestAccounts(e,t){const r=this._buildArgs([e.toBase58()],t),i=await this._rpcRequest("getTokenLargestAccounts",r),s=ee(i,km);if("error"in s)throw new he(s.error,"failed to get token largest accounts");return s.result}async getAccountInfoAndContext(e,t){const{commitment:r,config:i}=Ue(t),s=this._buildArgs([e.toBase58()],r,"base64",i),o=await this._rpcRequest("getAccountInfo",s),a=ee(o,tt(se(bi)));if("error"in a)throw new he(a.error,`failed to get info about account ${e.toBase58()}`);return a.result}async getParsedAccountInfo(e,t){const{commitment:r,config:i}=Ue(t),s=this._buildArgs([e.toBase58()],r,"jsonParsed",i),o=await this._rpcRequest("getAccountInfo",s),a=ee(o,tt(se(Qo)));if("error"in a)throw new he(a.error,`failed to get info about account ${e.toBase58()}`);return a.result}async getAccountInfo(e,t){try{return(await this.getAccountInfoAndContext(e,t)).value}catch(r){throw new Error("failed to get info about account "+e.toBase58()+": "+r)}}async getMultipleParsedAccounts(e,t){const{commitment:r,config:i}=Ue(t),s=e.map(l=>l.toBase58()),o=this._buildArgs([s],r,"jsonParsed",i),a=await this._rpcRequest("getMultipleAccounts",o),u=ee(a,tt(ie(se(Qo))));if("error"in u)throw new he(u.error,`failed to get info for accounts ${s}`);return u.result}async getMultipleAccountsInfoAndContext(e,t){const{commitment:r,config:i}=Ue(t),s=e.map(l=>l.toBase58()),o=this._buildArgs([s],r,"base64",i),a=await this._rpcRequest("getMultipleAccounts",o),u=ee(a,tt(ie(se(bi))));if("error"in u)throw new he(u.error,`failed to get info for accounts ${s}`);return u.result}async getMultipleAccountsInfo(e,t){return(await this.getMultipleAccountsInfoAndContext(e,t)).value}async getStakeActivation(e,t,r){const{commitment:i,config:s}=Ue(t),o=this._buildArgs([e.toBase58()],i,void 0,{...s,epoch:r??(s==null?void 0:s.epoch)}),a=await this._rpcRequest("getStakeActivation",o),u=ee(a,_e(Mm));if("error"in u)throw new he(u.error,`failed to get Stake Activation ${e.toBase58()}`);return u.result}async getProgramAccounts(e,t){const{commitment:r,config:i}=Ue(t),{encoding:s,...o}=i||{},a=this._buildArgs([e.toBase58()],r,s||"base64",{...o,...o.filters?{filters:Dc(o.filters)}:null}),u=await this._rpcRequest("getProgramAccounts",a),l=ie(Nm),f=o.withContext===!0?ee(u,tt(l)):ee(u,_e(l));if("error"in f)throw new he(f.error,`failed to get accounts owned by program ${e.toBase58()}`);return f.result}async getParsedProgramAccounts(e,t){const{commitment:r,config:i}=Ue(t),s=this._buildArgs([e.toBase58()],r,"jsonParsed",i),o=await this._rpcRequest("getProgramAccounts",s),a=ee(o,_e(ie(Bm)));if("error"in a)throw new he(a.error,`failed to get accounts owned by program ${e.toBase58()}`);return a.result}async confirmTransaction(e,t){var s;let r;if(typeof e=="string")r=e;else{const o=e;if((s=o.abortSignal)!=null&&s.aborted)return Promise.reject(o.abortSignal.reason);r=o.signature}let i;try{i=Et.decode(r)}catch{throw new Error("signature must be base58 encoded: "+r)}return Te(i.length===64,"signature has invalid length"),typeof e=="string"?await this.confirmTransactionUsingLegacyTimeoutStrategy({commitment:t||this.commitment,signature:r}):"lastValidBlockHeight"in e?await this.confirmTransactionUsingBlockHeightExceedanceStrategy({commitment:t||this.commitment,strategy:e}):await this.confirmTransactionUsingDurableNonceStrategy({commitment:t||this.commitment,strategy:e})}getCancellationPromise(e){return new Promise((t,r)=>{e!=null&&(e.aborted?r(e.reason):e.addEventListener("abort",()=>{r(e.reason)}))})}getTransactionConfirmationPromise({commitment:e,signature:t}){let r,i,s=!1;const o=new Promise((u,l)=>{try{r=this.onSignature(t,(_,I)=>{r=void 0;const g={context:I,value:_};u({__type:Nr.PROCESSED,response:g})},e);const f=new Promise(_=>{r==null?_():i=this._onSubscriptionStateChange(r,I=>{I==="subscribed"&&_()})});(async()=>{if(await f,s)return;const _=await this.getSignatureStatus(t);if(s||_==null)return;const{context:I,value:g}=_;if(g!=null)if(g!=null&&g.err)l(g.err);else{switch(e){case"confirmed":case"single":case"singleGossip":{if(g.confirmationStatus==="processed")return;break}case"finalized":case"max":case"root":{if(g.confirmationStatus==="processed"||g.confirmationStatus==="confirmed")return;break}case"processed":case"recent":}s=!0,u({__type:Nr.PROCESSED,response:{context:I,value:g}})}})()}catch(f){l(f)}});return{abortConfirmation:()=>{i&&(i(),i=void 0),r!=null&&(this.removeSignatureListener(r),r=void 0)},confirmationPromise:o}}async confirmTransactionUsingBlockHeightExceedanceStrategy({commitment:e,strategy:{abortSignal:t,lastValidBlockHeight:r,signature:i}}){let s=!1;const o=new Promise(_=>{const I=async()=>{try{return await this.getBlockHeight(e)}catch{return-1}};(async()=>{let g=await I();if(!s){for(;g<=r;)if(await cn(1e3),s||(g=await I(),s))return;_({__type:Nr.BLOCKHEIGHT_EXCEEDED})}})()}),{abortConfirmation:a,confirmationPromise:u}=this.getTransactionConfirmationPromise({commitment:e,signature:i}),l=this.getCancellationPromise(t);let f;try{const _=await Promise.race([l,u,o]);if(_.__type===Nr.PROCESSED)f=_.response;else throw new Ma(i)}finally{s=!0,a()}return f}async confirmTransactionUsingDurableNonceStrategy({commitment:e,strategy:{abortSignal:t,minContextSlot:r,nonceAccountPubkey:i,nonceValue:s,signature:o}}){let a=!1;const u=new Promise(g=>{let v=s,x=null;const A=async()=>{try{const{context:N,value:K}=await this.getNonceAndContext(i,{commitment:e,minContextSlot:r});return x=N.slot,K==null?void 0:K.nonce}catch{return v}};(async()=>{if(v=await A(),!a)for(;;){if(s!==v){g({__type:Nr.NONCE_INVALID,slotInWhichNonceDidAdvance:x});return}if(await cn(2e3),a||(v=await A(),a))return}})()}),{abortConfirmation:l,confirmationPromise:f}=this.getTransactionConfirmationPromise({commitment:e,signature:o}),_=this.getCancellationPromise(t);let I;try{const g=await Promise.race([_,f,u]);if(g.__type===Nr.PROCESSED)I=g.response;else{let v;for(;;){const x=await this.getSignatureStatus(o);if(x==null)break;if(x.context.slot<(g.slotInWhichNonceDidAdvance??r)){await cn(400);continue}v=x;break}if(v!=null&&v.value){const x=e||"finalized",{confirmationStatus:A}=v.value;switch(x){case"processed":case"recent":if(A!=="processed"&&A!=="confirmed"&&A!=="finalized")throw new Bn(o);break;case"confirmed":case"single":case"singleGossip":if(A!=="confirmed"&&A!=="finalized")throw new Bn(o);break;case"finalized":case"max":case"root":if(A!=="finalized")throw new Bn(o);break;default:}I={context:v.context,value:{err:v.value.err}}}else throw new Bn(o)}}finally{a=!0,l()}return I}async confirmTransactionUsingLegacyTimeoutStrategy({commitment:e,signature:t}){let r;const i=new Promise(u=>{let l=this._confirmTransactionInitialTimeout||6e4;switch(e){case"processed":case"recent":case"single":case"confirmed":case"singleGossip":{l=this._confirmTransactionInitialTimeout||3e4;break}}r=setTimeout(()=>u({__type:Nr.TIMED_OUT,timeoutMs:l}),l)}),{abortConfirmation:s,confirmationPromise:o}=this.getTransactionConfirmationPromise({commitment:e,signature:t});let a;try{const u=await Promise.race([o,i]);if(u.__type===Nr.PROCESSED)a=u.response;else throw new La(t,u.timeoutMs/1e3)}finally{clearTimeout(r),s()}return a}async getClusterNodes(){const e=await this._rpcRequest("getClusterNodes",[]),t=ee(e,_e(ie(qm)));if("error"in t)throw new he(t.error,"failed to get cluster nodes");return t.result}async getVoteAccounts(e){const t=this._buildArgs([],e),r=await this._rpcRequest("getVoteAccounts",t),i=ee(r,Vm);if("error"in i)throw new he(i.error,"failed to get vote accounts");return i.result}async getSlot(e){const{commitment:t,config:r}=Ue(e),i=this._buildArgs([],t,void 0,r),s=await this._rpcRequest("getSlot",i),o=ee(s,_e(H()));if("error"in o)throw new he(o.error,"failed to get slot");return o.result}async getSlotLeader(e){const{commitment:t,config:r}=Ue(e),i=this._buildArgs([],t,void 0,r),s=await this._rpcRequest("getSlotLeader",i),o=ee(s,_e(Q()));if("error"in o)throw new he(o.error,"failed to get slot leader");return o.result}async getSlotLeaders(e,t){const r=[e,t],i=await this._rpcRequest("getSlotLeaders",r),s=ee(i,_e(ie(Ze)));if("error"in s)throw new he(s.error,"failed to get slot leaders");return s.result}async getSignatureStatus(e,t){const{context:r,value:i}=await this.getSignatureStatuses([e],t);Te(i.length===1);const s=i[0];return{context:r,value:s}}async getSignatureStatuses(e,t){const r=[e];t&&r.push(t);const i=await this._rpcRequest("getSignatureStatuses",r),s=ee(i,Ym);if("error"in s)throw new he(s.error,"failed to get signature status");return s.result}async getTransactionCount(e){const{commitment:t,config:r}=Ue(e),i=this._buildArgs([],t,void 0,r),s=await this._rpcRequest("getTransactionCount",i),o=ee(s,_e(H()));if("error"in o)throw new he(o.error,"failed to get transaction count");return o.result}async getTotalSupply(e){return(await this.getSupply({commitment:e,excludeNonCirculatingAccountsList:!0})).value.total}async getInflationGovernor(e){const t=this._buildArgs([],e),r=await this._rpcRequest("getInflationGovernor",t),i=ee(r,_m);if("error"in i)throw new he(i.error,"failed to get inflation");return i.result}async getInflationReward(e,t,r){const{commitment:i,config:s}=Ue(r),o=this._buildArgs([e.map(l=>l.toBase58())],i,void 0,{...s,epoch:t??(s==null?void 0:s.epoch)}),a=await this._rpcRequest("getInflationReward",o),u=ee(a,im);if("error"in u)throw new he(u.error,"failed to get inflation reward");return u.result}async getInflationRate(){const e=await this._rpcRequest("getInflationRate",[]),t=ee(e,bm);if("error"in t)throw new he(t.error,"failed to get inflation rate");return t.result}async getEpochInfo(e){const{commitment:t,config:r}=Ue(e),i=this._buildArgs([],t,void 0,r),s=await this._rpcRequest("getEpochInfo",i),o=ee(s,Rm);if("error"in o)throw new he(o.error,"failed to get epoch info");return o.result}async getEpochSchedule(){const e=await this._rpcRequest("getEpochSchedule",[]),t=ee(e,Am);if("error"in t)throw new he(t.error,"failed to get epoch schedule");const r=t.result;return new lh(r.slotsPerEpoch,r.leaderScheduleSlotOffset,r.warmup,r.firstNormalEpoch,r.firstNormalSlot)}async getLeaderSchedule(){const e=await this._rpcRequest("getLeaderSchedule",[]),t=ee(e,vm);if("error"in t)throw new he(t.error,"failed to get leader schedule");return t.result}async getMinimumBalanceForRentExemption(e,t){const r=this._buildArgs([e],t),i=await this._rpcRequest("getMinimumBalanceForRentExemption",r),s=ee(i,Xm);return"error"in s?(console.warn("Unable to fetch minimum balance for rent exemption"),0):s.result}async getRecentBlockhashAndContext(e){const{context:t,value:{blockhash:r}}=await this.getLatestBlockhashAndContext(e);return{context:t,value:{blockhash:r,feeCalculator:{get lamportsPerSignature(){throw new Error("The capability to fetch `lamportsPerSignature` using the `getRecentBlockhash` API is no longer offered by the network. Use the `getFeeForMessage` API to obtain the fee for a given message.")},toJSON(){return{}}}}}}async getRecentPerformanceSamples(e){const t=await this._rpcRequest("getRecentPerformanceSamples",e?[e]:[]),r=ee(t,lw);if("error"in r)throw new he(r.error,"failed to get recent performance samples");return r.result}async getFeeCalculatorForBlockhash(e,t){const r=this._buildArgs([e],t),i=await this._rpcRequest("getFeeCalculatorForBlockhash",r),s=ee(i,hw);if("error"in s)throw new he(s.error,"failed to get fee calculator");const{context:o,value:a}=s.result;return{context:o,value:a!==null?a.feeCalculator:null}}async getFeeForMessage(e,t){const r=be(e.serialize()).toString("base64"),i=this._buildArgs([r],t),s=await this._rpcRequest("getFeeForMessage",i),o=ee(s,tt(se(H())));if("error"in o)throw new he(o.error,"failed to get fee for message");if(o.result===null)throw new Error("invalid blockhash");return o.result}async getRecentPrioritizationFees(e){var o;const t=(o=e==null?void 0:e.lockedWritableAccounts)==null?void 0:o.map(a=>a.toBase58()),r=t!=null&&t.length?[t]:[],i=await this._rpcRequest("getRecentPrioritizationFees",r),s=ee(i,Em);if("error"in s)throw new he(s.error,"failed to get recent prioritization fees");return s.result}async getRecentBlockhash(e){try{return(await this.getRecentBlockhashAndContext(e)).value}catch(t){throw new Error("failed to get recent blockhash: "+t)}}async getLatestBlockhash(e){try{return(await this.getLatestBlockhashAndContext(e)).value}catch(t){throw new Error("failed to get recent blockhash: "+t)}}async getLatestBlockhashAndContext(e){const{commitment:t,config:r}=Ue(e),i=this._buildArgs([],t,void 0,r),s=await this._rpcRequest("getLatestBlockhash",i),o=ee(s,aw);if("error"in o)throw new he(o.error,"failed to get latest blockhash");return o.result}async isBlockhashValid(e,t){const{commitment:r,config:i}=Ue(t),s=this._buildArgs([e],r,void 0,i),o=await this._rpcRequest("isBlockhashValid",s),a=ee(o,cw);if("error"in a)throw new he(a.error,"failed to determine if the blockhash `"+e+"`is valid");return a.result}async getVersion(){const e=await this._rpcRequest("getVersion",[]),t=ee(e,_e(fm));if("error"in t)throw new he(t.error,"failed to get version");return t.result}async getGenesisHash(){const e=await this._rpcRequest("getGenesisHash",[]),t=ee(e,_e(Q()));if("error"in t)throw new he(t.error,"failed to get genesis hash");return t.result}async getBlock(e,t){const{commitment:r,config:i}=Ue(t),s=this._buildArgsAtLeastConfirmed([e],r,void 0,i),o=await this._rpcRequest("getBlock",s);try{switch(i==null?void 0:i.transactionDetails){case"accounts":{const a=ee(o,rw);if("error"in a)throw a.error;return a.result}case"none":{const a=ee(o,tw);if("error"in a)throw a.error;return a.result}default:{const a=ee(o,ew);if("error"in a)throw a.error;const{result:u}=a;return u?{...u,transactions:u.transactions.map(({transaction:l,meta:f,version:_})=>({meta:f,transaction:{...l,message:Io(_,l.message)},version:_}))}:null}}}catch(a){throw new he(a,"failed to get confirmed block")}}async getParsedBlock(e,t){const{commitment:r,config:i}=Ue(t),s=this._buildArgsAtLeastConfirmed([e],r,"jsonParsed",i),o=await this._rpcRequest("getBlock",s);try{switch(i==null?void 0:i.transactionDetails){case"accounts":{const a=ee(o,iw);if("error"in a)throw a.error;return a.result}case"none":{const a=ee(o,sw);if("error"in a)throw a.error;return a.result}default:{const a=ee(o,nw);if("error"in a)throw a.error;return a.result}}}catch(a){throw new he(a,"failed to get block")}}async getBlockProduction(e){let t,r;if(typeof e=="string")r=e;else if(e){const{commitment:a,...u}=e;r=a,t=u}const i=this._buildArgs([],r,"base64",t),s=await this._rpcRequest("getBlockProduction",i),o=ee(s,ym);if("error"in o)throw new he(o.error,"failed to get block production information");return o.result}async getTransaction(e,t){const{commitment:r,config:i}=Ue(t),s=this._buildArgsAtLeastConfirmed([e],r,void 0,i),o=await this._rpcRequest("getTransaction",s),a=ee(o,ko);if("error"in a)throw new he(a.error,"failed to get transaction");const u=a.result;return u&&{...u,transaction:{...u.transaction,message:Io(u.version,u.transaction.message)}}}async getParsedTransaction(e,t){const{commitment:r,config:i}=Ue(t),s=this._buildArgsAtLeastConfirmed([e],r,"jsonParsed",i),o=await this._rpcRequest("getTransaction",s),a=ee(o,$i);if("error"in a)throw new he(a.error,"failed to get transaction");return a.result}async getParsedTransactions(e,t){const{commitment:r,config:i}=Ue(t),s=e.map(u=>({methodName:"getTransaction",args:this._buildArgsAtLeastConfirmed([u],r,"jsonParsed",i)}));return(await this._rpcBatchRequest(s)).map(u=>{const l=ee(u,$i);if("error"in l)throw new he(l.error,"failed to get transactions");return l.result})}async getTransactions(e,t){const{commitment:r,config:i}=Ue(t),s=e.map(u=>({methodName:"getTransaction",args:this._buildArgsAtLeastConfirmed([u],r,void 0,i)}));return(await this._rpcBatchRequest(s)).map(u=>{const l=ee(u,ko);if("error"in l)throw new he(l.error,"failed to get transactions");const f=l.result;return f&&{...f,transaction:{...f.transaction,message:Io(f.version,f.transaction.message)}}})}async getConfirmedBlock(e,t){const r=this._buildArgsAtLeastConfirmed([e],t),i=await this._rpcRequest("getBlock",r),s=ee(i,ow);if("error"in s)throw new he(s.error,"failed to get confirmed block");const o=s.result;if(!o)throw new Error("Confirmed block "+e+" not found");const a={...o,transactions:o.transactions.map(({transaction:u,meta:l})=>{const f=new lr(u.message);return{meta:l,transaction:{...u,message:f}}})};return{...a,transactions:a.transactions.map(({transaction:u,meta:l})=>({meta:l,transaction:ke.populate(u.message,u.signatures)}))}}async getBlocks(e,t,r){const i=this._buildArgsAtLeastConfirmed(t!==void 0?[e,t]:[e],r),s=await this._rpcRequest("getBlocks",i),o=ee(s,_e(ie(H())));if("error"in o)throw new he(o.error,"failed to get blocks");return o.result}async getBlockSignatures(e,t){const r=this._buildArgsAtLeastConfirmed([e],t,void 0,{transactionDetails:"signatures",rewards:!1}),i=await this._rpcRequest("getBlock",r),s=ee(i,zc);if("error"in s)throw new he(s.error,"failed to get block");const o=s.result;if(!o)throw new Error("Block "+e+" not found");return o}async getConfirmedBlockSignatures(e,t){const r=this._buildArgsAtLeastConfirmed([e],t,void 0,{transactionDetails:"signatures",rewards:!1}),i=await this._rpcRequest("getBlock",r),s=ee(i,zc);if("error"in s)throw new he(s.error,"failed to get confirmed block");const o=s.result;if(!o)throw new Error("Confirmed block "+e+" not found");return o}async getConfirmedTransaction(e,t){const r=this._buildArgsAtLeastConfirmed([e],t),i=await this._rpcRequest("getTransaction",r),s=ee(i,ko);if("error"in s)throw new he(s.error,"failed to get transaction");const o=s.result;if(!o)return o;const a=new lr(o.transaction.message),u=o.transaction.signatures;return{...o,transaction:ke.populate(a,u)}}async getParsedConfirmedTransaction(e,t){const r=this._buildArgsAtLeastConfirmed([e],t,"jsonParsed"),i=await this._rpcRequest("getTransaction",r),s=ee(i,$i);if("error"in s)throw new he(s.error,"failed to get confirmed transaction");return s.result}async getParsedConfirmedTransactions(e,t){const r=e.map(o=>({methodName:"getTransaction",args:this._buildArgsAtLeastConfirmed([o],t,"jsonParsed")}));return(await this._rpcBatchRequest(r)).map(o=>{const a=ee(o,$i);if("error"in a)throw new he(a.error,"failed to get confirmed transactions");return a.result})}async getConfirmedSignaturesForAddress(e,t,r){let i={},s=await this.getFirstAvailableBlock();for(;!("until"in i)&&(t--,!(t<=0||t<s));)try{const u=await this.getConfirmedBlockSignatures(t,"finalized");u.signatures.length>0&&(i.until=u.signatures[u.signatures.length-1].toString())}catch(u){if(u instanceof Error&&u.message.includes("skipped"))continue;throw u}let o=await this.getSlot("finalized");for(;!("before"in i)&&(r++,!(r>o));)try{const u=await this.getConfirmedBlockSignatures(r);u.signatures.length>0&&(i.before=u.signatures[u.signatures.length-1].toString())}catch(u){if(u instanceof Error&&u.message.includes("skipped"))continue;throw u}return(await this.getConfirmedSignaturesForAddress2(e,i)).map(u=>u.signature)}async getConfirmedSignaturesForAddress2(e,t,r){const i=this._buildArgsAtLeastConfirmed([e.toBase58()],r,void 0,t),s=await this._rpcRequest("getConfirmedSignaturesForAddress2",i),o=ee(s,Lm);if("error"in o)throw new he(o.error,"failed to get confirmed signatures for address");return o.result}async getSignaturesForAddress(e,t,r){const i=this._buildArgsAtLeastConfirmed([e.toBase58()],r,void 0,t),s=await this._rpcRequest("getSignaturesForAddress",i),o=ee(s,Pm);if("error"in o)throw new he(o.error,"failed to get signatures for address");return o.result}async getAddressLookupTable(e,t){const{context:r,value:i}=await this.getAccountInfoAndContext(e,t);let s=null;return i!==null&&(s=new Yo({key:e,state:Yo.deserialize(i.data)})),{context:r,value:s}}async getNonceAndContext(e,t){const{context:r,value:i}=await this.getAccountInfoAndContext(e,t);let s=null;return i!==null&&(s=Ns.fromAccountData(i.data)),{context:r,value:s}}async getNonce(e,t){return await this.getNonceAndContext(e,t).then(r=>r.value).catch(r=>{throw new Error("failed to get nonce for account "+e.toBase58()+": "+r)})}async requestAirdrop(e,t){const r=await this._rpcRequest("requestAirdrop",[e.toBase58(),t]),i=ee(r,fw);if("error"in i)throw new he(i.error,`airdrop to ${e.toBase58()} failed`);return i.result}async _blockhashWithExpiryBlockHeight(e){if(!e){for(;this._pollingBlockhash;)await cn(100);const r=Date.now()-this._blockhashInfo.lastFetch>=fh;if(this._blockhashInfo.latestBlockhash!==null&&!r)return this._blockhashInfo.latestBlockhash}return await this._pollNewBlockhash()}async _pollNewBlockhash(){this._pollingBlockhash=!0;try{const e=Date.now(),t=this._blockhashInfo.latestBlockhash,r=t?t.blockhash:null;for(let i=0;i<50;i++){const s=await this.getLatestBlockhash("finalized");if(r!==s.blockhash)return this._blockhashInfo={latestBlockhash:s,lastFetch:Date.now(),transactionSignatures:[],simulatedSignatures:[]},s;await cn(ah/2)}throw new Error(`Unable to obtain a new blockhash after ${Date.now()-e}ms`)}finally{this._pollingBlockhash=!1}}async getStakeMinimumDelegation(e){const{commitment:t,config:r}=Ue(e),i=this._buildArgs([],t,"base64",r),s=await this._rpcRequest("getStakeMinimumDelegation",i),o=ee(s,tt(H()));if("error"in o)throw new he(o.error,"failed to get stake minimum delegation");return o.result}async simulateTransaction(e,t,r){if("message"in e){const x=e.serialize(),A=te.Buffer.from(x).toString("base64");if(Array.isArray(t)||r!==void 0)throw new Error("Invalid arguments");const N=t||{};N.encoding="base64","commitment"in N||(N.commitment=this.commitment),t&&typeof t=="object"&&"innerInstructions"in t&&(N.innerInstructions=t.innerInstructions);const K=[A,N],P=await this._rpcRequest("simulateTransaction",K),$=ee(P,Fc);if("error"in $)throw new Error("failed to simulate transaction: "+$.error.message);return $.result}let i;if(e instanceof ke){let v=e;i=new ke,i.feePayer=v.feePayer,i.instructions=e.instructions,i.nonceInfo=v.nonceInfo,i.signatures=v.signatures}else i=ke.populate(e),i._message=i._json=void 0;if(t!==void 0&&!Array.isArray(t))throw new Error("Invalid arguments");const s=t;if(i.nonceInfo&&s)i.sign(...s);else{let v=this._disableBlockhashCaching;for(;;){const x=await this._blockhashWithExpiryBlockHeight(v);if(i.lastValidBlockHeight=x.lastValidBlockHeight,i.recentBlockhash=x.blockhash,!s)break;if(i.sign(...s),!i.signature)throw new Error("!signature");const A=i.signature.toString("base64");if(!this._blockhashInfo.simulatedSignatures.includes(A)&&!this._blockhashInfo.transactionSignatures.includes(A)){this._blockhashInfo.simulatedSignatures.push(A);break}else v=!0}}const o=i._compile(),a=o.serialize(),l=i._serialize(a).toString("base64"),f={encoding:"base64",commitment:this.commitment};if(r){const v=(Array.isArray(r)?r:o.nonProgramIds()).map(x=>x.toBase58());f.accounts={encoding:"base64",addresses:v}}s&&(f.sigVerify=!0),t&&typeof t=="object"&&"innerInstructions"in t&&(f.innerInstructions=t.innerInstructions);const _=[l,f],I=await this._rpcRequest("simulateTransaction",_),g=ee(I,Fc);if("error"in g){let v;if("data"in g.error&&(v=g.error.data.logs,v&&Array.isArray(v))){const x=`
    `,A=x+v.join(x);console.error(g.error.message,A)}throw new tn({action:"simulate",signature:"",transactionMessage:g.error.message,logs:v})}return g.result}async sendTransaction(e,t,r){if("version"in e){if(t&&Array.isArray(t))throw new Error("Invalid arguments");const o=e.serialize();return await this.sendRawTransaction(o,t)}if(t===void 0||!Array.isArray(t))throw new Error("Invalid arguments");const i=t;if(e.nonceInfo)e.sign(...i);else{let o=this._disableBlockhashCaching;for(;;){const a=await this._blockhashWithExpiryBlockHeight(o);if(e.lastValidBlockHeight=a.lastValidBlockHeight,e.recentBlockhash=a.blockhash,e.sign(...i),!e.signature)throw new Error("!signature");const u=e.signature.toString("base64");if(this._blockhashInfo.transactionSignatures.includes(u))o=!0;else{this._blockhashInfo.transactionSignatures.push(u);break}}}const s=e.serialize();return await this.sendRawTransaction(s,r)}async sendRawTransaction(e,t){const r=be(e).toString("base64");return await this.sendEncodedTransaction(r,t)}async sendEncodedTransaction(e,t){const r={encoding:"base64"},i=t&&t.skipPreflight,s=i===!0?"processed":t&&t.preflightCommitment||this.commitment;t&&t.maxRetries!=null&&(r.maxRetries=t.maxRetries),t&&t.minContextSlot!=null&&(r.minContextSlot=t.minContextSlot),i&&(r.skipPreflight=i),s&&(r.preflightCommitment=s);const o=[e,r],a=await this._rpcRequest("sendTransaction",o),u=ee(a,dw);if("error"in u){let l;throw"data"in u.error&&(l=u.error.data.logs),new tn({action:i?"send":"simulate",signature:"",transactionMessage:u.error.message,logs:l})}return u.result}_wsOnOpen(){this._rpcWebSocketConnected=!0,this._rpcWebSocketHeartbeat=setInterval(()=>{(async()=>{try{await this._rpcWebSocket.notify("ping")}catch{}})()},5e3),this._updateSubscriptions()}_wsOnError(e){this._rpcWebSocketConnected=!1,console.error("ws error:",e.message)}_wsOnClose(e){if(this._rpcWebSocketConnected=!1,this._rpcWebSocketGeneration=(this._rpcWebSocketGeneration+1)%Number.MAX_SAFE_INTEGER,this._rpcWebSocketIdleTimeout&&(clearTimeout(this._rpcWebSocketIdleTimeout),this._rpcWebSocketIdleTimeout=null),this._rpcWebSocketHeartbeat&&(clearInterval(this._rpcWebSocketHeartbeat),this._rpcWebSocketHeartbeat=null),e===1e3){this._updateSubscriptions();return}this._subscriptionCallbacksByServerSubscriptionId={},Object.entries(this._subscriptionsByHash).forEach(([t,r])=>{this._setSubscription(t,{...r,state:"pending"})})}_setSubscription(e,t){var i;const r=(i=this._subscriptionsByHash[e])==null?void 0:i.state;if(this._subscriptionsByHash[e]=t,r!==t.state){const s=this._subscriptionStateChangeCallbacksByHash[e];s&&s.forEach(o=>{try{o(t.state)}catch{}})}}_onSubscriptionStateChange(e,t){var s;const r=this._subscriptionHashByClientSubscriptionId[e];if(r==null)return()=>{};const i=(s=this._subscriptionStateChangeCallbacksByHash)[r]||(s[r]=new Set);return i.add(t),()=>{i.delete(t),i.size===0&&delete this._subscriptionStateChangeCallbacksByHash[r]}}async _updateSubscriptions(){if(Object.keys(this._subscriptionsByHash).length===0){this._rpcWebSocketConnected&&(this._rpcWebSocketConnected=!1,this._rpcWebSocketIdleTimeout=setTimeout(()=>{this._rpcWebSocketIdleTimeout=null;try{this._rpcWebSocket.close()}catch(r){r instanceof Error&&console.log(`Error when closing socket connection: ${r.message}`)}},500));return}if(this._rpcWebSocketIdleTimeout!==null&&(clearTimeout(this._rpcWebSocketIdleTimeout),this._rpcWebSocketIdleTimeout=null,this._rpcWebSocketConnected=!0),!this._rpcWebSocketConnected){this._rpcWebSocket.connect();return}const e=this._rpcWebSocketGeneration,t=()=>e===this._rpcWebSocketGeneration;await Promise.all(Object.keys(this._subscriptionsByHash).map(async r=>{const i=this._subscriptionsByHash[r];if(i!==void 0)switch(i.state){case"pending":case"unsubscribed":if(i.callbacks.size===0){delete this._subscriptionsByHash[r],i.state==="unsubscribed"&&delete this._subscriptionCallbacksByServerSubscriptionId[i.serverSubscriptionId],await this._updateSubscriptions();return}await(async()=>{const{args:s,method:o}=i;try{this._setSubscription(r,{...i,state:"subscribing"});const a=await this._rpcWebSocket.call(o,s);this._setSubscription(r,{...i,serverSubscriptionId:a,state:"subscribed"}),this._subscriptionCallbacksByServerSubscriptionId[a]=i.callbacks,await this._updateSubscriptions()}catch(a){if(console.error(`Received ${a instanceof Error?"":"JSON-RPC "}error calling \`${o}\``,{args:s,error:a}),!t())return;this._setSubscription(r,{...i,state:"pending"}),await this._updateSubscriptions()}})();break;case"subscribed":i.callbacks.size===0&&await(async()=>{const{serverSubscriptionId:s,unsubscribeMethod:o}=i;if(this._subscriptionsAutoDisposedByRpc.has(s))this._subscriptionsAutoDisposedByRpc.delete(s);else{this._setSubscription(r,{...i,state:"unsubscribing"}),this._setSubscription(r,{...i,state:"unsubscribing"});try{await this._rpcWebSocket.call(o,[s])}catch(a){if(a instanceof Error&&console.error(`${o} error:`,a.message),!t())return;this._setSubscription(r,{...i,state:"subscribed"}),await this._updateSubscriptions();return}}this._setSubscription(r,{...i,state:"unsubscribed"}),await this._updateSubscriptions()})();break}}))}_handleServerNotification(e,t){const r=this._subscriptionCallbacksByServerSubscriptionId[e];r!==void 0&&r.forEach(i=>{try{i(...t)}catch(s){console.error(s)}})}_wsOnAccountNotification(e){const{result:t,subscription:r}=ee(e,Um);this._handleServerNotification(r,[t.value,t.context])}_makeSubscription(e,t){const r=this._nextClientSubscriptionId++,i=Pc([e.method,t]),s=this._subscriptionsByHash[i];return s===void 0?this._subscriptionsByHash[i]={...e,args:t,callbacks:new Set([e.callback]),state:"pending"}:s.callbacks.add(e.callback),this._subscriptionHashByClientSubscriptionId[r]=i,this._subscriptionDisposeFunctionsByClientSubscriptionId[r]=async()=>{delete this._subscriptionDisposeFunctionsByClientSubscriptionId[r],delete this._subscriptionHashByClientSubscriptionId[r];const o=this._subscriptionsByHash[i];Te(o!==void 0,`Could not find a \`Subscription\` when tearing down client subscription #${r}`),o.callbacks.delete(e.callback),await this._updateSubscriptions()},this._updateSubscriptions(),r}onAccountChange(e,t,r){const{commitment:i,config:s}=Ue(r),o=this._buildArgs([e.toBase58()],i||this._commitment||"finalized","base64",s);return this._makeSubscription({callback:t,method:"accountSubscribe",unsubscribeMethod:"accountUnsubscribe"},o)}async removeAccountChangeListener(e){await this._unsubscribeClientSubscription(e,"account change")}_wsOnProgramAccountNotification(e){const{result:t,subscription:r}=ee(e,Fm);this._handleServerNotification(r,[{accountId:t.value.pubkey,accountInfo:t.value.account},t.context])}onProgramAccountChange(e,t,r,i){const{commitment:s,config:o}=Ue(r),a=this._buildArgs([e.toBase58()],s||this._commitment||"finalized","base64",o||(i?{filters:Dc(i)}:void 0));return this._makeSubscription({callback:t,method:"programSubscribe",unsubscribeMethod:"programUnsubscribe"},a)}async removeProgramAccountChangeListener(e){await this._unsubscribeClientSubscription(e,"program account change")}onLogs(e,t,r){const i=this._buildArgs([typeof e=="object"?{mentions:[e.toString()]}:e],r||this._commitment||"finalized");return this._makeSubscription({callback:t,method:"logsSubscribe",unsubscribeMethod:"logsUnsubscribe"},i)}async removeOnLogsListener(e){await this._unsubscribeClientSubscription(e,"logs")}_wsOnLogsNotification(e){const{result:t,subscription:r}=ee(e,yw);this._handleServerNotification(r,[t.value,t.context])}_wsOnSlotNotification(e){const{result:t,subscription:r}=ee(e,zm);this._handleServerNotification(r,[t])}onSlotChange(e){return this._makeSubscription({callback:e,method:"slotSubscribe",unsubscribeMethod:"slotUnsubscribe"},[])}async removeSlotChangeListener(e){await this._unsubscribeClientSubscription(e,"slot change")}_wsOnSlotUpdatesNotification(e){const{result:t,subscription:r}=ee(e,Km);this._handleServerNotification(r,[t])}onSlotUpdate(e){return this._makeSubscription({callback:e,method:"slotsUpdatesSubscribe",unsubscribeMethod:"slotsUpdatesUnsubscribe"},[])}async removeSlotUpdateListener(e){await this._unsubscribeClientSubscription(e,"slot update")}async _unsubscribeClientSubscription(e,t){const r=this._subscriptionDisposeFunctionsByClientSubscriptionId[e];r?await r():console.warn(`Ignored unsubscribe request because an active subscription with id \`${e}\` for '${t}' events could not be found.`)}_buildArgs(e,t,r,i){const s=t||this._commitment;if(s||r||i){let o={};r&&(o.encoding=r),s&&(o.commitment=s),i&&(o=Object.assign(o,i)),e.push(o)}return e}_buildArgsAtLeastConfirmed(e,t,r,i){const s=t||this._commitment;if(s&&!["confirmed","finalized"].includes(s))throw new Error("Using Connection with default commitment: `"+this._commitment+"`, but method requires at least `confirmed`");return this._buildArgs(e,t,r,i)}_wsOnSignatureNotification(e){const{result:t,subscription:r}=ee(e,Wm);t.value!=="receivedSignature"&&this._subscriptionsAutoDisposedByRpc.add(r),this._handleServerNotification(r,t.value==="receivedSignature"?[{type:"received"},t.context]:[{type:"status",result:t.value},t.context])}onSignature(e,t,r){const i=this._buildArgs([e],r||this._commitment||"finalized"),s=this._makeSubscription({callback:(o,a)=>{if(o.type==="status"){t(o.result,a);try{this.removeSignatureListener(s)}catch{}}},method:"signatureSubscribe",unsubscribeMethod:"signatureUnsubscribe"},i);return s}onSignatureWithOptions(e,t,r){const{commitment:i,...s}={...r,commitment:r&&r.commitment||this._commitment||"finalized"},o=this._buildArgs([e],i,void 0,s),a=this._makeSubscription({callback:(u,l)=>{t(u,l);try{this.removeSignatureListener(a)}catch{}},method:"signatureSubscribe",unsubscribeMethod:"signatureUnsubscribe"},o);return a}async removeSignatureListener(e){await this._unsubscribeClientSubscription(e,"signature result")}_wsOnRootNotification(e){const{result:t,subscription:r}=ee(e,Gm);this._handleServerNotification(r,[t])}onRootChange(e){return this._makeSubscription({callback:e,method:"rootSubscribe",unsubscribeMethod:"rootUnsubscribe"},[])}async removeRootChangeListener(e){await this._unsubscribeClientSubscription(e,"root change")}}class Pn{constructor(e){this._keypair=void 0,this._keypair=e??Cc()}static generate(){return new Pn(Cc())}static fromSecretKey(e,t){if(e.byteLength!==64)throw new Error("bad secret key size");const r=e.slice(32,64);if(!t||!t.skipValidation){const i=e.slice(0,32),s=ls(i);for(let o=0;o<32;o++)if(r[o]!==s[o])throw new Error("provided secretKey is invalid")}return new Pn({publicKey:r,secretKey:e})}static fromSeed(e){const t=ls(e),r=new Uint8Array(64);return r.set(e),r.set(t,32),new Pn({publicKey:t,secretKey:r})}get publicKey(){return new j(this._keypair.publicKey)}get secretKey(){return new Uint8Array(this._keypair.secretKey)}}const Pr=Object.freeze({CreateLookupTable:{index:0,layout:ue([ce("instruction"),Wn("recentSlot"),ve("bumpSeed")])},FreezeLookupTable:{index:1,layout:ue([ce("instruction")])},ExtendLookupTable:{index:2,layout:ue([ce("instruction"),Wn(),kt(Re(),Xr(ce(),-8),"addresses")])},DeactivateLookupTable:{index:3,layout:ue([ce("instruction")])},CloseLookupTable:{index:4,layout:ue([ce("instruction")])}});class mw{constructor(){}static decodeInstructionType(e){this.checkProgramId(e.programId);const r=ce("instruction").decode(e.data);let i;for(const[s,o]of Object.entries(Pr))if(o.index==r){i=s;break}if(!i)throw new Error("Invalid Instruction. Should be a LookupTable Instruction");return i}static decodeCreateLookupTable(e){this.checkProgramId(e.programId),this.checkKeysLength(e.keys,4);const{recentSlot:t}=Oe(Pr.CreateLookupTable,e.data);return{authority:e.keys[1].pubkey,payer:e.keys[2].pubkey,recentSlot:Number(t)}}static decodeExtendLookupTable(e){if(this.checkProgramId(e.programId),e.keys.length<2)throw new Error(`invalid instruction; found ${e.keys.length} keys, expected at least 2`);const{addresses:t}=Oe(Pr.ExtendLookupTable,e.data);return{lookupTable:e.keys[0].pubkey,authority:e.keys[1].pubkey,payer:e.keys.length>2?e.keys[2].pubkey:void 0,addresses:t.map(r=>new j(r))}}static decodeCloseLookupTable(e){return this.checkProgramId(e.programId),this.checkKeysLength(e.keys,3),{lookupTable:e.keys[0].pubkey,authority:e.keys[1].pubkey,recipient:e.keys[2].pubkey}}static decodeFreezeLookupTable(e){return this.checkProgramId(e.programId),this.checkKeysLength(e.keys,2),{lookupTable:e.keys[0].pubkey,authority:e.keys[1].pubkey}}static decodeDeactivateLookupTable(e){return this.checkProgramId(e.programId),this.checkKeysLength(e.keys,2),{lookupTable:e.keys[0].pubkey,authority:e.keys[1].pubkey}}static checkProgramId(e){if(!e.equals($a.programId))throw new Error("invalid instruction; programId is not AddressLookupTable Program")}static checkKeysLength(e,t){if(e.length<t)throw new Error(`invalid instruction; found ${e.length} keys, expected at least ${t}`)}}class $a{constructor(){}static createLookupTable(e){const[t,r]=j.findProgramAddressSync([e.authority.toBuffer(),Dl().encode(e.recentSlot)],this.programId),i=Pr.CreateLookupTable,s=Ie(i,{recentSlot:BigInt(e.recentSlot),bumpSeed:r}),o=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:e.authority,isSigner:!0,isWritable:!1},{pubkey:e.payer,isSigner:!0,isWritable:!0},{pubkey:$e.programId,isSigner:!1,isWritable:!1}];return[new Ce({programId:this.programId,keys:o,data:s}),t]}static freezeLookupTable(e){const t=Pr.FreezeLookupTable,r=Ie(t),i=[{pubkey:e.lookupTable,isSigner:!1,isWritable:!0},{pubkey:e.authority,isSigner:!0,isWritable:!1}];return new Ce({programId:this.programId,keys:i,data:r})}static extendLookupTable(e){const t=Pr.ExtendLookupTable,r=Ie(t,{addresses:e.addresses.map(s=>s.toBytes())}),i=[{pubkey:e.lookupTable,isSigner:!1,isWritable:!0},{pubkey:e.authority,isSigner:!0,isWritable:!1}];return e.payer&&i.push({pubkey:e.payer,isSigner:!0,isWritable:!0},{pubkey:$e.programId,isSigner:!1,isWritable:!1}),new Ce({programId:this.programId,keys:i,data:r})}static deactivateLookupTable(e){const t=Pr.DeactivateLookupTable,r=Ie(t),i=[{pubkey:e.lookupTable,isSigner:!1,isWritable:!0},{pubkey:e.authority,isSigner:!0,isWritable:!1}];return new Ce({programId:this.programId,keys:i,data:r})}static closeLookupTable(e){const t=Pr.CloseLookupTable,r=Ie(t),i=[{pubkey:e.lookupTable,isSigner:!1,isWritable:!0},{pubkey:e.authority,isSigner:!0,isWritable:!1},{pubkey:e.recipient,isSigner:!1,isWritable:!0}];return new Ce({programId:this.programId,keys:i,data:r})}}$a.programId=new j("AddressLookupTab1e1111111111111111111111111");class ww{constructor(){}static decodeInstructionType(e){this.checkProgramId(e.programId);const r=ve("instruction").decode(e.data);let i;for(const[s,o]of Object.entries(wr))if(o.index==r){i=s;break}if(!i)throw new Error("Instruction type incorrect; not a ComputeBudgetInstruction");return i}static decodeRequestUnits(e){this.checkProgramId(e.programId);const{units:t,additionalFee:r}=Oe(wr.RequestUnits,e.data);return{units:t,additionalFee:r}}static decodeRequestHeapFrame(e){this.checkProgramId(e.programId);const{bytes:t}=Oe(wr.RequestHeapFrame,e.data);return{bytes:t}}static decodeSetComputeUnitLimit(e){this.checkProgramId(e.programId);const{units:t}=Oe(wr.SetComputeUnitLimit,e.data);return{units:t}}static decodeSetComputeUnitPrice(e){this.checkProgramId(e.programId);const{microLamports:t}=Oe(wr.SetComputeUnitPrice,e.data);return{microLamports:t}}static checkProgramId(e){if(!e.equals(Ka.programId))throw new Error("invalid instruction; programId is not ComputeBudgetProgram")}}const wr=Object.freeze({RequestUnits:{index:0,layout:ue([ve("instruction"),ce("units"),ce("additionalFee")])},RequestHeapFrame:{index:1,layout:ue([ve("instruction"),ce("bytes")])},SetComputeUnitLimit:{index:2,layout:ue([ve("instruction"),ce("units")])},SetComputeUnitPrice:{index:3,layout:ue([ve("instruction"),Wn("microLamports")])}});class Ka{constructor(){}static requestUnits(e){const t=wr.RequestUnits,r=Ie(t,e);return new Ce({keys:[],programId:this.programId,data:r})}static requestHeapFrame(e){const t=wr.RequestHeapFrame,r=Ie(t,e);return new Ce({keys:[],programId:this.programId,data:r})}static setComputeUnitLimit(e){const t=wr.SetComputeUnitLimit,r=Ie(t,e);return new Ce({keys:[],programId:this.programId,data:r})}static setComputeUnitPrice(e){const t=wr.SetComputeUnitPrice,r=Ie(t,{microLamports:BigInt(e.microLamports)});return new Ce({keys:[],programId:this.programId,data:r})}}Ka.programId=new j("ComputeBudget111111111111111111111111111111");const $c=64,Kc=32,Wc=64,Gc=ue([ve("numSignatures"),ve("padding"),er("signatureOffset"),er("signatureInstructionIndex"),er("publicKeyOffset"),er("publicKeyInstructionIndex"),er("messageDataOffset"),er("messageDataSize"),er("messageInstructionIndex")]);class Ms{constructor(){}static createInstructionWithPublicKey(e){const{publicKey:t,message:r,signature:i,instructionIndex:s}=e;Te(t.length===Kc,`Public Key must be ${Kc} bytes but received ${t.length} bytes`),Te(i.length===Wc,`Signature must be ${Wc} bytes but received ${i.length} bytes`);const o=Gc.span,a=o+t.length,u=a+i.length,l=1,f=te.Buffer.alloc(u+r.length),_=s??65535;return Gc.encode({numSignatures:l,padding:0,signatureOffset:a,signatureInstructionIndex:_,publicKeyOffset:o,publicKeyInstructionIndex:_,messageDataOffset:u,messageDataSize:r.length,messageInstructionIndex:_},f),f.fill(t,o),f.fill(i,a),f.fill(r,u),new Ce({keys:[],programId:Ms.programId,data:f})}static createInstructionWithPrivateKey(e){const{privateKey:t,message:r,instructionIndex:i}=e;Te(t.length===$c,`Private key must be ${$c} bytes but received ${t.length} bytes`);try{const s=Pn.fromSecretKey(t),o=s.publicKey.toBytes(),a=Ca(r,s.secretKey);return this.createInstructionWithPublicKey({publicKey:o,message:r,signature:a,instructionIndex:i})}catch(s){throw new Error(`Error creating instruction; ${s}`)}}}Ms.programId=new j("Ed25519SigVerify111111111111111111111111111");const _w=(n,e)=>{const t=Na.sign(n,e);return[t.toCompactRawBytes(),t.recovery]};Na.utils.isValidPrivateKey;const bw=Na.getPublicKey,qc=32,To=20,Vc=64,Ew=11,xo=ue([ve("numSignatures"),er("signatureOffset"),ve("signatureInstructionIndex"),er("ethAddressOffset"),ve("ethAddressInstructionIndex"),er("messageDataOffset"),er("messageDataSize"),ve("messageInstructionIndex"),Le(20,"ethAddress"),Le(64,"signature"),ve("recoveryId")]);class Un{constructor(){}static publicKeyToEthAddress(e){Te(e.length===Vc,`Public key must be ${Vc} bytes but received ${e.length} bytes`);try{return te.Buffer.from(xc(be(e))).slice(-To)}catch(t){throw new Error(`Error constructing Ethereum address: ${t}`)}}static createInstructionWithPublicKey(e){const{publicKey:t,message:r,signature:i,recoveryId:s,instructionIndex:o}=e;return Un.createInstructionWithEthAddress({ethAddress:Un.publicKeyToEthAddress(t),message:r,signature:i,recoveryId:s,instructionIndex:o})}static createInstructionWithEthAddress(e){const{ethAddress:t,message:r,signature:i,recoveryId:s,instructionIndex:o=0}=e;let a;typeof t=="string"?t.startsWith("0x")?a=te.Buffer.from(t.substr(2),"hex"):a=te.Buffer.from(t,"hex"):a=t,Te(a.length===To,`Address must be ${To} bytes but received ${a.length} bytes`);const u=1+Ew,l=u,f=u+a.length,_=f+i.length+1,I=1,g=te.Buffer.alloc(xo.span+r.length);return xo.encode({numSignatures:I,signatureOffset:f,signatureInstructionIndex:o,ethAddressOffset:l,ethAddressInstructionIndex:o,messageDataOffset:_,messageDataSize:r.length,messageInstructionIndex:o,signature:be(i),ethAddress:be(a),recoveryId:s},g),g.fill(be(r),xo.span),new Ce({keys:[],programId:Un.programId,data:g})}static createInstructionWithPrivateKey(e){const{privateKey:t,message:r,instructionIndex:i}=e;Te(t.length===qc,`Private key must be ${qc} bytes but received ${t.length} bytes`);try{const s=be(t),o=bw(s,!1).slice(1),a=te.Buffer.from(xc(be(r))),[u,l]=_w(a,s);return this.createInstructionWithPublicKey({publicKey:o,message:r,signature:u,recoveryId:l,instructionIndex:i})}catch(s){throw new Error(`Error creating instruction; ${s}`)}}}Un.programId=new j("KeccakSecp256k11111111111111111111111111111");var Ah;const vh=new j("StakeConfig11111111111111111111111111111111");class Sh{constructor(e,t){this.staker=void 0,this.withdrawer=void 0,this.staker=e,this.withdrawer=t}}class ki{constructor(e,t,r){this.unixTimestamp=void 0,this.epoch=void 0,this.custodian=void 0,this.unixTimestamp=e,this.epoch=t,this.custodian=r}}Ah=ki;ki.default=new Ah(0,0,j.default);class Rw{constructor(){}static decodeInstructionType(e){this.checkProgramId(e.programId);const r=ce("instruction").decode(e.data);let i;for(const[s,o]of Object.entries(At))if(o.index==r){i=s;break}if(!i)throw new Error("Instruction type incorrect; not a StakeInstruction");return i}static decodeInitialize(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,2);const{authorized:t,lockup:r}=Oe(At.Initialize,e.data);return{stakePubkey:e.keys[0].pubkey,authorized:new Sh(new j(t.staker),new j(t.withdrawer)),lockup:new ki(r.unixTimestamp,r.epoch,new j(r.custodian))}}static decodeDelegate(e){return this.checkProgramId(e.programId),this.checkKeyLength(e.keys,6),Oe(At.Delegate,e.data),{stakePubkey:e.keys[0].pubkey,votePubkey:e.keys[1].pubkey,authorizedPubkey:e.keys[5].pubkey}}static decodeAuthorize(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,3);const{newAuthorized:t,stakeAuthorizationType:r}=Oe(At.Authorize,e.data),i={stakePubkey:e.keys[0].pubkey,authorizedPubkey:e.keys[2].pubkey,newAuthorizedPubkey:new j(t),stakeAuthorizationType:{index:r}};return e.keys.length>3&&(i.custodianPubkey=e.keys[3].pubkey),i}static decodeAuthorizeWithSeed(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,2);const{newAuthorized:t,stakeAuthorizationType:r,authoritySeed:i,authorityOwner:s}=Oe(At.AuthorizeWithSeed,e.data),o={stakePubkey:e.keys[0].pubkey,authorityBase:e.keys[1].pubkey,authoritySeed:i,authorityOwner:new j(s),newAuthorizedPubkey:new j(t),stakeAuthorizationType:{index:r}};return e.keys.length>3&&(o.custodianPubkey=e.keys[3].pubkey),o}static decodeSplit(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,3);const{lamports:t}=Oe(At.Split,e.data);return{stakePubkey:e.keys[0].pubkey,splitStakePubkey:e.keys[1].pubkey,authorizedPubkey:e.keys[2].pubkey,lamports:t}}static decodeMerge(e){return this.checkProgramId(e.programId),this.checkKeyLength(e.keys,3),Oe(At.Merge,e.data),{stakePubkey:e.keys[0].pubkey,sourceStakePubKey:e.keys[1].pubkey,authorizedPubkey:e.keys[4].pubkey}}static decodeWithdraw(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,5);const{lamports:t}=Oe(At.Withdraw,e.data),r={stakePubkey:e.keys[0].pubkey,toPubkey:e.keys[1].pubkey,authorizedPubkey:e.keys[4].pubkey,lamports:t};return e.keys.length>5&&(r.custodianPubkey=e.keys[5].pubkey),r}static decodeDeactivate(e){return this.checkProgramId(e.programId),this.checkKeyLength(e.keys,3),Oe(At.Deactivate,e.data),{stakePubkey:e.keys[0].pubkey,authorizedPubkey:e.keys[2].pubkey}}static checkProgramId(e){if(!e.equals(Ls.programId))throw new Error("invalid instruction; programId is not StakeProgram")}static checkKeyLength(e,t){if(e.length<t)throw new Error(`invalid instruction; found ${e.length} keys, expected at least ${t}`)}}const At=Object.freeze({Initialize:{index:0,layout:ue([ce("instruction"),kg(),Tg()])},Authorize:{index:1,layout:ue([ce("instruction"),Re("newAuthorized"),ce("stakeAuthorizationType")])},Delegate:{index:2,layout:ue([ce("instruction")])},Split:{index:3,layout:ue([ce("instruction"),Vt("lamports")])},Withdraw:{index:4,layout:ue([ce("instruction"),Vt("lamports")])},Deactivate:{index:5,layout:ue([ce("instruction")])},Merge:{index:7,layout:ue([ce("instruction")])},AuthorizeWithSeed:{index:8,layout:ue([ce("instruction"),Re("newAuthorized"),ce("stakeAuthorizationType"),hn("authoritySeed"),Re("authorityOwner")])}}),Aw=Object.freeze({Staker:{index:0},Withdrawer:{index:1}});class Ls{constructor(){}static initialize(e){const{stakePubkey:t,authorized:r,lockup:i}=e,s=i||ki.default,o=At.Initialize,a=Ie(o,{authorized:{staker:be(r.staker.toBuffer()),withdrawer:be(r.withdrawer.toBuffer())},lockup:{unixTimestamp:s.unixTimestamp,epoch:s.epoch,custodian:be(s.custodian.toBuffer())}}),u={keys:[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:Kn,isSigner:!1,isWritable:!1}],programId:this.programId,data:a};return new Ce(u)}static createAccountWithSeed(e){const t=new ke;t.add($e.createAccountWithSeed({fromPubkey:e.fromPubkey,newAccountPubkey:e.stakePubkey,basePubkey:e.basePubkey,seed:e.seed,lamports:e.lamports,space:this.space,programId:this.programId}));const{stakePubkey:r,authorized:i,lockup:s}=e;return t.add(this.initialize({stakePubkey:r,authorized:i,lockup:s}))}static createAccount(e){const t=new ke;t.add($e.createAccount({fromPubkey:e.fromPubkey,newAccountPubkey:e.stakePubkey,lamports:e.lamports,space:this.space,programId:this.programId}));const{stakePubkey:r,authorized:i,lockup:s}=e;return t.add(this.initialize({stakePubkey:r,authorized:i,lockup:s}))}static delegate(e){const{stakePubkey:t,authorizedPubkey:r,votePubkey:i}=e,s=At.Delegate,o=Ie(s);return new ke().add({keys:[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:i,isSigner:!1,isWritable:!1},{pubkey:yr,isSigner:!1,isWritable:!1},{pubkey:Ji,isSigner:!1,isWritable:!1},{pubkey:vh,isSigner:!1,isWritable:!1},{pubkey:r,isSigner:!0,isWritable:!1}],programId:this.programId,data:o})}static authorize(e){const{stakePubkey:t,authorizedPubkey:r,newAuthorizedPubkey:i,stakeAuthorizationType:s,custodianPubkey:o}=e,a=At.Authorize,u=Ie(a,{newAuthorized:be(i.toBuffer()),stakeAuthorizationType:s.index}),l=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:yr,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!0,isWritable:!1}];return o&&l.push({pubkey:o,isSigner:!0,isWritable:!1}),new ke().add({keys:l,programId:this.programId,data:u})}static authorizeWithSeed(e){const{stakePubkey:t,authorityBase:r,authoritySeed:i,authorityOwner:s,newAuthorizedPubkey:o,stakeAuthorizationType:a,custodianPubkey:u}=e,l=At.AuthorizeWithSeed,f=Ie(l,{newAuthorized:be(o.toBuffer()),stakeAuthorizationType:a.index,authoritySeed:i,authorityOwner:be(s.toBuffer())}),_=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!0,isWritable:!1},{pubkey:yr,isSigner:!1,isWritable:!1}];return u&&_.push({pubkey:u,isSigner:!0,isWritable:!1}),new ke().add({keys:_,programId:this.programId,data:f})}static splitInstruction(e){const{stakePubkey:t,authorizedPubkey:r,splitStakePubkey:i,lamports:s}=e,o=At.Split,a=Ie(o,{lamports:s});return new Ce({keys:[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:i,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!0,isWritable:!1}],programId:this.programId,data:a})}static split(e,t){const r=new ke;return r.add($e.createAccount({fromPubkey:e.authorizedPubkey,newAccountPubkey:e.splitStakePubkey,lamports:t,space:this.space,programId:this.programId})),r.add(this.splitInstruction(e))}static splitWithSeed(e,t){const{stakePubkey:r,authorizedPubkey:i,splitStakePubkey:s,basePubkey:o,seed:a,lamports:u}=e,l=new ke;return l.add($e.allocate({accountPubkey:s,basePubkey:o,seed:a,space:this.space,programId:this.programId})),t&&t>0&&l.add($e.transfer({fromPubkey:e.authorizedPubkey,toPubkey:s,lamports:t})),l.add(this.splitInstruction({stakePubkey:r,authorizedPubkey:i,splitStakePubkey:s,lamports:u}))}static merge(e){const{stakePubkey:t,sourceStakePubKey:r,authorizedPubkey:i}=e,s=At.Merge,o=Ie(s);return new ke().add({keys:[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!1,isWritable:!0},{pubkey:yr,isSigner:!1,isWritable:!1},{pubkey:Ji,isSigner:!1,isWritable:!1},{pubkey:i,isSigner:!0,isWritable:!1}],programId:this.programId,data:o})}static withdraw(e){const{stakePubkey:t,authorizedPubkey:r,toPubkey:i,lamports:s,custodianPubkey:o}=e,a=At.Withdraw,u=Ie(a,{lamports:s}),l=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:i,isSigner:!1,isWritable:!0},{pubkey:yr,isSigner:!1,isWritable:!1},{pubkey:Ji,isSigner:!1,isWritable:!1},{pubkey:r,isSigner:!0,isWritable:!1}];return o&&l.push({pubkey:o,isSigner:!0,isWritable:!1}),new ke().add({keys:l,programId:this.programId,data:u})}static deactivate(e){const{stakePubkey:t,authorizedPubkey:r}=e,i=At.Deactivate,s=Ie(i);return new ke().add({keys:[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:yr,isSigner:!1,isWritable:!1},{pubkey:r,isSigner:!0,isWritable:!1}],programId:this.programId,data:s})}}Ls.programId=new j("Stake11111111111111111111111111111111111111");Ls.space=200;class Ih{constructor(e,t,r,i){this.nodePubkey=void 0,this.authorizedVoter=void 0,this.authorizedWithdrawer=void 0,this.commission=void 0,this.nodePubkey=e,this.authorizedVoter=t,this.authorizedWithdrawer=r,this.commission=i}}class vw{constructor(){}static decodeInstructionType(e){this.checkProgramId(e.programId);const r=ce("instruction").decode(e.data);let i;for(const[s,o]of Object.entries(_r))if(o.index==r){i=s;break}if(!i)throw new Error("Instruction type incorrect; not a VoteInstruction");return i}static decodeInitializeAccount(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,4);const{voteInit:t}=Oe(_r.InitializeAccount,e.data);return{votePubkey:e.keys[0].pubkey,nodePubkey:e.keys[3].pubkey,voteInit:new Ih(new j(t.nodePubkey),new j(t.authorizedVoter),new j(t.authorizedWithdrawer),t.commission)}}static decodeAuthorize(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,3);const{newAuthorized:t,voteAuthorizationType:r}=Oe(_r.Authorize,e.data);return{votePubkey:e.keys[0].pubkey,authorizedPubkey:e.keys[2].pubkey,newAuthorizedPubkey:new j(t),voteAuthorizationType:{index:r}}}static decodeAuthorizeWithSeed(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,3);const{voteAuthorizeWithSeedArgs:{currentAuthorityDerivedKeyOwnerPubkey:t,currentAuthorityDerivedKeySeed:r,newAuthorized:i,voteAuthorizationType:s}}=Oe(_r.AuthorizeWithSeed,e.data);return{currentAuthorityDerivedKeyBasePubkey:e.keys[2].pubkey,currentAuthorityDerivedKeyOwnerPubkey:new j(t),currentAuthorityDerivedKeySeed:r,newAuthorizedPubkey:new j(i),voteAuthorizationType:{index:s},votePubkey:e.keys[0].pubkey}}static decodeWithdraw(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,3);const{lamports:t}=Oe(_r.Withdraw,e.data);return{votePubkey:e.keys[0].pubkey,authorizedWithdrawerPubkey:e.keys[2].pubkey,lamports:t,toPubkey:e.keys[1].pubkey}}static checkProgramId(e){if(!e.equals(ei.programId))throw new Error("invalid instruction; programId is not VoteProgram")}static checkKeyLength(e,t){if(e.length<t)throw new Error(`invalid instruction; found ${e.length} keys, expected at least ${t}`)}}const _r=Object.freeze({InitializeAccount:{index:0,layout:ue([ce("instruction"),xg()])},Authorize:{index:1,layout:ue([ce("instruction"),Re("newAuthorized"),ce("voteAuthorizationType")])},Withdraw:{index:3,layout:ue([ce("instruction"),Vt("lamports")])},UpdateValidatorIdentity:{index:4,layout:ue([ce("instruction")])},AuthorizeWithSeed:{index:10,layout:ue([ce("instruction"),Og()])}}),Sw=Object.freeze({Voter:{index:0},Withdrawer:{index:1}});class ei{constructor(){}static initializeAccount(e){const{votePubkey:t,nodePubkey:r,voteInit:i}=e,s=_r.InitializeAccount,o=Ie(s,{voteInit:{nodePubkey:be(i.nodePubkey.toBuffer()),authorizedVoter:be(i.authorizedVoter.toBuffer()),authorizedWithdrawer:be(i.authorizedWithdrawer.toBuffer()),commission:i.commission}}),a={keys:[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:Kn,isSigner:!1,isWritable:!1},{pubkey:yr,isSigner:!1,isWritable:!1},{pubkey:r,isSigner:!0,isWritable:!1}],programId:this.programId,data:o};return new Ce(a)}static createAccount(e){const t=new ke;return t.add($e.createAccount({fromPubkey:e.fromPubkey,newAccountPubkey:e.votePubkey,lamports:e.lamports,space:this.space,programId:this.programId})),t.add(this.initializeAccount({votePubkey:e.votePubkey,nodePubkey:e.voteInit.nodePubkey,voteInit:e.voteInit}))}static authorize(e){const{votePubkey:t,authorizedPubkey:r,newAuthorizedPubkey:i,voteAuthorizationType:s}=e,o=_r.Authorize,a=Ie(o,{newAuthorized:be(i.toBuffer()),voteAuthorizationType:s.index}),u=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:yr,isSigner:!1,isWritable:!1},{pubkey:r,isSigner:!0,isWritable:!1}];return new ke().add({keys:u,programId:this.programId,data:a})}static authorizeWithSeed(e){const{currentAuthorityDerivedKeyBasePubkey:t,currentAuthorityDerivedKeyOwnerPubkey:r,currentAuthorityDerivedKeySeed:i,newAuthorizedPubkey:s,voteAuthorizationType:o,votePubkey:a}=e,u=_r.AuthorizeWithSeed,l=Ie(u,{voteAuthorizeWithSeedArgs:{currentAuthorityDerivedKeyOwnerPubkey:be(r.toBuffer()),currentAuthorityDerivedKeySeed:i,newAuthorized:be(s.toBuffer()),voteAuthorizationType:o.index}}),f=[{pubkey:a,isSigner:!1,isWritable:!0},{pubkey:yr,isSigner:!1,isWritable:!1},{pubkey:t,isSigner:!0,isWritable:!1}];return new ke().add({keys:f,programId:this.programId,data:l})}static withdraw(e){const{votePubkey:t,authorizedWithdrawerPubkey:r,lamports:i,toPubkey:s}=e,o=_r.Withdraw,a=Ie(o,{lamports:i}),u=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:s,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!0,isWritable:!1}];return new ke().add({keys:u,programId:this.programId,data:a})}static safeWithdraw(e,t,r){if(e.lamports>t-r)throw new Error("Withdraw will leave vote account with insufficient funds.");return ei.withdraw(e)}static updateValidatorIdentity(e){const{votePubkey:t,authorizedWithdrawerPubkey:r,nodePubkey:i}=e,s=_r.UpdateValidatorIdentity,o=Ie(s),a=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:i,isSigner:!0,isWritable:!1},{pubkey:r,isSigner:!0,isWritable:!1}];return new ke().add({keys:a,programId:this.programId,data:o})}}ei.programId=new j("Vote111111111111111111111111111111111111111");ei.space=3762;const kh=new j("Va1idator1nfo111111111111111111111111111111"),Iw=J({name:Q(),website:fe(Q()),details:fe(Q()),iconUrl:fe(Q()),keybaseUsername:fe(Q())});class Wa{constructor(e,t){this.key=void 0,this.info=void 0,this.key=e,this.info=t}static fromConfigData(e){let t=[...e];if(Dt(t)!==2)return null;const i=[];for(let s=0;s<2;s++){const o=new j(Ft(t,0,br)),a=mr(t)===1;i.push({publicKey:o,isSigner:a})}if(i[0].publicKey.equals(kh)&&i[1].isSigner){const s=hn().decode(te.Buffer.from(t)),o=JSON.parse(s);return Fl(o,Iw),new Wa(i[1].publicKey,o)}return null}}const kw=new j("Vote111111111111111111111111111111111111111"),Tw=ue([Re("nodePubkey"),Re("authorizedWithdrawer"),ve("commission"),St(),kt(ue([St("slot"),ce("confirmationCount")]),Xr(ce(),-8),"votes"),ve("rootSlotValid"),St("rootSlot"),St(),kt(ue([St("epoch"),Re("authorizedVoter")]),Xr(ce(),-8),"authorizedVoters"),ue([kt(ue([Re("authorizedPubkey"),St("epochOfLastAuthorizedSwitch"),St("targetEpoch")]),32,"buf"),St("idx"),ve("isEmpty")],"priorVoters"),St(),kt(ue([St("epoch"),St("credits"),St("prevCredits")]),Xr(ce(),-8),"epochCredits"),ue([St("slot"),St("timestamp")],"lastTimestamp")]);class Ga{constructor(e){this.nodePubkey=void 0,this.authorizedWithdrawer=void 0,this.commission=void 0,this.rootSlot=void 0,this.votes=void 0,this.authorizedVoters=void 0,this.priorVoters=void 0,this.epochCredits=void 0,this.lastTimestamp=void 0,this.nodePubkey=e.nodePubkey,this.authorizedWithdrawer=e.authorizedWithdrawer,this.commission=e.commission,this.rootSlot=e.rootSlot,this.votes=e.votes,this.authorizedVoters=e.authorizedVoters,this.priorVoters=e.priorVoters,this.epochCredits=e.epochCredits,this.lastTimestamp=e.lastTimestamp}static fromAccountData(e){const r=Tw.decode(be(e),4);let i=r.rootSlot;return r.rootSlotValid||(i=null),new Ga({nodePubkey:new j(r.nodePubkey),authorizedWithdrawer:new j(r.authorizedWithdrawer),commission:r.commission,votes:r.votes,rootSlot:i,authorizedVoters:r.authorizedVoters.map(xw),priorVoters:Ow(r.priorVoters),epochCredits:r.epochCredits,lastTimestamp:r.lastTimestamp})}}function xw({authorizedVoter:n,epoch:e}){return{epoch:e,authorizedVoter:new j(n)}}function jc({authorizedPubkey:n,epochOfLastAuthorizedSwitch:e,targetEpoch:t}){return{authorizedPubkey:new j(n),epochOfLastAuthorizedSwitch:e,targetEpoch:t}}function Ow({buf:n,idx:e,isEmpty:t}){return t?[]:[...n.slice(e+1).map(jc),...n.slice(0,e).map(jc)]}const Zc={http:{devnet:"http://api.devnet.solana.com",testnet:"http://api.testnet.solana.com","mainnet-beta":"http://api.mainnet-beta.solana.com/"},https:{devnet:"https://api.devnet.solana.com",testnet:"https://api.testnet.solana.com","mainnet-beta":"https://api.mainnet-beta.solana.com/"}};function Nw(n,e){const t=e===!1?"http":"https";if(!n)return Zc[t].devnet;const r=Zc[t][n];if(!r)throw new Error(`Unknown ${t} cluster: ${n}`);return r}async function Cw(n,e,t,r){let i,s;t&&Object.prototype.hasOwnProperty.call(t,"lastValidBlockHeight")||t&&Object.prototype.hasOwnProperty.call(t,"nonceValue")?(i=t,s=r):s=t;const o=s&&{skipPreflight:s.skipPreflight,preflightCommitment:s.preflightCommitment||s.commitment,minContextSlot:s.minContextSlot},a=await n.sendRawTransaction(e,o),u=s&&s.commitment,f=(await(i?n.confirmTransaction(i,u):n.confirmTransaction(a,u))).value;if(f.err)throw a!=null?new tn({action:o!=null&&o.skipPreflight?"send":"simulate",signature:a,transactionMessage:`Status: (${JSON.stringify(f)})`}):new Error(`Raw transaction ${a} failed (${JSON.stringify(f)})`);return a}const Qi=1e9,Bw=Object.freeze(Object.defineProperty({__proto__:null,Account:vg,AddressLookupTableAccount:Yo,AddressLookupTableInstruction:mw,AddressLookupTableProgram:$a,Authorized:Sh,BLOCKHASH_CACHE_TIMEOUT_MS:fh,BPF_LOADER_DEPRECATED_PROGRAM_ID:Sg,BPF_LOADER_PROGRAM_ID:Kg,BpfLoader:Wg,COMPUTE_BUDGET_INSTRUCTION_LAYOUTS:wr,ComputeBudgetInstruction:ww,ComputeBudgetProgram:Ka,Connection:Rh,Ed25519Program:Ms,Enum:Rg,EpochSchedule:lh,FeeCalculatorLayout:ch,Keypair:Pn,LAMPORTS_PER_SOL:Qi,LOOKUP_TABLE_INSTRUCTION_LAYOUTS:Pr,Loader:gn,Lockup:ki,MAX_SEED_LENGTH:ih,Message:lr,MessageAccountKeys:_i,MessageV0:yn,NONCE_ACCOUNT_LENGTH:Zo,NonceAccount:Ns,PACKET_DATA_SIZE:Jr,PUBLIC_KEY_LENGTH:br,PublicKey:j,SIGNATURE_LENGTH_IN_BYTES:wi,SOLANA_SCHEMA:hi,STAKE_CONFIG_ID:vh,STAKE_INSTRUCTION_LAYOUTS:At,SYSTEM_INSTRUCTION_LAYOUTS:De,SYSVAR_CLOCK_PUBKEY:yr,SYSVAR_EPOCH_SCHEDULE_PUBKEY:Lg,SYSVAR_INSTRUCTIONS_PUBKEY:Pg,SYSVAR_RECENT_BLOCKHASHES_PUBKEY:Xi,SYSVAR_RENT_PUBKEY:Kn,SYSVAR_REWARDS_PUBKEY:Ug,SYSVAR_SLOT_HASHES_PUBKEY:Dg,SYSVAR_SLOT_HISTORY_PUBKEY:Fg,SYSVAR_STAKE_HISTORY_PUBKEY:Ji,Secp256k1Program:Un,SendTransactionError:tn,SolanaJSONRPCError:he,SolanaJSONRPCErrorCode:Hg,StakeAuthorizationLayout:Aw,StakeInstruction:Rw,StakeProgram:Ls,Struct:Ba,SystemInstruction:zg,SystemProgram:$e,Transaction:ke,TransactionExpiredBlockheightExceededError:Ma,TransactionExpiredNonceInvalidError:Bn,TransactionExpiredTimeoutError:La,TransactionInstruction:Ce,TransactionMessage:Ua,TransactionStatus:Nr,VALIDATOR_INFO_KEY:kh,VERSION_PREFIX_MASK:xs,VOTE_PROGRAM_ID:kw,ValidatorInfo:Wa,VersionedMessage:Pa,VersionedTransaction:Da,VoteAccount:Ga,VoteAuthorizationLayout:Sw,VoteInit:Ih,VoteInstruction:vw,VoteProgram:ei,clusterApiUrl:Nw,sendAndConfirmRawTransaction:Cw,sendAndConfirmTransaction:jo},Symbol.toStringTag,{value:"Module"}));var qa={exports:{}};const Mw=/[\p{Lu}]/u,Lw=/[\p{Ll}]/u,Yc=/^[\p{Lu}](?![\p{Lu}])/gu,Th=/([\p{Alpha}\p{N}_]|$)/u,xh=/[_.\- ]+/,Pw=new RegExp("^"+xh.source),Xc=new RegExp(xh.source+Th.source,"gu"),Jc=new RegExp("\\d+"+Th.source,"gu"),Uw=(n,e,t)=>{let r=!1,i=!1,s=!1;for(let o=0;o<n.length;o++){const a=n[o];r&&Mw.test(a)?(n=n.slice(0,o)+"-"+n.slice(o),r=!1,s=i,i=!0,o++):i&&s&&Lw.test(a)?(n=n.slice(0,o-1)+"-"+n.slice(o-1),s=i,i=!1,r=!0):(r=e(a)===a&&t(a)!==a,s=i,i=t(a)===a&&e(a)!==a)}return n},Dw=(n,e)=>(Yc.lastIndex=0,n.replace(Yc,t=>e(t))),Fw=(n,e)=>(Xc.lastIndex=0,Jc.lastIndex=0,n.replace(Xc,(t,r)=>e(r)).replace(Jc,t=>e(t))),Oh=(n,e)=>{if(!(typeof n=="string"||Array.isArray(n)))throw new TypeError("Expected the input to be `string | string[]`");if(e={pascalCase:!1,preserveConsecutiveUppercase:!1,...e},Array.isArray(n)?n=n.map(s=>s.trim()).filter(s=>s.length).join("-"):n=n.trim(),n.length===0)return"";const t=e.locale===!1?s=>s.toLowerCase():s=>s.toLocaleLowerCase(e.locale),r=e.locale===!1?s=>s.toUpperCase():s=>s.toLocaleUpperCase(e.locale);return n.length===1?e.pascalCase?r(n):t(n):(n!==t(n)&&(n=Uw(n,t,r)),n=n.replace(Pw,""),e.preserveConsecutiveUppercase?n=Dw(n,t):n=t(n),e.pascalCase&&(n=r(n.charAt(0))+n.slice(1)),Fw(n,r))};qa.exports=Oh;qa.exports.default=Oh;var Hw=qa.exports;const zw=Vn(Hw);var ge={},oe={};let Me=class{constructor(e,t){if(!Number.isInteger(e))throw new TypeError("span must be an integer");this.span=e,this.property=t}makeDestinationObject(){return{}}decode(e,t){throw new Error("Layout is abstract")}encode(e,t,r){throw new Error("Layout is abstract")}getSpan(e,t){if(0>this.span)throw new RangeError("indeterminate span");return this.span}replicate(e){const t=Object.create(this.constructor.prototype);return Object.assign(t,this),t.property=e,t}fromArray(e){}};oe.Layout=Me;function Va(n,e){return e.property?n+"["+e.property+"]":n}oe.nameWithProperty=Va;function $w(n,e){if(typeof n!="function")throw new TypeError("Class must be constructor");if(n.hasOwnProperty("layout_"))throw new Error("Class is already bound to a layout");if(!(e&&e instanceof Me))throw new TypeError("layout must be a Layout");if(e.hasOwnProperty("boundConstructor_"))throw new Error("layout is already bound to a constructor");n.layout_=e,e.boundConstructor_=n,e.makeDestinationObject=()=>new n,Object.defineProperty(n.prototype,"encode",{value:function(t,r){return e.encode(this,t,r)},writable:!0}),Object.defineProperty(n,"decode",{value:function(t,r){return e.decode(t,r)},writable:!0})}oe.bindConstructorLayout=$w;let zt=class extends Me{isCount(){throw new Error("ExternalLayout is abstract")}};class Nh extends zt{constructor(e,t){if(e===void 0&&(e=1),!Number.isInteger(e)||0>=e)throw new TypeError("elementSpan must be a (positive) integer");super(-1,t),this.elementSpan=e}isCount(){return!0}decode(e,t){t===void 0&&(t=0);const r=e.length-t;return Math.floor(r/this.elementSpan)}encode(e,t,r){return 0}}let ja=class extends zt{constructor(e,t,r){if(!(e instanceof Me))throw new TypeError("layout must be a Layout");if(t===void 0)t=0;else if(!Number.isInteger(t))throw new TypeError("offset must be integer or undefined");super(e.span,r||e.property),this.layout=e,this.offset=t}isCount(){return this.layout instanceof Sr||this.layout instanceof Hr}decode(e,t){return t===void 0&&(t=0),this.layout.decode(e,t+this.offset)}encode(e,t,r){return r===void 0&&(r=0),this.layout.encode(e,t,r+this.offset)}},Sr=class extends Me{constructor(e,t){if(super(e,t),6<this.span)throw new RangeError("span must not exceed 6 bytes")}decode(e,t){return t===void 0&&(t=0),e.readUIntLE(t,this.span)}encode(e,t,r){return r===void 0&&(r=0),t.writeUIntLE(e,r,this.span),this.span}},Hr=class extends Me{constructor(e,t){if(super(e,t),6<this.span)throw new RangeError("span must not exceed 6 bytes")}decode(e,t){return t===void 0&&(t=0),e.readUIntBE(t,this.span)}encode(e,t,r){return r===void 0&&(r=0),t.writeUIntBE(e,r,this.span),this.span}};class Rn extends Me{constructor(e,t){if(super(e,t),6<this.span)throw new RangeError("span must not exceed 6 bytes")}decode(e,t){return t===void 0&&(t=0),e.readIntLE(t,this.span)}encode(e,t,r){return r===void 0&&(r=0),t.writeIntLE(e,r,this.span),this.span}}class ti extends Me{constructor(e,t){if(super(e,t),6<this.span)throw new RangeError("span must not exceed 6 bytes")}decode(e,t){return t===void 0&&(t=0),e.readIntBE(t,this.span)}encode(e,t,r){return r===void 0&&(r=0),t.writeIntBE(e,r,this.span),this.span}}const ea=Math.pow(2,32);function Ps(n){const e=Math.floor(n/ea),t=n-e*ea;return{hi32:e,lo32:t}}function Us(n,e){return n*ea+e}let Kw=class extends Me{constructor(e){super(8,e)}decode(e,t){t===void 0&&(t=0);const r=e.readUInt32LE(t),i=e.readUInt32LE(t+4);return Us(i,r)}encode(e,t,r){r===void 0&&(r=0);const i=Ps(e);return t.writeUInt32LE(i.lo32,r),t.writeUInt32LE(i.hi32,r+4),8}};class Ww extends Me{constructor(e){super(8,e)}decode(e,t){t===void 0&&(t=0);const r=e.readUInt32BE(t),i=e.readUInt32BE(t+4);return Us(r,i)}encode(e,t,r){r===void 0&&(r=0);const i=Ps(e);return t.writeUInt32BE(i.hi32,r),t.writeUInt32BE(i.lo32,r+4),8}}let Gw=class extends Me{constructor(e){super(8,e)}decode(e,t){t===void 0&&(t=0);const r=e.readUInt32LE(t),i=e.readInt32LE(t+4);return Us(i,r)}encode(e,t,r){r===void 0&&(r=0);const i=Ps(e);return t.writeUInt32LE(i.lo32,r),t.writeInt32LE(i.hi32,r+4),8}};class qw extends Me{constructor(e){super(8,e)}decode(e,t){t===void 0&&(t=0);const r=e.readInt32BE(t),i=e.readUInt32BE(t+4);return Us(r,i)}encode(e,t,r){r===void 0&&(r=0);const i=Ps(e);return t.writeInt32BE(i.hi32,r),t.writeUInt32BE(i.lo32,r+4),8}}class Ch extends Me{constructor(e){super(4,e)}decode(e,t){return t===void 0&&(t=0),e.readFloatLE(t)}encode(e,t,r){return r===void 0&&(r=0),t.writeFloatLE(e,r),4}}class Bh extends Me{constructor(e){super(4,e)}decode(e,t){return t===void 0&&(t=0),e.readFloatBE(t)}encode(e,t,r){return r===void 0&&(r=0),t.writeFloatBE(e,r),4}}class Mh extends Me{constructor(e){super(8,e)}decode(e,t){return t===void 0&&(t=0),e.readDoubleLE(t)}encode(e,t,r){return r===void 0&&(r=0),t.writeDoubleLE(e,r),8}}class Lh extends Me{constructor(e){super(8,e)}decode(e,t){return t===void 0&&(t=0),e.readDoubleBE(t)}encode(e,t,r){return r===void 0&&(r=0),t.writeDoubleBE(e,r),8}}class Ph extends Me{constructor(e,t,r){if(!(e instanceof Me))throw new TypeError("elementLayout must be a Layout");if(!(t instanceof zt&&t.isCount()||Number.isInteger(t)&&0<=t))throw new TypeError("count must be non-negative integer or an unsigned integer ExternalLayout");let i=-1;!(t instanceof zt)&&0<e.span&&(i=t*e.span),super(i,r),this.elementLayout=e,this.count=t}getSpan(e,t){if(0<=this.span)return this.span;t===void 0&&(t=0);let r=0,i=this.count;if(i instanceof zt&&(i=i.decode(e,t)),0<this.elementLayout.span)r=i*this.elementLayout.span;else{let s=0;for(;s<i;)r+=this.elementLayout.getSpan(e,t+r),++s}return r}decode(e,t){t===void 0&&(t=0);const r=[];let i=0,s=this.count;for(s instanceof zt&&(s=s.decode(e,t));i<s;)r.push(this.elementLayout.decode(e,t)),t+=this.elementLayout.getSpan(e,t),i+=1;return r}encode(e,t,r){r===void 0&&(r=0);const i=this.elementLayout,s=e.reduce((o,a)=>o+i.encode(a,t,r+o),0);return this.count instanceof zt&&this.count.encode(e.length,t,r),s}}let Uh=class extends Me{constructor(e,t,r){if(!(Array.isArray(e)&&e.reduce((s,o)=>s&&o instanceof Me,!0)))throw new TypeError("fields must be array of Layout instances");typeof t=="boolean"&&r===void 0&&(r=t,t=void 0);for(const s of e)if(0>s.span&&s.property===void 0)throw new Error("fields cannot contain unnamed variable-length layout");let i=-1;try{i=e.reduce((s,o)=>s+o.getSpan(),0)}catch{}super(i,t),this.fields=e,this.decodePrefixes=!!r}getSpan(e,t){if(0<=this.span)return this.span;t===void 0&&(t=0);let r=0;try{r=this.fields.reduce((i,s)=>{const o=s.getSpan(e,t);return t+=o,i+o},0)}catch{throw new RangeError("indeterminate span")}return r}decode(e,t){t===void 0&&(t=0);const r=this.makeDestinationObject();for(const i of this.fields)if(i.property!==void 0&&(r[i.property]=i.decode(e,t)),t+=i.getSpan(e,t),this.decodePrefixes&&e.length===t)break;return r}encode(e,t,r){r===void 0&&(r=0);const i=r;let s=0,o=0;for(const a of this.fields){let u=a.span;if(o=0<u?u:0,a.property!==void 0){const l=e[a.property];l!==void 0&&(o=a.encode(l,t,r),0>u&&(u=a.getSpan(t,r)))}s=r,r+=u}return s+o-i}fromArray(e){const t=this.makeDestinationObject();for(const r of this.fields)r.property!==void 0&&0<e.length&&(t[r.property]=e.shift());return t}layoutFor(e){if(typeof e!="string")throw new TypeError("property must be string");for(const t of this.fields)if(t.property===e)return t}offsetOf(e){if(typeof e!="string")throw new TypeError("property must be string");let t=0;for(const r of this.fields){if(r.property===e)return t;0>r.span?t=-1:0<=t&&(t+=r.span)}}},Za=class{constructor(e){this.property=e}decode(){throw new Error("UnionDiscriminator is abstract")}encode(){throw new Error("UnionDiscriminator is abstract")}},fs=class extends Za{constructor(e,t){if(!(e instanceof zt&&e.isCount()))throw new TypeError("layout must be an unsigned integer ExternalLayout");super(t||e.property||"variant"),this.layout=e}decode(e,t){return this.layout.decode(e,t)}encode(e,t,r){return this.layout.encode(e,t,r)}},Ya=class extends Me{constructor(e,t,r){const i=e instanceof Sr||e instanceof Hr;if(i)e=new fs(new ja(e));else if(e instanceof zt&&e.isCount())e=new fs(e);else if(!(e instanceof Za))throw new TypeError("discr must be a UnionDiscriminator or an unsigned integer layout");if(t===void 0&&(t=null),!(t===null||t instanceof Me))throw new TypeError("defaultLayout must be null or a Layout");if(t!==null){if(0>t.span)throw new Error("defaultLayout must have constant span");t.property===void 0&&(t=t.replicate("content"))}let s=-1;t&&(s=t.span,0<=s&&i&&(s+=e.layout.span)),super(s,r),this.discriminator=e,this.usesPrefixDiscriminator=i,this.defaultLayout=t,this.registry={};let o=this.defaultGetSourceVariant.bind(this);this.getSourceVariant=function(a){return o(a)},this.configGetSourceVariant=function(a){o=a.bind(this)}}getSpan(e,t){if(0<=this.span)return this.span;t===void 0&&(t=0);const r=this.getVariant(e,t);if(!r)throw new Error("unable to determine span for unrecognized variant");return r.getSpan(e,t)}defaultGetSourceVariant(e){if(e.hasOwnProperty(this.discriminator.property)){if(this.defaultLayout&&e.hasOwnProperty(this.defaultLayout.property))return;const t=this.registry[e[this.discriminator.property]];if(t&&(!t.layout||e.hasOwnProperty(t.property)))return t}else for(const t in this.registry){const r=this.registry[t];if(e.hasOwnProperty(r.property))return r}throw new Error("unable to infer src variant")}decode(e,t){t===void 0&&(t=0);let r;const i=this.discriminator,s=i.decode(e,t);let o=this.registry[s];if(o===void 0){let a=0;o=this.defaultLayout,this.usesPrefixDiscriminator&&(a=i.layout.span),r=this.makeDestinationObject(),r[i.property]=s,r[o.property]=this.defaultLayout.decode(e,t+a)}else r=o.decode(e,t);return r}encode(e,t,r){r===void 0&&(r=0);const i=this.getSourceVariant(e);if(i===void 0){const s=this.discriminator,o=this.defaultLayout;let a=0;return this.usesPrefixDiscriminator&&(a=s.layout.span),s.encode(e[s.property],t,r),a+o.encode(e[o.property],t,r+a)}return i.encode(e,t,r)}addVariant(e,t,r){const i=new Dh(this,e,t,r);return this.registry[e]=i,i}getVariant(e,t){let r=e;return Buffer.isBuffer(e)&&(t===void 0&&(t=0),r=this.discriminator.decode(e,t)),this.registry[r]}},Dh=class extends Me{constructor(e,t,r,i){if(!(e instanceof Ya))throw new TypeError("union must be a Union");if(!Number.isInteger(t)||0>t)throw new TypeError("variant must be a (non-negative) integer");if(typeof r=="string"&&i===void 0&&(i=r,r=null),r){if(!(r instanceof Me))throw new TypeError("layout must be a Layout");if(e.defaultLayout!==null&&0<=r.span&&r.span>e.defaultLayout.span)throw new Error("variant span exceeds span of containing union");if(typeof i!="string")throw new TypeError("variant must have a String property")}let s=e.span;0>e.span&&(s=r?r.span:0,0<=s&&e.usesPrefixDiscriminator&&(s+=e.discriminator.layout.span)),super(s,i),this.union=e,this.variant=t,this.layout=r||null}getSpan(e,t){if(0<=this.span)return this.span;t===void 0&&(t=0);let r=0;return this.union.usesPrefixDiscriminator&&(r=this.union.discriminator.layout.span),r+this.layout.getSpan(e,t+r)}decode(e,t){const r=this.makeDestinationObject();if(t===void 0&&(t=0),this!==this.union.getVariant(e,t))throw new Error("variant mismatch");let i=0;return this.union.usesPrefixDiscriminator&&(i=this.union.discriminator.layout.span),this.layout?r[this.property]=this.layout.decode(e,t+i):this.property?r[this.property]=!0:this.union.usesPrefixDiscriminator&&(r[this.union.discriminator.property]=this.variant),r}encode(e,t,r){r===void 0&&(r=0);let i=0;if(this.union.usesPrefixDiscriminator&&(i=this.union.discriminator.layout.span),this.layout&&!e.hasOwnProperty(this.property))throw new TypeError("variant lacks property "+this.property);this.union.discriminator.encode(this.variant,t,r);let s=i;if(this.layout&&(this.layout.encode(e[this.property],t,r+i),s+=this.layout.getSpan(t,r+i),0<=this.union.span&&s>this.union.span))throw new Error("encoded variant overruns containing union");return s}fromArray(e){if(this.layout)return this.layout.fromArray(e)}};function Nn(n){return 0>n&&(n+=4294967296),n}class Xa extends Me{constructor(e,t,r){if(!(e instanceof Sr||e instanceof Hr))throw new TypeError("word must be a UInt or UIntBE layout");if(typeof t=="string"&&r===void 0&&(r=t,t=void 0),4<e.span)throw new RangeError("word cannot exceed 32 bits");super(e.span,r),this.word=e,this.msb=!!t,this.fields=[];let i=0;this._packedSetValue=function(s){return i=Nn(s),this},this._packedGetValue=function(){return i}}decode(e,t){const r=this.makeDestinationObject();t===void 0&&(t=0);const i=this.word.decode(e,t);this._packedSetValue(i);for(const s of this.fields)s.property!==void 0&&(r[s.property]=s.decode(i));return r}encode(e,t,r){r===void 0&&(r=0);const i=this.word.decode(t,r);this._packedSetValue(i);for(const s of this.fields)if(s.property!==void 0){const o=e[s.property];o!==void 0&&s.encode(o)}return this.word.encode(this._packedGetValue(),t,r)}addField(e,t){const r=new fi(this,e,t);return this.fields.push(r),r}addBoolean(e){const t=new Fh(this,e);return this.fields.push(t),t}fieldFor(e){if(typeof e!="string")throw new TypeError("property must be string");for(const t of this.fields)if(t.property===e)return t}}class fi{constructor(e,t,r){if(!(e instanceof Xa))throw new TypeError("container must be a BitStructure");if(!Number.isInteger(t)||0>=t)throw new TypeError("bits must be positive integer");const i=8*e.span,s=e.fields.reduce((o,a)=>o+a.bits,0);if(t+s>i)throw new Error("bits too long for span remainder ("+(i-s)+" of "+i+" remain)");this.container=e,this.bits=t,this.valueMask=(1<<t)-1,t===32&&(this.valueMask=4294967295),this.start=s,this.container.msb&&(this.start=i-s-t),this.wordMask=Nn(this.valueMask<<this.start),this.property=r}decode(){const e=this.container._packedGetValue();return Nn(e&this.wordMask)>>>this.start}encode(e){if(!Number.isInteger(e)||e!==Nn(e&this.valueMask))throw new TypeError(Va("BitField.encode",this)+" value must be integer not exceeding "+this.valueMask);const t=this.container._packedGetValue(),r=Nn(e<<this.start);this.container._packedSetValue(Nn(t&~this.wordMask)|r)}}let Fh=class extends fi{constructor(e,t){super(e,1,t)}decode(e,t){return!!fi.prototype.decode.call(this,e,t)}encode(e){return typeof e=="boolean"&&(e=+e),fi.prototype.encode.call(this,e)}},Hh=class extends Me{constructor(e,t){if(!(e instanceof zt&&e.isCount()||Number.isInteger(e)&&0<=e))throw new TypeError("length must be positive integer or an unsigned integer ExternalLayout");let r=-1;e instanceof zt||(r=e),super(r,t),this.length=e}getSpan(e,t){let r=this.span;return 0>r&&(r=this.length.decode(e,t)),r}decode(e,t){t===void 0&&(t=0);let r=this.span;return 0>r&&(r=this.length.decode(e,t)),e.slice(t,t+r)}encode(e,t,r){let i=this.length;if(this.length instanceof zt&&(i=e.length),!(Buffer.isBuffer(e)&&i===e.length))throw new TypeError(Va("Blob.encode",this)+" requires (length "+i+") Buffer as src");if(r+i>t.length)throw new RangeError("encoding overruns Buffer");return t.write(e.toString("hex"),r,i,"hex"),this.length instanceof zt&&this.length.encode(i,t,r),i}};class zh extends Me{constructor(e){super(-1,e)}getSpan(e,t){if(!Buffer.isBuffer(e))throw new TypeError("b must be a Buffer");t===void 0&&(t=0);let r=t;for(;r<e.length&&e[r]!==0;)r+=1;return 1+r-t}decode(e,t,r){t===void 0&&(t=0);let i=this.getSpan(e,t);return e.slice(t,t+i-1).toString("utf-8")}encode(e,t,r){r===void 0&&(r=0),typeof e!="string"&&(e=e.toString());const i=new Buffer(e,"utf8"),s=i.length;if(r+s>t.length)throw new RangeError("encoding overruns Buffer");return i.copy(t,r),t[r+s]=0,s+1}}class $h extends Me{constructor(e,t){if(typeof e=="string"&&t===void 0&&(t=e,e=void 0),e===void 0)e=-1;else if(!Number.isInteger(e))throw new TypeError("maxSpan must be an integer");super(-1,t),this.maxSpan=e}getSpan(e,t){if(!Buffer.isBuffer(e))throw new TypeError("b must be a Buffer");return t===void 0&&(t=0),e.length-t}decode(e,t,r){t===void 0&&(t=0);let i=this.getSpan(e,t);if(0<=this.maxSpan&&this.maxSpan<i)throw new RangeError("text length exceeds maxSpan");return e.slice(t,t+i).toString("utf-8")}encode(e,t,r){r===void 0&&(r=0),typeof e!="string"&&(e=e.toString());const i=new Buffer(e,"utf8"),s=i.length;if(0<=this.maxSpan&&this.maxSpan<s)throw new RangeError("text length exceeds maxSpan");if(r+s>t.length)throw new RangeError("encoding overruns Buffer");return i.copy(t,r),s}}class Kh extends Me{constructor(e,t){super(0,t),this.value=e}decode(e,t,r){return this.value}encode(e,t,r){return 0}}oe.ExternalLayout=zt;oe.GreedyCount=Nh;oe.OffsetLayout=ja;oe.UInt=Sr;oe.UIntBE=Hr;oe.Int=Rn;oe.IntBE=ti;oe.Float=Ch;oe.FloatBE=Bh;oe.Double=Mh;oe.DoubleBE=Lh;oe.Sequence=Ph;oe.Structure=Uh;oe.UnionDiscriminator=Za;oe.UnionLayoutDiscriminator=fs;oe.Union=Ya;oe.VariantLayout=Dh;oe.BitStructure=Xa;oe.BitField=fi;oe.Boolean=Fh;oe.Blob=Hh;oe.CString=zh;oe.UTF8=$h;oe.Constant=Kh;oe.greedy=(n,e)=>new Nh(n,e);oe.offset=(n,e,t)=>new ja(n,e,t);oe.u8=n=>new Sr(1,n);oe.u16=n=>new Sr(2,n);oe.u24=n=>new Sr(3,n);oe.u32=n=>new Sr(4,n);oe.u40=n=>new Sr(5,n);oe.u48=n=>new Sr(6,n);oe.nu64=n=>new Kw(n);oe.u16be=n=>new Hr(2,n);oe.u24be=n=>new Hr(3,n);oe.u32be=n=>new Hr(4,n);oe.u40be=n=>new Hr(5,n);oe.u48be=n=>new Hr(6,n);oe.nu64be=n=>new Ww(n);oe.s8=n=>new Rn(1,n);oe.s16=n=>new Rn(2,n);oe.s24=n=>new Rn(3,n);oe.s32=n=>new Rn(4,n);oe.s40=n=>new Rn(5,n);oe.s48=n=>new Rn(6,n);oe.ns64=n=>new Gw(n);oe.s16be=n=>new ti(2,n);oe.s24be=n=>new ti(3,n);oe.s32be=n=>new ti(4,n);oe.s40be=n=>new ti(5,n);oe.s48be=n=>new ti(6,n);oe.ns64be=n=>new qw(n);oe.f32=n=>new Ch(n);oe.f32be=n=>new Bh(n);oe.f64=n=>new Mh(n);oe.f64be=n=>new Lh(n);oe.struct=(n,e,t)=>new Uh(n,e,t);oe.bits=(n,e,t)=>new Xa(n,e,t);oe.seq=(n,e,t)=>new Ph(n,e,t);oe.union=(n,e,t)=>new Ya(n,e,t);oe.unionLayoutDiscriminator=(n,e)=>new fs(n,e);oe.blob=(n,e)=>new Hh(n,e);oe.cstr=n=>new zh(n);oe.utf8=(n,e)=>new $h(n,e);oe.const=(n,e)=>new Kh(n,e);const Vw=gs(Bw);(function(n){var e=Zt&&Zt.__importDefault||function(D){return D&&D.__esModule?D:{default:D}};Object.defineProperty(n,"__esModule",{value:!0}),n.struct=n.f64=n.f32=n.i32=n.u32=n.i16=n.u16=n.i8=n.u8=void 0,n.u64=a,n.i64=u,n.u128=l,n.i128=f,n.u256=_,n.i256=I,n.publicKey=v,n.option=A,n.bool=N,n.vec=$,n.tagged=L,n.vecU8=X,n.str=V,n.rustEnum=Y,n.array=U,n.map=M;const t=oe,r=Vw,i=e(ma);var s=oe;Object.defineProperty(n,"u8",{enumerable:!0,get:function(){return s.u8}}),Object.defineProperty(n,"i8",{enumerable:!0,get:function(){return s.s8}}),Object.defineProperty(n,"u16",{enumerable:!0,get:function(){return s.u16}}),Object.defineProperty(n,"i16",{enumerable:!0,get:function(){return s.s16}}),Object.defineProperty(n,"u32",{enumerable:!0,get:function(){return s.u32}}),Object.defineProperty(n,"i32",{enumerable:!0,get:function(){return s.s32}}),Object.defineProperty(n,"f32",{enumerable:!0,get:function(){return s.f32}}),Object.defineProperty(n,"f64",{enumerable:!0,get:function(){return s.f64}}),Object.defineProperty(n,"struct",{enumerable:!0,get:function(){return s.struct}});class o extends t.Layout{constructor(w,c,h){super(w,h),this.blob=(0,t.blob)(w),this.signed=c}decode(w,c=0){const h=new i.default(this.blob.decode(w,c),10,"le");return this.signed?h.fromTwos(this.span*8).clone():h}encode(w,c,h=0){return this.signed&&(w=w.toTwos(this.span*8)),this.blob.encode(w.toArrayLike(Buffer,"le",this.span),c,h)}}function a(D){return new o(8,!1,D)}function u(D){return new o(8,!0,D)}function l(D){return new o(16,!1,D)}function f(D){return new o(16,!0,D)}function _(D){return new o(32,!1,D)}function I(D){return new o(32,!0,D)}class g extends t.Layout{constructor(w,c,h,m){super(w.span,m),this.layout=w,this.decoder=c,this.encoder=h}decode(w,c){return this.decoder(this.layout.decode(w,c))}encode(w,c,h){return this.layout.encode(this.encoder(w),c,h)}getSpan(w,c){return this.layout.getSpan(w,c)}}function v(D){return new g((0,t.blob)(32),w=>new r.PublicKey(w),w=>w.toBuffer(),D)}class x extends t.Layout{constructor(w,c){super(-1,c),this.layout=w,this.discriminator=(0,t.u8)()}encode(w,c,h=0){return w==null?this.discriminator.encode(0,c,h):(this.discriminator.encode(1,c,h),this.layout.encode(w,c,h+1)+1)}decode(w,c=0){const h=this.discriminator.decode(w,c);if(h===0)return null;if(h===1)return this.layout.decode(w,c+1);throw new Error("Invalid option "+this.property)}getSpan(w,c=0){const h=this.discriminator.decode(w,c);if(h===0)return 1;if(h===1)return this.layout.getSpan(w,c+1)+1;throw new Error("Invalid option "+this.property)}}function A(D,w){return new x(D,w)}function N(D){return new g((0,t.u8)(),K,P,D)}function K(D){if(D===0)return!1;if(D===1)return!0;throw new Error("Invalid bool: "+D)}function P(D){return D?1:0}function $(D,w){const c=(0,t.u32)("length"),h=(0,t.struct)([c,(0,t.seq)(D,(0,t.offset)(c,-c.span),"values")]);return new g(h,({values:m})=>m,m=>({values:m}),w)}function L(D,w,c){const h=(0,t.struct)([a("tag"),w.replicate("data")]);function m({tag:E,data:S}){if(!E.eq(D))throw new Error("Invalid tag, expected: "+D.toString("hex")+", got: "+E.toString("hex"));return S}return new g(h,m,E=>({tag:D,data:E}),c)}function X(D){const w=(0,t.u32)("length"),c=(0,t.struct)([w,(0,t.blob)((0,t.offset)(w,-w.span),"data")]);return new g(c,({data:h})=>h,h=>({data:h}),D)}function V(D){return new g(X(),w=>w.toString("utf-8"),w=>Buffer.from(w,"utf-8"),D)}function Y(D,w,c){const h=(0,t.union)(c??(0,t.u8)(),w);return D.forEach((m,E)=>h.addVariant(E,m,m.property)),h}function U(D,w,c){const h=(0,t.struct)([(0,t.seq)(D,w,"values")]);return new g(h,({values:m})=>m,m=>({values:m}),c)}class G extends t.Layout{constructor(w,c,h){super(w.span+c.span,h),this.keyLayout=w,this.valueLayout=c}decode(w,c){c=c||0;const h=this.keyLayout.decode(w,c),m=this.valueLayout.decode(w,c+this.keyLayout.getSpan(w,c));return[h,m]}encode(w,c,h){h=h||0;const m=this.keyLayout.encode(w[0],c,h),E=this.valueLayout.encode(w[1],c,h+m);return m+E}getSpan(w,c){return this.keyLayout.getSpan(w,c)+this.valueLayout.getSpan(w,c)}}function M(D,w,c){const h=(0,t.u32)("length"),m=(0,t.struct)([h,(0,t.seq)(new G(D,w),(0,t.offset)(h,-h.span),"values")]);return new g(m,({values:E})=>new Map(E),E=>({values:Array.from(E.entries())}),c)}})(ge);/*! pako 2.1.0 https://github.com/nodeca/pako @license (MIT AND Zlib) */function ri(n){let e=n.length;for(;--e>=0;)n[e]=0}const jw=3,Zw=258,Wh=29,Yw=256,Xw=Yw+1+Wh,Gh=30,Jw=512,Qw=new Array((Xw+2)*2);ri(Qw);const e1=new Array(Gh*2);ri(e1);const t1=new Array(Jw);ri(t1);const r1=new Array(Zw-jw+1);ri(r1);const n1=new Array(Wh);ri(n1);const i1=new Array(Gh);ri(i1);const s1=(n,e,t,r)=>{let i=n&65535|0,s=n>>>16&65535|0,o=0;for(;t!==0;){o=t>2e3?2e3:t,t-=o;do i=i+e[r++]|0,s=s+i|0;while(--o);i%=65521,s%=65521}return i|s<<16|0};var ta=s1;const o1=()=>{let n,e=[];for(var t=0;t<256;t++){n=t;for(var r=0;r<8;r++)n=n&1?3988292384^n>>>1:n>>>1;e[t]=n}return e},a1=new Uint32Array(o1()),c1=(n,e,t,r)=>{const i=a1,s=r+t;n^=-1;for(let o=r;o<s;o++)n=n>>>8^i[(n^e[o])&255];return n^-1};var fr=c1,ra={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},qh={Z_NO_FLUSH:0,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_DEFLATED:8};const u1=(n,e)=>Object.prototype.hasOwnProperty.call(n,e);var l1=function(n){const e=Array.prototype.slice.call(arguments,1);for(;e.length;){const t=e.shift();if(t){if(typeof t!="object")throw new TypeError(t+"must be non-object");for(const r in t)u1(t,r)&&(n[r]=t[r])}}return n},h1=n=>{let e=0;for(let r=0,i=n.length;r<i;r++)e+=n[r].length;const t=new Uint8Array(e);for(let r=0,i=0,s=n.length;r<s;r++){let o=n[r];t.set(o,i),i+=o.length}return t},Vh={assign:l1,flattenChunks:h1};let jh=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{jh=!1}const Ei=new Uint8Array(256);for(let n=0;n<256;n++)Ei[n]=n>=252?6:n>=248?5:n>=240?4:n>=224?3:n>=192?2:1;Ei[254]=Ei[254]=1;var f1=n=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(n);let e,t,r,i,s,o=n.length,a=0;for(i=0;i<o;i++)t=n.charCodeAt(i),(t&64512)===55296&&i+1<o&&(r=n.charCodeAt(i+1),(r&64512)===56320&&(t=65536+(t-55296<<10)+(r-56320),i++)),a+=t<128?1:t<2048?2:t<65536?3:4;for(e=new Uint8Array(a),s=0,i=0;s<a;i++)t=n.charCodeAt(i),(t&64512)===55296&&i+1<o&&(r=n.charCodeAt(i+1),(r&64512)===56320&&(t=65536+(t-55296<<10)+(r-56320),i++)),t<128?e[s++]=t:t<2048?(e[s++]=192|t>>>6,e[s++]=128|t&63):t<65536?(e[s++]=224|t>>>12,e[s++]=128|t>>>6&63,e[s++]=128|t&63):(e[s++]=240|t>>>18,e[s++]=128|t>>>12&63,e[s++]=128|t>>>6&63,e[s++]=128|t&63);return e};const d1=(n,e)=>{if(e<65534&&n.subarray&&jh)return String.fromCharCode.apply(null,n.length===e?n:n.subarray(0,e));let t="";for(let r=0;r<e;r++)t+=String.fromCharCode(n[r]);return t};var p1=(n,e)=>{const t=e||n.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(n.subarray(0,e));let r,i;const s=new Array(t*2);for(i=0,r=0;r<t;){let o=n[r++];if(o<128){s[i++]=o;continue}let a=Ei[o];if(a>4){s[i++]=65533,r+=a-1;continue}for(o&=a===2?31:a===3?15:7;a>1&&r<t;)o=o<<6|n[r++]&63,a--;if(a>1){s[i++]=65533;continue}o<65536?s[i++]=o:(o-=65536,s[i++]=55296|o>>10&1023,s[i++]=56320|o&1023)}return d1(s,i)},y1=(n,e)=>{e=e||n.length,e>n.length&&(e=n.length);let t=e-1;for(;t>=0&&(n[t]&192)===128;)t--;return t<0||t===0?e:t+Ei[n[t]]>e?t:e},na={string2buf:f1,buf2string:p1,utf8border:y1};function g1(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var m1=g1;const Ki=16209,w1=16191;var _1=function(e,t){let r,i,s,o,a,u,l,f,_,I,g,v,x,A,N,K,P,$,L,X,V,Y,U,G;const M=e.state;r=e.next_in,U=e.input,i=r+(e.avail_in-5),s=e.next_out,G=e.output,o=s-(t-e.avail_out),a=s+(e.avail_out-257),u=M.dmax,l=M.wsize,f=M.whave,_=M.wnext,I=M.window,g=M.hold,v=M.bits,x=M.lencode,A=M.distcode,N=(1<<M.lenbits)-1,K=(1<<M.distbits)-1;e:do{v<15&&(g+=U[r++]<<v,v+=8,g+=U[r++]<<v,v+=8),P=x[g&N];t:for(;;){if($=P>>>24,g>>>=$,v-=$,$=P>>>16&255,$===0)G[s++]=P&65535;else if($&16){L=P&65535,$&=15,$&&(v<$&&(g+=U[r++]<<v,v+=8),L+=g&(1<<$)-1,g>>>=$,v-=$),v<15&&(g+=U[r++]<<v,v+=8,g+=U[r++]<<v,v+=8),P=A[g&K];r:for(;;){if($=P>>>24,g>>>=$,v-=$,$=P>>>16&255,$&16){if(X=P&65535,$&=15,v<$&&(g+=U[r++]<<v,v+=8,v<$&&(g+=U[r++]<<v,v+=8)),X+=g&(1<<$)-1,X>u){e.msg="invalid distance too far back",M.mode=Ki;break e}if(g>>>=$,v-=$,$=s-o,X>$){if($=X-$,$>f&&M.sane){e.msg="invalid distance too far back",M.mode=Ki;break e}if(V=0,Y=I,_===0){if(V+=l-$,$<L){L-=$;do G[s++]=I[V++];while(--$);V=s-X,Y=G}}else if(_<$){if(V+=l+_-$,$-=_,$<L){L-=$;do G[s++]=I[V++];while(--$);if(V=0,_<L){$=_,L-=$;do G[s++]=I[V++];while(--$);V=s-X,Y=G}}}else if(V+=_-$,$<L){L-=$;do G[s++]=I[V++];while(--$);V=s-X,Y=G}for(;L>2;)G[s++]=Y[V++],G[s++]=Y[V++],G[s++]=Y[V++],L-=3;L&&(G[s++]=Y[V++],L>1&&(G[s++]=Y[V++]))}else{V=s-X;do G[s++]=G[V++],G[s++]=G[V++],G[s++]=G[V++],L-=3;while(L>2);L&&(G[s++]=G[V++],L>1&&(G[s++]=G[V++]))}}else if($&64){e.msg="invalid distance code",M.mode=Ki;break e}else{P=A[(P&65535)+(g&(1<<$)-1)];continue r}break}}else if($&64)if($&32){M.mode=w1;break e}else{e.msg="invalid literal/length code",M.mode=Ki;break e}else{P=x[(P&65535)+(g&(1<<$)-1)];continue t}break}}while(r<i&&s<a);L=v>>3,r-=L,v-=L<<3,g&=(1<<v)-1,e.next_in=r,e.next_out=s,e.avail_in=r<i?5+(i-r):5-(r-i),e.avail_out=s<a?257+(a-s):257-(s-a),M.hold=g,M.bits=v};const xn=15,Qc=852,eu=592,tu=0,Oo=1,ru=2,b1=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),E1=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),R1=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),A1=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),v1=(n,e,t,r,i,s,o,a)=>{const u=a.bits;let l=0,f=0,_=0,I=0,g=0,v=0,x=0,A=0,N=0,K=0,P,$,L,X,V,Y=null,U;const G=new Uint16Array(xn+1),M=new Uint16Array(xn+1);let D=null,w,c,h;for(l=0;l<=xn;l++)G[l]=0;for(f=0;f<r;f++)G[e[t+f]]++;for(g=u,I=xn;I>=1&&G[I]===0;I--);if(g>I&&(g=I),I===0)return i[s++]=1<<24|64<<16|0,i[s++]=1<<24|64<<16|0,a.bits=1,0;for(_=1;_<I&&G[_]===0;_++);for(g<_&&(g=_),A=1,l=1;l<=xn;l++)if(A<<=1,A-=G[l],A<0)return-1;if(A>0&&(n===tu||I!==1))return-1;for(M[1]=0,l=1;l<xn;l++)M[l+1]=M[l]+G[l];for(f=0;f<r;f++)e[t+f]!==0&&(o[M[e[t+f]]++]=f);if(n===tu?(Y=D=o,U=20):n===Oo?(Y=b1,D=E1,U=257):(Y=R1,D=A1,U=0),K=0,f=0,l=_,V=s,v=g,x=0,L=-1,N=1<<g,X=N-1,n===Oo&&N>Qc||n===ru&&N>eu)return 1;for(;;){w=l-x,o[f]+1<U?(c=0,h=o[f]):o[f]>=U?(c=D[o[f]-U],h=Y[o[f]-U]):(c=96,h=0),P=1<<l-x,$=1<<v,_=$;do $-=P,i[V+(K>>x)+$]=w<<24|c<<16|h|0;while($!==0);for(P=1<<l-1;K&P;)P>>=1;if(P!==0?(K&=P-1,K+=P):K=0,f++,--G[l]===0){if(l===I)break;l=e[t+o[f]]}if(l>g&&(K&X)!==L){for(x===0&&(x=g),V+=_,v=l-x,A=1<<v;v+x<I&&(A-=G[v+x],!(A<=0));)v++,A<<=1;if(N+=1<<v,n===Oo&&N>Qc||n===ru&&N>eu)return 1;L=K&X,i[L]=g<<24|v<<16|V-s|0}}return K!==0&&(i[V+K]=l-x<<24|64<<16|0),a.bits=g,0};var di=v1;const S1=0,Zh=1,Yh=2,{Z_FINISH:nu,Z_BLOCK:I1,Z_TREES:Wi,Z_OK:mn,Z_STREAM_END:k1,Z_NEED_DICT:T1,Z_STREAM_ERROR:nr,Z_DATA_ERROR:Xh,Z_MEM_ERROR:Jh,Z_BUF_ERROR:x1,Z_DEFLATED:iu}=qh,Ds=16180,su=16181,ou=16182,au=16183,cu=16184,uu=16185,lu=16186,hu=16187,fu=16188,du=16189,ds=16190,Or=16191,No=16192,pu=16193,Co=16194,yu=16195,gu=16196,mu=16197,wu=16198,Gi=16199,qi=16200,_u=16201,bu=16202,Eu=16203,Ru=16204,Au=16205,Bo=16206,vu=16207,Su=16208,Ge=16209,Qh=16210,ef=16211,O1=852,N1=592,C1=15,B1=C1,Iu=n=>(n>>>24&255)+(n>>>8&65280)+((n&65280)<<8)+((n&255)<<24);function M1(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const An=n=>{if(!n)return 1;const e=n.state;return!e||e.strm!==n||e.mode<Ds||e.mode>ef?1:0},tf=n=>{if(An(n))return nr;const e=n.state;return n.total_in=n.total_out=e.total=0,n.msg="",e.wrap&&(n.adler=e.wrap&1),e.mode=Ds,e.last=0,e.havedict=0,e.flags=-1,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new Int32Array(O1),e.distcode=e.distdyn=new Int32Array(N1),e.sane=1,e.back=-1,mn},rf=n=>{if(An(n))return nr;const e=n.state;return e.wsize=0,e.whave=0,e.wnext=0,tf(n)},nf=(n,e)=>{let t;if(An(n))return nr;const r=n.state;return e<0?(t=0,e=-e):(t=(e>>4)+5,e<48&&(e&=15)),e&&(e<8||e>15)?nr:(r.window!==null&&r.wbits!==e&&(r.window=null),r.wrap=t,r.wbits=e,rf(n))},sf=(n,e)=>{if(!n)return nr;const t=new M1;n.state=t,t.strm=n,t.window=null,t.mode=Ds;const r=nf(n,e);return r!==mn&&(n.state=null),r},L1=n=>sf(n,B1);let ku=!0,Mo,Lo;const P1=n=>{if(ku){Mo=new Int32Array(512),Lo=new Int32Array(32);let e=0;for(;e<144;)n.lens[e++]=8;for(;e<256;)n.lens[e++]=9;for(;e<280;)n.lens[e++]=7;for(;e<288;)n.lens[e++]=8;for(di(Zh,n.lens,0,288,Mo,0,n.work,{bits:9}),e=0;e<32;)n.lens[e++]=5;di(Yh,n.lens,0,32,Lo,0,n.work,{bits:5}),ku=!1}n.lencode=Mo,n.lenbits=9,n.distcode=Lo,n.distbits=5},of=(n,e,t,r)=>{let i;const s=n.state;return s.window===null&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new Uint8Array(s.wsize)),r>=s.wsize?(s.window.set(e.subarray(t-s.wsize,t),0),s.wnext=0,s.whave=s.wsize):(i=s.wsize-s.wnext,i>r&&(i=r),s.window.set(e.subarray(t-r,t-r+i),s.wnext),r-=i,r?(s.window.set(e.subarray(t-r,t),0),s.wnext=r,s.whave=s.wsize):(s.wnext+=i,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=i))),0},U1=(n,e)=>{let t,r,i,s,o,a,u,l,f,_,I,g,v,x,A=0,N,K,P,$,L,X,V,Y;const U=new Uint8Array(4);let G,M;const D=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(An(n)||!n.output||!n.input&&n.avail_in!==0)return nr;t=n.state,t.mode===Or&&(t.mode=No),o=n.next_out,i=n.output,u=n.avail_out,s=n.next_in,r=n.input,a=n.avail_in,l=t.hold,f=t.bits,_=a,I=u,Y=mn;e:for(;;)switch(t.mode){case Ds:if(t.wrap===0){t.mode=No;break}for(;f<16;){if(a===0)break e;a--,l+=r[s++]<<f,f+=8}if(t.wrap&2&&l===35615){t.wbits===0&&(t.wbits=15),t.check=0,U[0]=l&255,U[1]=l>>>8&255,t.check=fr(t.check,U,2,0),l=0,f=0,t.mode=su;break}if(t.head&&(t.head.done=!1),!(t.wrap&1)||(((l&255)<<8)+(l>>8))%31){n.msg="incorrect header check",t.mode=Ge;break}if((l&15)!==iu){n.msg="unknown compression method",t.mode=Ge;break}if(l>>>=4,f-=4,V=(l&15)+8,t.wbits===0&&(t.wbits=V),V>15||V>t.wbits){n.msg="invalid window size",t.mode=Ge;break}t.dmax=1<<t.wbits,t.flags=0,n.adler=t.check=1,t.mode=l&512?du:Or,l=0,f=0;break;case su:for(;f<16;){if(a===0)break e;a--,l+=r[s++]<<f,f+=8}if(t.flags=l,(t.flags&255)!==iu){n.msg="unknown compression method",t.mode=Ge;break}if(t.flags&57344){n.msg="unknown header flags set",t.mode=Ge;break}t.head&&(t.head.text=l>>8&1),t.flags&512&&t.wrap&4&&(U[0]=l&255,U[1]=l>>>8&255,t.check=fr(t.check,U,2,0)),l=0,f=0,t.mode=ou;case ou:for(;f<32;){if(a===0)break e;a--,l+=r[s++]<<f,f+=8}t.head&&(t.head.time=l),t.flags&512&&t.wrap&4&&(U[0]=l&255,U[1]=l>>>8&255,U[2]=l>>>16&255,U[3]=l>>>24&255,t.check=fr(t.check,U,4,0)),l=0,f=0,t.mode=au;case au:for(;f<16;){if(a===0)break e;a--,l+=r[s++]<<f,f+=8}t.head&&(t.head.xflags=l&255,t.head.os=l>>8),t.flags&512&&t.wrap&4&&(U[0]=l&255,U[1]=l>>>8&255,t.check=fr(t.check,U,2,0)),l=0,f=0,t.mode=cu;case cu:if(t.flags&1024){for(;f<16;){if(a===0)break e;a--,l+=r[s++]<<f,f+=8}t.length=l,t.head&&(t.head.extra_len=l),t.flags&512&&t.wrap&4&&(U[0]=l&255,U[1]=l>>>8&255,t.check=fr(t.check,U,2,0)),l=0,f=0}else t.head&&(t.head.extra=null);t.mode=uu;case uu:if(t.flags&1024&&(g=t.length,g>a&&(g=a),g&&(t.head&&(V=t.head.extra_len-t.length,t.head.extra||(t.head.extra=new Uint8Array(t.head.extra_len)),t.head.extra.set(r.subarray(s,s+g),V)),t.flags&512&&t.wrap&4&&(t.check=fr(t.check,r,g,s)),a-=g,s+=g,t.length-=g),t.length))break e;t.length=0,t.mode=lu;case lu:if(t.flags&2048){if(a===0)break e;g=0;do V=r[s+g++],t.head&&V&&t.length<65536&&(t.head.name+=String.fromCharCode(V));while(V&&g<a);if(t.flags&512&&t.wrap&4&&(t.check=fr(t.check,r,g,s)),a-=g,s+=g,V)break e}else t.head&&(t.head.name=null);t.length=0,t.mode=hu;case hu:if(t.flags&4096){if(a===0)break e;g=0;do V=r[s+g++],t.head&&V&&t.length<65536&&(t.head.comment+=String.fromCharCode(V));while(V&&g<a);if(t.flags&512&&t.wrap&4&&(t.check=fr(t.check,r,g,s)),a-=g,s+=g,V)break e}else t.head&&(t.head.comment=null);t.mode=fu;case fu:if(t.flags&512){for(;f<16;){if(a===0)break e;a--,l+=r[s++]<<f,f+=8}if(t.wrap&4&&l!==(t.check&65535)){n.msg="header crc mismatch",t.mode=Ge;break}l=0,f=0}t.head&&(t.head.hcrc=t.flags>>9&1,t.head.done=!0),n.adler=t.check=0,t.mode=Or;break;case du:for(;f<32;){if(a===0)break e;a--,l+=r[s++]<<f,f+=8}n.adler=t.check=Iu(l),l=0,f=0,t.mode=ds;case ds:if(t.havedict===0)return n.next_out=o,n.avail_out=u,n.next_in=s,n.avail_in=a,t.hold=l,t.bits=f,T1;n.adler=t.check=1,t.mode=Or;case Or:if(e===I1||e===Wi)break e;case No:if(t.last){l>>>=f&7,f-=f&7,t.mode=Bo;break}for(;f<3;){if(a===0)break e;a--,l+=r[s++]<<f,f+=8}switch(t.last=l&1,l>>>=1,f-=1,l&3){case 0:t.mode=pu;break;case 1:if(P1(t),t.mode=Gi,e===Wi){l>>>=2,f-=2;break e}break;case 2:t.mode=gu;break;case 3:n.msg="invalid block type",t.mode=Ge}l>>>=2,f-=2;break;case pu:for(l>>>=f&7,f-=f&7;f<32;){if(a===0)break e;a--,l+=r[s++]<<f,f+=8}if((l&65535)!==(l>>>16^65535)){n.msg="invalid stored block lengths",t.mode=Ge;break}if(t.length=l&65535,l=0,f=0,t.mode=Co,e===Wi)break e;case Co:t.mode=yu;case yu:if(g=t.length,g){if(g>a&&(g=a),g>u&&(g=u),g===0)break e;i.set(r.subarray(s,s+g),o),a-=g,s+=g,u-=g,o+=g,t.length-=g;break}t.mode=Or;break;case gu:for(;f<14;){if(a===0)break e;a--,l+=r[s++]<<f,f+=8}if(t.nlen=(l&31)+257,l>>>=5,f-=5,t.ndist=(l&31)+1,l>>>=5,f-=5,t.ncode=(l&15)+4,l>>>=4,f-=4,t.nlen>286||t.ndist>30){n.msg="too many length or distance symbols",t.mode=Ge;break}t.have=0,t.mode=mu;case mu:for(;t.have<t.ncode;){for(;f<3;){if(a===0)break e;a--,l+=r[s++]<<f,f+=8}t.lens[D[t.have++]]=l&7,l>>>=3,f-=3}for(;t.have<19;)t.lens[D[t.have++]]=0;if(t.lencode=t.lendyn,t.lenbits=7,G={bits:t.lenbits},Y=di(S1,t.lens,0,19,t.lencode,0,t.work,G),t.lenbits=G.bits,Y){n.msg="invalid code lengths set",t.mode=Ge;break}t.have=0,t.mode=wu;case wu:for(;t.have<t.nlen+t.ndist;){for(;A=t.lencode[l&(1<<t.lenbits)-1],N=A>>>24,K=A>>>16&255,P=A&65535,!(N<=f);){if(a===0)break e;a--,l+=r[s++]<<f,f+=8}if(P<16)l>>>=N,f-=N,t.lens[t.have++]=P;else{if(P===16){for(M=N+2;f<M;){if(a===0)break e;a--,l+=r[s++]<<f,f+=8}if(l>>>=N,f-=N,t.have===0){n.msg="invalid bit length repeat",t.mode=Ge;break}V=t.lens[t.have-1],g=3+(l&3),l>>>=2,f-=2}else if(P===17){for(M=N+3;f<M;){if(a===0)break e;a--,l+=r[s++]<<f,f+=8}l>>>=N,f-=N,V=0,g=3+(l&7),l>>>=3,f-=3}else{for(M=N+7;f<M;){if(a===0)break e;a--,l+=r[s++]<<f,f+=8}l>>>=N,f-=N,V=0,g=11+(l&127),l>>>=7,f-=7}if(t.have+g>t.nlen+t.ndist){n.msg="invalid bit length repeat",t.mode=Ge;break}for(;g--;)t.lens[t.have++]=V}}if(t.mode===Ge)break;if(t.lens[256]===0){n.msg="invalid code -- missing end-of-block",t.mode=Ge;break}if(t.lenbits=9,G={bits:t.lenbits},Y=di(Zh,t.lens,0,t.nlen,t.lencode,0,t.work,G),t.lenbits=G.bits,Y){n.msg="invalid literal/lengths set",t.mode=Ge;break}if(t.distbits=6,t.distcode=t.distdyn,G={bits:t.distbits},Y=di(Yh,t.lens,t.nlen,t.ndist,t.distcode,0,t.work,G),t.distbits=G.bits,Y){n.msg="invalid distances set",t.mode=Ge;break}if(t.mode=Gi,e===Wi)break e;case Gi:t.mode=qi;case qi:if(a>=6&&u>=258){n.next_out=o,n.avail_out=u,n.next_in=s,n.avail_in=a,t.hold=l,t.bits=f,_1(n,I),o=n.next_out,i=n.output,u=n.avail_out,s=n.next_in,r=n.input,a=n.avail_in,l=t.hold,f=t.bits,t.mode===Or&&(t.back=-1);break}for(t.back=0;A=t.lencode[l&(1<<t.lenbits)-1],N=A>>>24,K=A>>>16&255,P=A&65535,!(N<=f);){if(a===0)break e;a--,l+=r[s++]<<f,f+=8}if(K&&!(K&240)){for($=N,L=K,X=P;A=t.lencode[X+((l&(1<<$+L)-1)>>$)],N=A>>>24,K=A>>>16&255,P=A&65535,!($+N<=f);){if(a===0)break e;a--,l+=r[s++]<<f,f+=8}l>>>=$,f-=$,t.back+=$}if(l>>>=N,f-=N,t.back+=N,t.length=P,K===0){t.mode=Au;break}if(K&32){t.back=-1,t.mode=Or;break}if(K&64){n.msg="invalid literal/length code",t.mode=Ge;break}t.extra=K&15,t.mode=_u;case _u:if(t.extra){for(M=t.extra;f<M;){if(a===0)break e;a--,l+=r[s++]<<f,f+=8}t.length+=l&(1<<t.extra)-1,l>>>=t.extra,f-=t.extra,t.back+=t.extra}t.was=t.length,t.mode=bu;case bu:for(;A=t.distcode[l&(1<<t.distbits)-1],N=A>>>24,K=A>>>16&255,P=A&65535,!(N<=f);){if(a===0)break e;a--,l+=r[s++]<<f,f+=8}if(!(K&240)){for($=N,L=K,X=P;A=t.distcode[X+((l&(1<<$+L)-1)>>$)],N=A>>>24,K=A>>>16&255,P=A&65535,!($+N<=f);){if(a===0)break e;a--,l+=r[s++]<<f,f+=8}l>>>=$,f-=$,t.back+=$}if(l>>>=N,f-=N,t.back+=N,K&64){n.msg="invalid distance code",t.mode=Ge;break}t.offset=P,t.extra=K&15,t.mode=Eu;case Eu:if(t.extra){for(M=t.extra;f<M;){if(a===0)break e;a--,l+=r[s++]<<f,f+=8}t.offset+=l&(1<<t.extra)-1,l>>>=t.extra,f-=t.extra,t.back+=t.extra}if(t.offset>t.dmax){n.msg="invalid distance too far back",t.mode=Ge;break}t.mode=Ru;case Ru:if(u===0)break e;if(g=I-u,t.offset>g){if(g=t.offset-g,g>t.whave&&t.sane){n.msg="invalid distance too far back",t.mode=Ge;break}g>t.wnext?(g-=t.wnext,v=t.wsize-g):v=t.wnext-g,g>t.length&&(g=t.length),x=t.window}else x=i,v=o-t.offset,g=t.length;g>u&&(g=u),u-=g,t.length-=g;do i[o++]=x[v++];while(--g);t.length===0&&(t.mode=qi);break;case Au:if(u===0)break e;i[o++]=t.length,u--,t.mode=qi;break;case Bo:if(t.wrap){for(;f<32;){if(a===0)break e;a--,l|=r[s++]<<f,f+=8}if(I-=u,n.total_out+=I,t.total+=I,t.wrap&4&&I&&(n.adler=t.check=t.flags?fr(t.check,i,I,o-I):ta(t.check,i,I,o-I)),I=u,t.wrap&4&&(t.flags?l:Iu(l))!==t.check){n.msg="incorrect data check",t.mode=Ge;break}l=0,f=0}t.mode=vu;case vu:if(t.wrap&&t.flags){for(;f<32;){if(a===0)break e;a--,l+=r[s++]<<f,f+=8}if(t.wrap&4&&l!==(t.total&4294967295)){n.msg="incorrect length check",t.mode=Ge;break}l=0,f=0}t.mode=Su;case Su:Y=k1;break e;case Ge:Y=Xh;break e;case Qh:return Jh;case ef:default:return nr}return n.next_out=o,n.avail_out=u,n.next_in=s,n.avail_in=a,t.hold=l,t.bits=f,(t.wsize||I!==n.avail_out&&t.mode<Ge&&(t.mode<Bo||e!==nu))&&of(n,n.output,n.next_out,I-n.avail_out),_-=n.avail_in,I-=n.avail_out,n.total_in+=_,n.total_out+=I,t.total+=I,t.wrap&4&&I&&(n.adler=t.check=t.flags?fr(t.check,i,I,n.next_out-I):ta(t.check,i,I,n.next_out-I)),n.data_type=t.bits+(t.last?64:0)+(t.mode===Or?128:0)+(t.mode===Gi||t.mode===Co?256:0),(_===0&&I===0||e===nu)&&Y===mn&&(Y=x1),Y},D1=n=>{if(An(n))return nr;let e=n.state;return e.window&&(e.window=null),n.state=null,mn},F1=(n,e)=>{if(An(n))return nr;const t=n.state;return t.wrap&2?(t.head=e,e.done=!1,mn):nr},H1=(n,e)=>{const t=e.length;let r,i,s;return An(n)||(r=n.state,r.wrap!==0&&r.mode!==ds)?nr:r.mode===ds&&(i=1,i=ta(i,e,t,0),i!==r.check)?Xh:(s=of(n,e,t,t),s?(r.mode=Qh,Jh):(r.havedict=1,mn))};var z1=rf,$1=nf,K1=tf,W1=L1,G1=sf,q1=U1,V1=D1,j1=F1,Z1=H1,Y1="pako inflate (from Nodeca project)",Br={inflateReset:z1,inflateReset2:$1,inflateResetKeep:K1,inflateInit:W1,inflateInit2:G1,inflate:q1,inflateEnd:V1,inflateGetHeader:j1,inflateSetDictionary:Z1,inflateInfo:Y1};function X1(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var J1=X1;const af=Object.prototype.toString,{Z_NO_FLUSH:Q1,Z_FINISH:e_,Z_OK:Ri,Z_STREAM_END:Po,Z_NEED_DICT:Uo,Z_STREAM_ERROR:t_,Z_DATA_ERROR:Tu,Z_MEM_ERROR:r_}=qh;function Fs(n){this.options=Vh.assign({chunkSize:1024*64,windowBits:15,to:""},n||{});const e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,e.windowBits===0&&(e.windowBits=-15)),e.windowBits>=0&&e.windowBits<16&&!(n&&n.windowBits)&&(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&(e.windowBits&15||(e.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new m1,this.strm.avail_out=0;let t=Br.inflateInit2(this.strm,e.windowBits);if(t!==Ri)throw new Error(ra[t]);if(this.header=new J1,Br.inflateGetHeader(this.strm,this.header),e.dictionary&&(typeof e.dictionary=="string"?e.dictionary=na.string2buf(e.dictionary):af.call(e.dictionary)==="[object ArrayBuffer]"&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(t=Br.inflateSetDictionary(this.strm,e.dictionary),t!==Ri)))throw new Error(ra[t])}Fs.prototype.push=function(n,e){const t=this.strm,r=this.options.chunkSize,i=this.options.dictionary;let s,o,a;if(this.ended)return!1;for(e===~~e?o=e:o=e===!0?e_:Q1,af.call(n)==="[object ArrayBuffer]"?t.input=new Uint8Array(n):t.input=n,t.next_in=0,t.avail_in=t.input.length;;){for(t.avail_out===0&&(t.output=new Uint8Array(r),t.next_out=0,t.avail_out=r),s=Br.inflate(t,o),s===Uo&&i&&(s=Br.inflateSetDictionary(t,i),s===Ri?s=Br.inflate(t,o):s===Tu&&(s=Uo));t.avail_in>0&&s===Po&&t.state.wrap>0&&n[t.next_in]!==0;)Br.inflateReset(t),s=Br.inflate(t,o);switch(s){case t_:case Tu:case Uo:case r_:return this.onEnd(s),this.ended=!0,!1}if(a=t.avail_out,t.next_out&&(t.avail_out===0||s===Po))if(this.options.to==="string"){let u=na.utf8border(t.output,t.next_out),l=t.next_out-u,f=na.buf2string(t.output,u);t.next_out=l,t.avail_out=r-l,l&&t.output.set(t.output.subarray(u,u+l),0),this.onData(f)}else this.onData(t.output.length===t.next_out?t.output:t.output.subarray(0,t.next_out));if(!(s===Ri&&a===0)){if(s===Po)return s=Br.inflateEnd(this.strm),this.onEnd(s),this.ended=!0,!0;if(t.avail_in===0)break}}return!0};Fs.prototype.onData=function(n){this.chunks.push(n)};Fs.prototype.onEnd=function(n){n===Ri&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=Vh.flattenChunks(this.chunks)),this.chunks=[],this.err=n,this.msg=this.strm.msg};function n_(n,e){const t=new Fs(e);if(t.push(n),t.err)throw t.msg||ra[t.err];return t.result}var i_=n_,s_={inflate:i_};const{inflate:o_}=s_;var a_=o_,cf={exports:{}};(function(n){var e=Object.prototype.hasOwnProperty,t="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(t=!1));function i(u,l,f){this.fn=u,this.context=l,this.once=f||!1}function s(u,l,f,_,I){if(typeof f!="function")throw new TypeError("The listener must be a function");var g=new i(f,_||u,I),v=t?t+l:l;return u._events[v]?u._events[v].fn?u._events[v]=[u._events[v],g]:u._events[v].push(g):(u._events[v]=g,u._eventsCount++),u}function o(u,l){--u._eventsCount===0?u._events=new r:delete u._events[l]}function a(){this._events=new r,this._eventsCount=0}a.prototype.eventNames=function(){var l=[],f,_;if(this._eventsCount===0)return l;for(_ in f=this._events)e.call(f,_)&&l.push(t?_.slice(1):_);return Object.getOwnPropertySymbols?l.concat(Object.getOwnPropertySymbols(f)):l},a.prototype.listeners=function(l){var f=t?t+l:l,_=this._events[f];if(!_)return[];if(_.fn)return[_.fn];for(var I=0,g=_.length,v=new Array(g);I<g;I++)v[I]=_[I].fn;return v},a.prototype.listenerCount=function(l){var f=t?t+l:l,_=this._events[f];return _?_.fn?1:_.length:0},a.prototype.emit=function(l,f,_,I,g,v){var x=t?t+l:l;if(!this._events[x])return!1;var A=this._events[x],N=arguments.length,K,P;if(A.fn){switch(A.once&&this.removeListener(l,A.fn,void 0,!0),N){case 1:return A.fn.call(A.context),!0;case 2:return A.fn.call(A.context,f),!0;case 3:return A.fn.call(A.context,f,_),!0;case 4:return A.fn.call(A.context,f,_,I),!0;case 5:return A.fn.call(A.context,f,_,I,g),!0;case 6:return A.fn.call(A.context,f,_,I,g,v),!0}for(P=1,K=new Array(N-1);P<N;P++)K[P-1]=arguments[P];A.fn.apply(A.context,K)}else{var $=A.length,L;for(P=0;P<$;P++)switch(A[P].once&&this.removeListener(l,A[P].fn,void 0,!0),N){case 1:A[P].fn.call(A[P].context);break;case 2:A[P].fn.call(A[P].context,f);break;case 3:A[P].fn.call(A[P].context,f,_);break;case 4:A[P].fn.call(A[P].context,f,_,I);break;default:if(!K)for(L=1,K=new Array(N-1);L<N;L++)K[L-1]=arguments[L];A[P].fn.apply(A[P].context,K)}}return!0},a.prototype.on=function(l,f,_){return s(this,l,f,_,!1)},a.prototype.once=function(l,f,_){return s(this,l,f,_,!0)},a.prototype.removeListener=function(l,f,_,I){var g=t?t+l:l;if(!this._events[g])return this;if(!f)return o(this,g),this;var v=this._events[g];if(v.fn)v.fn===f&&(!I||v.once)&&(!_||v.context===_)&&o(this,g);else{for(var x=0,A=[],N=v.length;x<N;x++)(v[x].fn!==f||I&&!v[x].once||_&&v[x].context!==_)&&A.push(v[x]);A.length?this._events[g]=A.length===1?A[0]:A:o(this,g)}return this},a.prototype.removeAllListeners=function(l){var f;return l?(f=t?t+l:l,this._events[f]&&o(this,f)):(this._events=new r,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=t,a.EventEmitter=a,n.exports=a})(cf);var c_=cf.exports;const u_=Vn(c_);function l_(n,e){return Array.apply(0,new Array(Math.ceil(n.length/e))).map((t,r)=>n.slice(r*e,(r+1)*e))}const sn=n=>"version"in n;function h_(n){return new TextDecoder("utf-8").decode(n)}function xu(n){return Et.encode(n)}function uf(n){return te.Buffer.from(n,"base64")}function jr(n){return"accounts"in n}async function f_(n){const e=(await j.findProgramAddress([],n))[0];return await j.createWithSeed(e,d_(),n)}function d_(){return"anchor:idl"}const p_=ge.struct([ge.publicKey("authority"),ge.vecU8("data")]);function y_(n){return p_.decode(n)}function g_(n){const e=["name","path","account","relations","generic"],t=s=>s.split(".").map(zw).join("."),r=s=>{for(const o in s){const a=s[o];e.includes(o)?s[o]=Array.isArray(a)?a.map(t):t(a):typeof a=="object"&&r(a)}},i=structuredClone(n);return r(i),i}function Mn(n,e,t,r){return n!=null&&n.length?n[0].name?t(n):r(n):e()}function m_(n){const e=new Map;return n.errors&&n.errors.forEach(t=>{var r;let i=(r=t.msg)!==null&&r!==void 0?r:t.name;e.set(t.code,i)}),e}function w_(n,...e){if(n.args.length!=e.length)throw new Error("Invalid argument length");const t={};let r=0;return n.args.forEach(i=>{t[i.name]=e[r],r+=1}),t}function lf(n,e={}){n.forEach(t=>{if(jr(t))lf(t.accounts,e[t.name]);else if(!e[t.name])throw new Error(`Account \`${t.name}\` not provided.`)})}function ar(n){return n instanceof j?n:new j(n)}class __ extends TypeError{constructor(e,t){let r;const{message:i,...s}=e,{path:o}=e,a=o.length===0?i:"At path: "+o.join(".")+" -- "+i;super(a),this.value=void 0,this.key=void 0,this.type=void 0,this.refinement=void 0,this.path=void 0,this.branch=void 0,this.failures=void 0,Object.assign(this,s),this.name=this.constructor.name,this.failures=()=>{var u;return(u=r)!=null?u:r=[e,...t()]}}}function b_(n){return Dn(n)&&typeof n[Symbol.iterator]=="function"}function Dn(n){return typeof n=="object"&&n!=null}function rn(n){return typeof n=="string"?JSON.stringify(n):""+n}function E_(n){const{done:e,value:t}=n.next();return e?void 0:t}function R_(n,e,t,r){if(n===!0)return;n===!1?n={}:typeof n=="string"&&(n={message:n});const{path:i,branch:s}=e,{type:o}=t,{refinement:a,message:u="Expected a value of type `"+o+"`"+(a?" with refinement `"+a+"`":"")+", but received: `"+rn(r)+"`"}=n;return{value:r,type:o,refinement:a,key:i[i.length-1],path:i,branch:s,...n,message:u}}function*Ou(n,e,t,r){b_(n)||(n=[n]);for(const i of n){const s=R_(i,e,t,r);s&&(yield s)}}function*Ja(n,e,t){t===void 0&&(t={});const{path:r=[],branch:i=[n],coerce:s=!1,mask:o=!1}=t,a={path:r,branch:i};if(s&&(n=e.coercer(n,a),o&&e.type!=="type"&&Dn(e.schema)&&Dn(n)&&!Array.isArray(n)))for(const l in n)e.schema[l]===void 0&&delete n[l];let u=!0;for(const l of e.validator(n,a))u=!1,yield[l,void 0];for(let[l,f,_]of e.entries(n,a)){const I=Ja(f,_,{path:l===void 0?r:[...r,l],branch:l===void 0?i:[...i,f],coerce:s,mask:o});for(const g of I)g[0]?(u=!1,yield[g[0],void 0]):s&&(f=g[1],l===void 0?n=f:n instanceof Map?n.set(l,f):n instanceof Set?n.add(f):Dn(n)&&(n[l]=f))}if(u)for(const l of e.refiner(n,a))u=!1,yield[l,void 0];u&&(yield[void 0,n])}class nn{constructor(e){this.TYPE=void 0,this.type=void 0,this.schema=void 0,this.coercer=void 0,this.validator=void 0,this.refiner=void 0,this.entries=void 0;const{type:t,schema:r,validator:i,refiner:s,coercer:o=u=>u,entries:a=function*(){}}=e;this.type=t,this.schema=r,this.entries=a,this.coercer=o,i?this.validator=(u,l)=>{const f=i(u,l);return Ou(f,l,this,u)}:this.validator=()=>[],s?this.refiner=(u,l)=>{const f=s(u,l);return Ou(f,l,this,u)}:this.refiner=()=>[]}assert(e){return A_(e,this)}create(e){return Qa(e,this)}is(e){return hf(e,this)}mask(e){return v_(e,this)}validate(e,t){return t===void 0&&(t={}),Ti(e,this,t)}}function A_(n,e){const t=Ti(n,e);if(t[0])throw t[0]}function Qa(n,e){const t=Ti(n,e,{coerce:!0});if(t[0])throw t[0];return t[1]}function v_(n,e){const t=Ti(n,e,{coerce:!0,mask:!0});if(t[0])throw t[0];return t[1]}function hf(n,e){return!Ti(n,e)[0]}function Ti(n,e,t){t===void 0&&(t={});const r=Ja(n,e,t),i=E_(r);return i[0]?[new __(i[0],function*(){for(const o of r)o[0]&&(yield o[0])}),void 0]:[void 0,i[1]]}function xi(n,e){return new nn({type:n,schema:null,validator:e})}function S_(){return xi("any",()=>!0)}function Do(n){return new nn({type:"array",schema:n,*entries(e){if(n&&Array.isArray(e))for(const[t,r]of e.entries())yield[t,r,n]},coercer(e){return Array.isArray(e)?e.slice():e},validator(e){return Array.isArray(e)||"Expected an array value, but received: "+rn(e)}})}function I_(){return xi("boolean",n=>typeof n=="boolean")}function Nu(n){const e=rn(n);return new nn({type:"literal",schema:n,validator(t){return t===n||"Expected the literal `"+e+"`, but received: "+rn(t)}})}function Vi(n){return new nn({...n,validator:(e,t)=>e===null||n.validator(e,t),refiner:(e,t)=>e===null||n.refiner(e,t)})}function es(){return xi("number",n=>typeof n=="number"&&!isNaN(n)||"Expected a number, but received: "+rn(n))}function ts(n){return new nn({...n,validator:(e,t)=>e===void 0||n.validator(e,t),refiner:(e,t)=>e===void 0||n.refiner(e,t)})}function fn(){return xi("string",n=>typeof n=="string"||"Expected a string, but received: "+rn(n))}function Qr(n){const e=Object.keys(n);return new nn({type:"type",schema:n,*entries(t){if(Dn(t))for(const r of e)yield[r,t[r],n[r]]},validator(t){return Dn(t)||"Expected an object, but received: "+rn(t)}})}function ff(n){const e=n.map(t=>t.type).join(" | ");return new nn({type:"union",schema:null,coercer(t,r){return(n.find(s=>{const[o]=s.validate(t,{coerce:!0});return!o})||ec()).coercer(t,r)},validator(t,r){const i=[];for(const s of n){const[...o]=Ja(t,s,r),[a]=o;if(a[0])for(const[u]of o)u&&i.push(u);else return[]}return["Expected the value to satisfy a union of `"+e+"`, but received: "+rn(t),...i]}})}function ec(){return xi("unknown",()=>!0)}function k_(n,e,t){return new nn({...n,coercer:(r,i)=>hf(r,e)?n.coercer(t(r,i),i):n.coercer(r,i)})}const Cu=99;async function T_(n,e,t){if(e.length<=Cu)return await Bu(n,e,t);{const r=l_(e,Cu);return(await Promise.all(r.map(s=>Bu(n,s,t)))).flat()}}async function Bu(n,e,t){const r=t??n.commitment,{value:i,context:s}=await n.getMultipleAccountsInfoAndContext(e,r);return i.map((a,u)=>a===null?null:{publicKey:e[u],account:a,context:s})}async function x_(n,e,t,r,i){var s;t&&t.length>0&&e.sign(...t);const o=e._compile(),a=o.serialize(),l=e._serialize(a).toString("base64"),f={encoding:"base64",commitment:r??n.commitment};if(i){const v=(Array.isArray(i)?i:o.nonProgramIds()).map(x=>x.toBase58());f.accounts={encoding:"base64",addresses:v}}t&&t.length>0&&(f.sigVerify=!0);const _=[l,f],I=await n._rpcRequest("simulateTransaction",_),g=Qa(I,B_);if("error"in g){let v;if("data"in g.error&&(v=(s=g.error.data)===null||s===void 0?void 0:s.logs,v&&Array.isArray(v))){const x=`
    `,A=x+v.join(x);console.error(g.error.message,A)}throw new tn("failed to simulate transaction: "+g.error.message,v)}return g.result}function O_(n){return k_(df(n),N_,e=>"error"in e?e:{...e,result:Qa(e.result,n)})}const N_=df(ec());function df(n){return ff([Qr({jsonrpc:Nu("2.0"),id:fn(),result:n}),Qr({jsonrpc:Nu("2.0"),id:fn(),error:Qr({code:ec(),message:fn(),data:ts(S_())})})])}function C_(n){return O_(Qr({context:Qr({slot:es()}),value:n}))}const B_=C_(Qr({err:Vi(ff([Qr({}),fn()])),logs:Vi(Do(fn())),accounts:ts(Vi(Do(Vi(Qr({executable:I_(),owner:fn(),lamports:es(),data:Do(fn()),rentEpoch:ts(es())}))))),unitsConsumed:ts(es())}));class Gn{constructor(e,t,r=Gn.defaultOptions()){this.connection=e,this.wallet=t,this.opts=r,this.publicKey=t==null?void 0:t.publicKey}static defaultOptions(){return{preflightCommitment:"processed",commitment:"processed"}}static local(e,t=Gn.defaultOptions()){throw new Error("Provider local is not available on browser.")}static env(){throw new Error("Provider env is not available on browser.")}async sendAndConfirm(e,t,r){var i,s,o,a;if(r===void 0&&(r=this.opts),sn(e))t&&e.sign(t);else if(e.feePayer=(i=e.feePayer)!==null&&i!==void 0?i:this.wallet.publicKey,e.recentBlockhash=(await this.connection.getLatestBlockhash(r.preflightCommitment)).blockhash,t)for(const l of t)e.partialSign(l);e=await this.wallet.signTransaction(e);const u=e.serialize();try{return await Mu(this.connection,u,r)}catch(l){if(l instanceof ia){const f=xu(sn(e)?((s=e.signatures)===null||s===void 0?void 0:s[0])||new Uint8Array:(o=e.signature)!==null&&o!==void 0?o:new Uint8Array),_=sn(e)?0:void 0,I=await this.connection.getTransaction(f,{commitment:"confirmed",maxSupportedTransactionVersion:_});if(I){const g=(a=I.meta)===null||a===void 0?void 0:a.logMessages;throw g?new tn(l.message,g):l}else throw l}else throw l}}async sendAll(e,t){var r,i,s;t===void 0&&(t=this.opts);const o=(await this.connection.getLatestBlockhash(t.preflightCommitment)).blockhash;let a=e.map(f=>{var _,I;if(sn(f.tx)){let g=f.tx;return f.signers&&g.sign(f.signers),g}else{let g=f.tx,v=(_=f.signers)!==null&&_!==void 0?_:[];return g.feePayer=(I=g.feePayer)!==null&&I!==void 0?I:this.wallet.publicKey,g.recentBlockhash=o,v.forEach(x=>{g.partialSign(x)}),g}});const u=await this.wallet.signAllTransactions(a),l=[];for(let f=0;f<a.length;f+=1){const _=u[f],I=_.serialize();try{l.push(await Mu(this.connection,I,t))}catch(g){if(g instanceof ia){const v=xu(sn(_)?((r=_.signatures)===null||r===void 0?void 0:r[0])||new Uint8Array:(i=_.signature)!==null&&i!==void 0?i:new Uint8Array),x=sn(_)?0:void 0,A=await this.connection.getTransaction(v,{commitment:"confirmed",maxSupportedTransactionVersion:x});if(A){const N=(s=A.meta)===null||s===void 0?void 0:s.logMessages;throw N?new tn(g.message,N):g}else throw g}else throw g}}return l}async simulate(e,t,r,i){let s=(await this.connection.getLatestBlockhash(r??this.connection.commitment)).blockhash,o;if(sn(e)?(t&&t.length>0&&(e.sign(t),e=await this.wallet.signTransaction(e)),o=await this.connection.simulateTransaction(e,{commitment:r})):(e.feePayer=e.feePayer||this.wallet.publicKey,e.recentBlockhash=s,t&&t.length>0&&(e=await this.wallet.signTransaction(e)),o=await x_(this.connection,e,t,r,i)),o.value.err)throw new M_(o.value);return o.value}}class M_ extends Error{constructor(e,t){super(t),this.simulationResponse=e}}async function Mu(n,e,t){const r=t?{skipPreflight:t.skipPreflight,preflightCommitment:t.preflightCommitment||t.commitment,maxRetries:t.maxRetries,minContextSlot:t.minContextSlot}:{};let i;const s=Date.now();for(;Date.now()-s<6e4;)try{const o=await n.sendRawTransaction(e,r);if(t!=null&&t.blockhash)if(r.maxRetries===0){const a=AbortSignal.timeout(15e3);i=(await n.confirmTransaction({abortSignal:a,signature:o,...t.blockhash},t&&t.commitment)).value}else i=(await n.confirmTransaction({signature:o,...t.blockhash},t&&t.commitment)).value;else i=(await n.confirmTransaction(o,t&&t.commitment)).value;if(i.err)throw new ia(`Raw transaction ${o} failed (${JSON.stringify(i)})`);return o}catch(o){if(o.name==="TimeoutError")continue;throw o}throw Error("Transaction failed to confirm in 60s")}class ia extends Error{constructor(e){super(e)}}function L_(n){oa=n}function sa(){return oa===null?Gn.local():oa}let oa=null;var P_=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},z={};Object.defineProperty(z,"__esModule",{value:!0});var pf=z.ANCHOR_ERROR__REQUIRE_EQ_VIOLATED=ld=z.ANCHOR_ERROR__REQUIRE_VIOLATED=ud=z.ANCHOR_ERROR__CONSTRAINT_MINT_TRANSFER_HOOK_EXTENSION_PROGRAM_ID=cd=z.ANCHOR_ERROR__CONSTRAINT_MINT_TRANSFER_HOOK_EXTENSION_AUTHORITY=ad=z.ANCHOR_ERROR__CONSTRAINT_MINT_TRANSFER_HOOK_EXTENSION=od=z.ANCHOR_ERROR__CONSTRAINT_MINT_PERMANENT_DELEGATE_EXTENSION_DELEGATE=sd=z.ANCHOR_ERROR__CONSTRAINT_MINT_PERMANENT_DELEGATE_EXTENSION=id=z.ANCHOR_ERROR__CONSTRAINT_MINT_CLOSE_AUTHORITY_EXTENSION_AUTHORITY=nd=z.ANCHOR_ERROR__CONSTRAINT_MINT_CLOSE_AUTHORITY_EXTENSION=rd=z.ANCHOR_ERROR__CONSTRAINT_MINT_METADATA_POINTER_EXTENSION_METADATA_ADDRESS=td=z.ANCHOR_ERROR__CONSTRAINT_MINT_METADATA_POINTER_EXTENSION_AUTHORITY=ed=z.ANCHOR_ERROR__CONSTRAINT_MINT_METADATA_POINTER_EXTENSION=Qf=z.ANCHOR_ERROR__CONSTRAINT_MINT_GROUP_MEMBER_POINTER_EXTENSION_MEMBER_ADDRESS=Jf=z.ANCHOR_ERROR__CONSTRAINT_MINT_GROUP_MEMBER_POINTER_EXTENSION_AUTHORITY=Xf=z.ANCHOR_ERROR__CONSTRAINT_MINT_GROUP_MEMBER_POINTER_EXTENSION=Yf=z.ANCHOR_ERROR__CONSTRAINT_MINT_GROUP_POINTER_EXTENSION_GROUP_ADDRESS=Zf=z.ANCHOR_ERROR__CONSTRAINT_MINT_GROUP_POINTER_EXTENSION_AUTHORITY=jf=z.ANCHOR_ERROR__CONSTRAINT_MINT_GROUP_POINTER_EXTENSION=Vf=z.ANCHOR_ERROR__CONSTRAINT_ASSOCIATED_TOKEN_TOKEN_PROGRAM=qf=z.ANCHOR_ERROR__CONSTRAINT_MINT_TOKEN_PROGRAM=Gf=z.ANCHOR_ERROR__CONSTRAINT_TOKEN_TOKEN_PROGRAM=Wf=z.ANCHOR_ERROR__CONSTRAINT_ACCOUNT_IS_NONE=Kf=z.ANCHOR_ERROR__CONSTRAINT_SPACE=$f=z.ANCHOR_ERROR__CONSTRAINT_MINT_DECIMALS=zf=z.ANCHOR_ERROR__CONSTRAINT_MINT_FREEZE_AUTHORITY=Hf=z.ANCHOR_ERROR__CONSTRAINT_MINT_MINT_AUTHORITY=Ff=z.ANCHOR_ERROR__CONSTRAINT_TOKEN_OWNER=Df=z.ANCHOR_ERROR__CONSTRAINT_TOKEN_MINT=Uf=z.ANCHOR_ERROR__CONSTRAINT_ZERO=Pf=z.ANCHOR_ERROR__CONSTRAINT_ADDRESS=Lf=z.ANCHOR_ERROR__CONSTRAINT_CLOSE=Mf=z.ANCHOR_ERROR__CONSTRAINT_ASSOCIATED_INIT=Bf=z.ANCHOR_ERROR__CONSTRAINT_ASSOCIATED=Cf=z.ANCHOR_ERROR__CONSTRAINT_STATE=Nf=z.ANCHOR_ERROR__CONSTRAINT_EXECUTABLE=Of=z.ANCHOR_ERROR__CONSTRAINT_SEEDS=xf=z.ANCHOR_ERROR__CONSTRAINT_RENT_EXEMPT=Tf=z.ANCHOR_ERROR__CONSTRAINT_OWNER=kf=z.ANCHOR_ERROR__CONSTRAINT_RAW=If=z.ANCHOR_ERROR__CONSTRAINT_SIGNER=Sf=z.ANCHOR_ERROR__CONSTRAINT_HAS_ONE=vf=z.ANCHOR_ERROR__CONSTRAINT_MUT=Af=z.ANCHOR_ERROR__EVENT_INSTRUCTION_STUB=Rf=z.ANCHOR_ERROR__IDL_ACCOUNT_NOT_EMPTY=Ef=z.ANCHOR_ERROR__IDL_INSTRUCTION_INVALID_PROGRAM=bf=z.ANCHOR_ERROR__IDL_INSTRUCTION_STUB=_f=z.ANCHOR_ERROR__INSTRUCTION_DID_NOT_SERIALIZE=wf=z.ANCHOR_ERROR__INSTRUCTION_DID_NOT_DESERIALIZE=mf=z.ANCHOR_ERROR__INSTRUCTION_FALLBACK_NOT_FOUND=gf=z.ANCHOR_ERROR__INSTRUCTION_MISSING=void 0,yf=z.ANCHOR_ERROR__DEPRECATED=Pd=z.ANCHOR_ERROR__INVALID_NUMERIC_CONVERSION=Ld=z.ANCHOR_ERROR__TRYING_TO_INIT_PAYER_AS_PROGRAM_ACCOUNT=Md=z.ANCHOR_ERROR__DECLARED_PROGRAM_ID_MISMATCH=Bd=z.ANCHOR_ERROR__ACCOUNT_DUPLICATE_REALLOCS=Cd=z.ANCHOR_ERROR__ACCOUNT_REALLOC_EXCEEDS_LIMIT=Nd=z.ANCHOR_ERROR__ACCOUNT_SYSVAR_MISMATCH=Od=z.ANCHOR_ERROR__ACCOUNT_NOT_ASSOCIATED_TOKEN_ACCOUNT=xd=z.ANCHOR_ERROR__ACCOUNT_NOT_PROGRAM_DATA=Td=z.ANCHOR_ERROR__ACCOUNT_NOT_INITIALIZED=kd=z.ANCHOR_ERROR__ACCOUNT_NOT_SYSTEM_OWNED=Id=z.ANCHOR_ERROR__ACCOUNT_NOT_SIGNER=Sd=z.ANCHOR_ERROR__INVALID_PROGRAM_EXECUTABLE=vd=z.ANCHOR_ERROR__INVALID_PROGRAM_ID=Ad=z.ANCHOR_ERROR__ACCOUNT_OWNED_BY_WRONG_PROGRAM=Rd=z.ANCHOR_ERROR__ACCOUNT_NOT_MUTABLE=Ed=z.ANCHOR_ERROR__ACCOUNT_NOT_ENOUGH_KEYS=bd=z.ANCHOR_ERROR__ACCOUNT_DID_NOT_SERIALIZE=_d=z.ANCHOR_ERROR__ACCOUNT_DID_NOT_DESERIALIZE=wd=z.ANCHOR_ERROR__ACCOUNT_DISCRIMINATOR_MISMATCH=md=z.ANCHOR_ERROR__ACCOUNT_DISCRIMINATOR_NOT_FOUND=gd=z.ANCHOR_ERROR__ACCOUNT_DISCRIMINATOR_ALREADY_SET=yd=z.ANCHOR_ERROR__REQUIRE_GTE_VIOLATED=pd=z.ANCHOR_ERROR__REQUIRE_GT_VIOLATED=dd=z.ANCHOR_ERROR__REQUIRE_KEYS_NEQ_VIOLATED=fd=z.ANCHOR_ERROR__REQUIRE_NEQ_VIOLATED=hd=z.ANCHOR_ERROR__REQUIRE_KEYS_EQ_VIOLATED=void 0,gf=z.ANCHOR_ERROR__INSTRUCTION_MISSING=100,mf=z.ANCHOR_ERROR__INSTRUCTION_FALLBACK_NOT_FOUND=101,wf=z.ANCHOR_ERROR__INSTRUCTION_DID_NOT_DESERIALIZE=102,_f=z.ANCHOR_ERROR__INSTRUCTION_DID_NOT_SERIALIZE=103,bf=z.ANCHOR_ERROR__IDL_INSTRUCTION_STUB=1e3,Ef=z.ANCHOR_ERROR__IDL_INSTRUCTION_INVALID_PROGRAM=1001,Rf=z.ANCHOR_ERROR__IDL_ACCOUNT_NOT_EMPTY=1002,Af=z.ANCHOR_ERROR__EVENT_INSTRUCTION_STUB=1500,vf=z.ANCHOR_ERROR__CONSTRAINT_MUT=2e3,Sf=z.ANCHOR_ERROR__CONSTRAINT_HAS_ONE=2001,If=z.ANCHOR_ERROR__CONSTRAINT_SIGNER=2002,kf=z.ANCHOR_ERROR__CONSTRAINT_RAW=2003,Tf=z.ANCHOR_ERROR__CONSTRAINT_OWNER=2004,xf=z.ANCHOR_ERROR__CONSTRAINT_RENT_EXEMPT=2005,Of=z.ANCHOR_ERROR__CONSTRAINT_SEEDS=2006,Nf=z.ANCHOR_ERROR__CONSTRAINT_EXECUTABLE=2007,Cf=z.ANCHOR_ERROR__CONSTRAINT_STATE=2008,Bf=z.ANCHOR_ERROR__CONSTRAINT_ASSOCIATED=2009,Mf=z.ANCHOR_ERROR__CONSTRAINT_ASSOCIATED_INIT=2010,Lf=z.ANCHOR_ERROR__CONSTRAINT_CLOSE=2011,Pf=z.ANCHOR_ERROR__CONSTRAINT_ADDRESS=2012,Uf=z.ANCHOR_ERROR__CONSTRAINT_ZERO=2013,Df=z.ANCHOR_ERROR__CONSTRAINT_TOKEN_MINT=2014,Ff=z.ANCHOR_ERROR__CONSTRAINT_TOKEN_OWNER=2015,Hf=z.ANCHOR_ERROR__CONSTRAINT_MINT_MINT_AUTHORITY=2016,zf=z.ANCHOR_ERROR__CONSTRAINT_MINT_FREEZE_AUTHORITY=2017,$f=z.ANCHOR_ERROR__CONSTRAINT_MINT_DECIMALS=2018,Kf=z.ANCHOR_ERROR__CONSTRAINT_SPACE=2019,Wf=z.ANCHOR_ERROR__CONSTRAINT_ACCOUNT_IS_NONE=2020,Gf=z.ANCHOR_ERROR__CONSTRAINT_TOKEN_TOKEN_PROGRAM=2021,qf=z.ANCHOR_ERROR__CONSTRAINT_MINT_TOKEN_PROGRAM=2022,Vf=z.ANCHOR_ERROR__CONSTRAINT_ASSOCIATED_TOKEN_TOKEN_PROGRAM=2023,jf=z.ANCHOR_ERROR__CONSTRAINT_MINT_GROUP_POINTER_EXTENSION=2024,Zf=z.ANCHOR_ERROR__CONSTRAINT_MINT_GROUP_POINTER_EXTENSION_AUTHORITY=2025,Yf=z.ANCHOR_ERROR__CONSTRAINT_MINT_GROUP_POINTER_EXTENSION_GROUP_ADDRESS=2026,Xf=z.ANCHOR_ERROR__CONSTRAINT_MINT_GROUP_MEMBER_POINTER_EXTENSION=2027,Jf=z.ANCHOR_ERROR__CONSTRAINT_MINT_GROUP_MEMBER_POINTER_EXTENSION_AUTHORITY=2028,Qf=z.ANCHOR_ERROR__CONSTRAINT_MINT_GROUP_MEMBER_POINTER_EXTENSION_MEMBER_ADDRESS=2029,ed=z.ANCHOR_ERROR__CONSTRAINT_MINT_METADATA_POINTER_EXTENSION=2030,td=z.ANCHOR_ERROR__CONSTRAINT_MINT_METADATA_POINTER_EXTENSION_AUTHORITY=2031,rd=z.ANCHOR_ERROR__CONSTRAINT_MINT_METADATA_POINTER_EXTENSION_METADATA_ADDRESS=2032,nd=z.ANCHOR_ERROR__CONSTRAINT_MINT_CLOSE_AUTHORITY_EXTENSION=2033,id=z.ANCHOR_ERROR__CONSTRAINT_MINT_CLOSE_AUTHORITY_EXTENSION_AUTHORITY=2034,sd=z.ANCHOR_ERROR__CONSTRAINT_MINT_PERMANENT_DELEGATE_EXTENSION=2035,od=z.ANCHOR_ERROR__CONSTRAINT_MINT_PERMANENT_DELEGATE_EXTENSION_DELEGATE=2036,ad=z.ANCHOR_ERROR__CONSTRAINT_MINT_TRANSFER_HOOK_EXTENSION=2037,cd=z.ANCHOR_ERROR__CONSTRAINT_MINT_TRANSFER_HOOK_EXTENSION_AUTHORITY=2038,ud=z.ANCHOR_ERROR__CONSTRAINT_MINT_TRANSFER_HOOK_EXTENSION_PROGRAM_ID=2039,ld=z.ANCHOR_ERROR__REQUIRE_VIOLATED=2500;pf=z.ANCHOR_ERROR__REQUIRE_EQ_VIOLATED=2501;var hd=z.ANCHOR_ERROR__REQUIRE_KEYS_EQ_VIOLATED=2502,fd=z.ANCHOR_ERROR__REQUIRE_NEQ_VIOLATED=2503,dd=z.ANCHOR_ERROR__REQUIRE_KEYS_NEQ_VIOLATED=2504,pd=z.ANCHOR_ERROR__REQUIRE_GT_VIOLATED=2505,yd=z.ANCHOR_ERROR__REQUIRE_GTE_VIOLATED=2506,gd=z.ANCHOR_ERROR__ACCOUNT_DISCRIMINATOR_ALREADY_SET=3e3,md=z.ANCHOR_ERROR__ACCOUNT_DISCRIMINATOR_NOT_FOUND=3001,wd=z.ANCHOR_ERROR__ACCOUNT_DISCRIMINATOR_MISMATCH=3002,_d=z.ANCHOR_ERROR__ACCOUNT_DID_NOT_DESERIALIZE=3003,bd=z.ANCHOR_ERROR__ACCOUNT_DID_NOT_SERIALIZE=3004,Ed=z.ANCHOR_ERROR__ACCOUNT_NOT_ENOUGH_KEYS=3005,Rd=z.ANCHOR_ERROR__ACCOUNT_NOT_MUTABLE=3006,Ad=z.ANCHOR_ERROR__ACCOUNT_OWNED_BY_WRONG_PROGRAM=3007,vd=z.ANCHOR_ERROR__INVALID_PROGRAM_ID=3008,Sd=z.ANCHOR_ERROR__INVALID_PROGRAM_EXECUTABLE=3009,Id=z.ANCHOR_ERROR__ACCOUNT_NOT_SIGNER=3010,kd=z.ANCHOR_ERROR__ACCOUNT_NOT_SYSTEM_OWNED=3011,Td=z.ANCHOR_ERROR__ACCOUNT_NOT_INITIALIZED=3012,xd=z.ANCHOR_ERROR__ACCOUNT_NOT_PROGRAM_DATA=3013,Od=z.ANCHOR_ERROR__ACCOUNT_NOT_ASSOCIATED_TOKEN_ACCOUNT=3014,Nd=z.ANCHOR_ERROR__ACCOUNT_SYSVAR_MISMATCH=3015,Cd=z.ANCHOR_ERROR__ACCOUNT_REALLOC_EXCEEDS_LIMIT=3016,Bd=z.ANCHOR_ERROR__ACCOUNT_DUPLICATE_REALLOCS=3017,Md=z.ANCHOR_ERROR__DECLARED_PROGRAM_ID_MISMATCH=4100,Ld=z.ANCHOR_ERROR__TRYING_TO_INIT_PAYER_AS_PROGRAM_ACCOUNT=4101,Pd=z.ANCHOR_ERROR__INVALID_NUMERIC_CONVERSION=4102;yf=z.ANCHOR_ERROR__DEPRECATED=5e3;const U_=new Map;function Ud(n){return U_.get(n)!==void 0}class Vr extends Error{constructor(e){super(e),this.name="IdlError"}}class Oi{constructor(e){this.stack=e}static parse(e){var t;const r=/^Program (\w*) invoke/,i=/^Program \w* success/,s=[];for(let o=0;o<e.length;o++){if(i.exec(e[o])){s.pop();continue}const a=(t=r.exec(e[o]))===null||t===void 0?void 0:t[1];a&&s.push(new j(a))}return new Oi(s)}}class pi extends Error{constructor(e,t,r,i,s,o){super(r.join(`
`).replace("Program log: ","")),this.errorLogs=r,this.logs=i,this.error={errorCode:e,errorMessage:t,comparedValues:o,origin:s},this._programErrorStack=Oi.parse(i)}static parse(e){if(!e)return null;const t=e.findIndex(I=>I.startsWith("Program log: AnchorError"));if(t===-1)return null;const r=e[t],i=[r];let s;if(t+1<e.length){if(e[t+1]==="Program log: Left:"){const I=/^Program log: (.*)$/,g=I.exec(e[t+2])[1],v=I.exec(e[t+4])[1];s=[new j(g),new j(v)],i.push(...e.slice(t+1,t+5))}else if(e[t+1].startsWith("Program log: Left:")){const I=/^Program log: (Left|Right): (.*)$/,g=I.exec(e[t+1])[2],v=I.exec(e[t+2])[2];i.push(...e.slice(t+1,t+3)),s=[g,v]}}const a=/^Program log: AnchorError occurred\. Error Code: (.*)\. Error Number: (\d*)\. Error Message: (.*)\./.exec(r),l=/^Program log: AnchorError thrown in (.*):(\d*)\. Error Code: (.*)\. Error Number: (\d*)\. Error Message: (.*)\./.exec(r),_=/^Program log: AnchorError caused by account: (.*)\. Error Code: (.*)\. Error Number: (\d*)\. Error Message: (.*)\./.exec(r);if(a){const[I,g,v]=a.slice(1,4),x={code:I,number:parseInt(g)};return new pi(x,v,i,e,void 0,s)}else if(l){const[I,g,v,x,A]=l.slice(1,6),N={code:v,number:parseInt(x)},K={file:I,line:parseInt(g)};return new pi(N,A,i,e,K,s)}else if(_){const[I,g,v,x]=_.slice(1,5),A=I,N={code:g,number:parseInt(v)};return new pi(N,x,i,e,A,s)}else return null}get program(){return this._programErrorStack.stack[this._programErrorStack.stack.length-1]}get programErrorStack(){return this._programErrorStack.stack}toString(){return this.message}}class ps extends Error{constructor(e,t,r){super(),this.code=e,this.msg=t,this.logs=r,r&&(this._programErrorStack=Oi.parse(r))}static parse(e,t){const r=e.toString();let i;if(r.includes("custom program error:")){let a=r.split("custom program error: ");if(a.length!==2)return null;i=a[1]}else{const a=r.match(/"Custom":([0-9]+)}/g);if(!a||a.length>1)return null;i=a[0].match(/([0-9]+)/g)[0]}let s;try{s=parseInt(i)}catch{return null}let o=t.get(s);return o!==void 0?new ps(s,o,e.logs):(o=D_.get(s),o!==void 0?new ps(s,o,e.logs):null)}get program(){var e;return(e=this._programErrorStack)===null||e===void 0?void 0:e.stack[this._programErrorStack.stack.length-1]}get programErrorStack(){var e;return(e=this._programErrorStack)===null||e===void 0?void 0:e.stack}toString(){return this.msg}}function Dd(n,e){Ud("debug-logs")&&console.log("Translating error:",n);const t=pi.parse(n.logs);if(t)return t;const r=ps.parse(n,e);if(r)return r;if(n.logs){const i={get:function(s,o){return o==="programErrorStack"?s.programErrorStack.stack:o==="program"?s.programErrorStack.stack[n.programErrorStack.stack.length-1]:Reflect.get(...arguments)}};return n.programErrorStack=Oi.parse(n.logs),new Proxy(n,i)}return n}const re={InstructionMissing:gf,InstructionFallbackNotFound:mf,InstructionDidNotDeserialize:wf,InstructionDidNotSerialize:_f,IdlInstructionStub:bf,IdlInstructionInvalidProgram:Ef,IdlAccountNotEmpty:Rf,EventInstructionStub:Af,ConstraintMut:vf,ConstraintHasOne:Sf,ConstraintSigner:If,ConstraintRaw:kf,ConstraintOwner:Tf,ConstraintRentExempt:xf,ConstraintSeeds:Of,ConstraintExecutable:Nf,ConstraintState:Cf,ConstraintAssociated:Bf,ConstraintAssociatedInit:Mf,ConstraintClose:Lf,ConstraintAddress:Pf,ConstraintZero:Uf,ConstraintTokenMint:Df,ConstraintTokenOwner:Ff,ConstraintMintMintAuthority:Hf,ConstraintMintFreezeAuthority:zf,ConstraintMintDecimals:$f,ConstraintSpace:Kf,ConstraintAccountIsNone:Wf,ConstraintTokenTokenProgram:Gf,ConstraintMintTokenProgram:qf,ConstraintAssociatedTokenTokenProgram:Vf,ConstraintMintGroupPointerExtension:jf,ConstraintMintGroupPointerExtensionAuthority:Zf,ConstraintMintGroupPointerExtensionGroupAddress:Yf,ConstraintMintGroupMemberPointerExtension:Xf,ConstraintMintGroupMemberPointerExtensionAuthority:Jf,ConstraintMintGroupMemberPointerExtensionMemberAddress:Qf,ConstraintMintMetadataPointerExtension:ed,ConstraintMintMetadataPointerExtensionAuthority:td,ConstraintMintMetadataPointerExtensionMetadataAddress:rd,ConstraintMintCloseAuthorityExtension:nd,ConstraintMintCloseAuthorityExtensionAuthority:id,ConstraintMintPermanentDelegateExtension:sd,ConstraintMintPermanentDelegateExtensionDelegate:od,ConstraintMintTransferHookExtension:ad,ConstraintMintTransferHookExtensionAuthority:cd,ConstraintMintTransferHookExtensionProgramId:ud,RequireViolated:ld,RequireEqViolated:pf,RequireKeysEqViolated:hd,RequireNeqViolated:fd,RequireKeysNeqViolated:dd,RequireGtViolated:pd,RequireGteViolated:yd,AccountDiscriminatorAlreadySet:gd,AccountDiscriminatorNotFound:md,AccountDiscriminatorMismatch:wd,AccountDidNotDeserialize:_d,AccountDidNotSerialize:bd,AccountNotEnoughKeys:Ed,AccountNotMutable:Rd,AccountOwnedByWrongProgram:Ad,InvalidProgramId:vd,InvalidProgramExecutable:Sd,AccountNotSigner:Id,AccountNotSystemOwned:kd,AccountNotInitialized:Td,AccountNotProgramData:xd,AccountNotAssociatedTokenAccount:Od,AccountSysvarMismatch:Nd,AccountReallocExceedsLimit:Cd,AccountDuplicateReallocs:Bd,DeclaredProgramIdMismatch:Md,TryingToInitPayerAsProgramAccount:Ld,InvalidNumericConversion:Pd,Deprecated:yf},D_=new Map([[re.InstructionMissing,"Instruction discriminator not provided"],[re.InstructionFallbackNotFound,"Fallback functions are not supported"],[re.InstructionDidNotDeserialize,"The program could not deserialize the given instruction"],[re.InstructionDidNotSerialize,"The program could not serialize the given instruction"],[re.IdlInstructionStub,"The program was compiled without idl instructions"],[re.IdlInstructionInvalidProgram,"The transaction was given an invalid program for the IDL instruction"],[re.IdlAccountNotEmpty,"IDL account must be empty in order to resize, try closing first"],[re.EventInstructionStub,"The program was compiled without `event-cpi` feature"],[re.ConstraintMut,"A mut constraint was violated"],[re.ConstraintHasOne,"A has one constraint was violated"],[re.ConstraintSigner,"A signer constraint was violated"],[re.ConstraintRaw,"A raw constraint was violated"],[re.ConstraintOwner,"An owner constraint was violated"],[re.ConstraintRentExempt,"A rent exemption constraint was violated"],[re.ConstraintSeeds,"A seeds constraint was violated"],[re.ConstraintExecutable,"An executable constraint was violated"],[re.ConstraintState,"Deprecated Error, feel free to replace with something else"],[re.ConstraintAssociated,"An associated constraint was violated"],[re.ConstraintAssociatedInit,"An associated init constraint was violated"],[re.ConstraintClose,"A close constraint was violated"],[re.ConstraintAddress,"An address constraint was violated"],[re.ConstraintZero,"Expected zero account discriminant"],[re.ConstraintTokenMint,"A token mint constraint was violated"],[re.ConstraintTokenOwner,"A token owner constraint was violated"],[re.ConstraintMintMintAuthority,"A mint mint authority constraint was violated"],[re.ConstraintMintFreezeAuthority,"A mint freeze authority constraint was violated"],[re.ConstraintMintDecimals,"A mint decimals constraint was violated"],[re.ConstraintSpace,"A space constraint was violated"],[re.ConstraintAccountIsNone,"A required account for the constraint is None"],[re.ConstraintTokenTokenProgram,"A token account token program constraint was violated"],[re.ConstraintMintTokenProgram,"A mint token program constraint was violated"],[re.ConstraintAssociatedTokenTokenProgram,"An associated token account token program constraint was violated"],[re.ConstraintMintGroupPointerExtension,"A group pointer extension constraint was violated"],[re.ConstraintMintGroupPointerExtensionAuthority,"A group pointer extension authority constraint was violated"],[re.ConstraintMintGroupPointerExtensionGroupAddress,"A group pointer extension group address constraint was violated"],[re.ConstraintMintGroupMemberPointerExtension,"A group member pointer extension constraint was violated"],[re.ConstraintMintGroupMemberPointerExtensionAuthority,"A group member pointer extension authority constraint was violated"],[re.ConstraintMintGroupMemberPointerExtensionMemberAddress,"A group member pointer extension group address constraint was violated"],[re.ConstraintMintMetadataPointerExtension,"A metadata pointer extension constraint was violated"],[re.ConstraintMintMetadataPointerExtensionAuthority,"A metadata pointer extension authority constraint was violated"],[re.ConstraintMintMetadataPointerExtensionMetadataAddress,"A metadata pointer extension metadata address constraint was violated"],[re.ConstraintMintCloseAuthorityExtension,"A close authority constraint was violated"],[re.ConstraintMintCloseAuthorityExtensionAuthority,"A close authority extension authority constraint was violated"],[re.ConstraintMintPermanentDelegateExtension,"A permanent delegate extension constraint was violated"],[re.ConstraintMintPermanentDelegateExtensionDelegate,"A permanent delegate extension delegate constraint was violated"],[re.ConstraintMintTransferHookExtension,"A transfer hook extension constraint was violated"],[re.ConstraintMintTransferHookExtensionAuthority,"A transfer hook extension authority constraint was violated"],[re.ConstraintMintTransferHookExtensionProgramId,"A transfer hook extension transfer hook program id constraint was violated"],[re.RequireViolated,"A require expression was violated"],[re.RequireEqViolated,"A require_eq expression was violated"],[re.RequireKeysEqViolated,"A require_keys_eq expression was violated"],[re.RequireNeqViolated,"A require_neq expression was violated"],[re.RequireKeysNeqViolated,"A require_keys_neq expression was violated"],[re.RequireGtViolated,"A require_gt expression was violated"],[re.RequireGteViolated,"A require_gte expression was violated"],[re.AccountDiscriminatorAlreadySet,"The account discriminator was already set on this account"],[re.AccountDiscriminatorNotFound,"No discriminator was found on the account"],[re.AccountDiscriminatorMismatch,"Account discriminator did not match what was expected"],[re.AccountDidNotDeserialize,"Failed to deserialize the account"],[re.AccountDidNotSerialize,"Failed to serialize the account"],[re.AccountNotEnoughKeys,"Not enough account keys given to the instruction"],[re.AccountNotMutable,"The given account is not mutable"],[re.AccountOwnedByWrongProgram,"The given account is owned by a different program than expected"],[re.InvalidProgramId,"Program ID was not as expected"],[re.InvalidProgramExecutable,"Program account is not executable"],[re.AccountNotSigner,"The given account did not sign"],[re.AccountNotSystemOwned,"The given account is not owned by the system program"],[re.AccountNotInitialized,"The program expected this account to be already initialized"],[re.AccountNotProgramData,"The given account is not a program data account"],[re.AccountNotAssociatedTokenAccount,"The given account is not the associated token account"],[re.AccountSysvarMismatch,"The given public key does not match the required sysvar"],[re.AccountReallocExceedsLimit,"The account reallocation exceeds the MAX_PERMITTED_DATA_INCREASE limit"],[re.AccountDuplicateReallocs,"The account was duplicated for more than one reallocation"],[re.DeclaredProgramIdMismatch,"The declared program id does not match the actual program id"],[re.TryingToInitPayerAsProgramAccount,"You cannot/should not initialize the payer account as a program account"],[re.InvalidNumericConversion,"The program could not perform the numeric conversion, out of range integral type conversion attempted"],[re.Deprecated,"The API being used is deprecated and should no longer be used"]]);class Se{static fieldLayout(e,t=[],r){const i=e.name;switch(e.type){case"bool":return ge.bool(i);case"u8":return ge.u8(i);case"i8":return ge.i8(i);case"u16":return ge.u16(i);case"i16":return ge.i16(i);case"u32":return ge.u32(i);case"i32":return ge.i32(i);case"f32":return ge.f32(i);case"u64":return ge.u64(i);case"i64":return ge.i64(i);case"f64":return ge.f64(i);case"u128":return ge.u128(i);case"i128":return ge.i128(i);case"u256":return ge.u256(i);case"i256":return ge.i256(i);case"bytes":return ge.vecU8(i);case"string":return ge.str(i);case"pubkey":return ge.publicKey(i);default:{if("option"in e.type)return ge.option(Se.fieldLayout({type:e.type.option},t,r),i);if("vec"in e.type)return ge.vec(Se.fieldLayout({type:e.type.vec},t,r),i);if("array"in e.type){let[s,o]=e.type.array;return o=Se.resolveArrayLen(o,r),ge.array(Se.fieldLayout({type:s},t,r),o,i)}if("defined"in e.type){if(!t)throw new Vr("User defined types not provided");const s=e.type.defined.name,o=t.find(a=>a.name===s);if(!o)throw new Vr(`Type not found: ${e.name}`);return Se.typeDefLayout({typeDef:o,types:t,genericArgs:r??e.type.defined.generics,name:i})}if("generic"in e.type){const s=r==null?void 0:r.at(0);if((s==null?void 0:s.kind)!=="type")throw new Vr(`Invalid generic field: ${e.name}`);return Se.fieldLayout({...e,type:s.type},t)}throw new Vr(`Not yet implemented: ${JSON.stringify(e.type)}`)}}}static typeDefLayout({typeDef:e,types:t,name:r,genericArgs:i}){switch(e.type.kind){case"struct":{const s=Mn(e.type.fields,()=>[],o=>o.map(a=>{const u=i&&Se.resolveGenericArgs({type:a.type,typeDef:e,genericArgs:i});return Se.fieldLayout(a,t,u)}),o=>o.map((a,u)=>{const l=i&&Se.resolveGenericArgs({type:a,typeDef:e,genericArgs:i});return Se.fieldLayout({name:u.toString(),type:a},t,l)}));return ge.struct(s,r)}case"enum":{const s=e.type.variants.map(o=>{const a=Mn(o.fields,()=>[],u=>u.map(l=>{const f=i&&Se.resolveGenericArgs({type:l.type,typeDef:e,genericArgs:i});return Se.fieldLayout(l,t,f)}),u=>u.map((l,f)=>{const _=i&&Se.resolveGenericArgs({type:l,typeDef:e,genericArgs:i});return Se.fieldLayout({name:f.toString(),type:l},t,_)}));return ge.struct(a,o.name)});return r!==void 0?ge.rustEnum(s).replicate(r):ge.rustEnum(s,r)}case"type":return Se.fieldLayout({type:e.type.alias,name:r},t)}}static typeSize(e,t,r){var i;switch(e){case"bool":return 1;case"u8":return 1;case"i8":return 1;case"i16":return 2;case"u16":return 2;case"u32":return 4;case"i32":return 4;case"f32":return 4;case"u64":return 8;case"i64":return 8;case"f64":return 8;case"u128":return 16;case"i128":return 16;case"u256":return 32;case"i256":return 32;case"bytes":return 1;case"string":return 1;case"pubkey":return 32;default:if("option"in e)return 1+Se.typeSize(e.option,t,r);if("coption"in e)return 4+Se.typeSize(e.coption,t,r);if("vec"in e)return 1;if("array"in e){let[s,o]=e.array;return o=Se.resolveArrayLen(o,r),Se.typeSize(s,t,r)*o}if("defined"in e){const s=(i=t.types)===null||i===void 0?void 0:i.find(a=>a.name===e.defined.name);if(!s)throw new Vr(`Type not found: ${JSON.stringify(e)}`);const o=a=>{const u=r??e.defined.generics,l=u&&Se.resolveGenericArgs({type:a,typeDef:s,genericArgs:u});return Se.typeSize(a,t,l)};switch(s.type.kind){case"struct":return Mn(s.type.fields,()=>[0],a=>a.map(u=>o(u.type)),a=>a.map(u=>o(u))).reduce((a,u)=>a+u,0);case"enum":{const a=s.type.variants.map(u=>Mn(u.fields,()=>[0],l=>l.map(f=>o(f.type)),l=>l.map(f=>o(f))).reduce((l,f)=>l+f,0));return Math.max(...a)+1}case"type":return Se.typeSize(s.type.alias,t,r)}}if("generic"in e){const s=r==null?void 0:r.at(0);if((s==null?void 0:s.kind)!=="type")throw new Vr(`Invalid generic: ${e.generic}`);return Se.typeSize(s.type,t,r)}throw new Error(`Invalid type ${JSON.stringify(e)}`)}}static resolveArrayLen(e,t){if(typeof e=="number")return e;if(t){const r=t.find(i=>i.kind==="const");(r==null?void 0:r.kind)==="const"&&(e=+r.value)}if(typeof e!="number")throw new Vr("Generic array length did not resolve");return e}static resolveGenericArgs({type:e,typeDef:t,genericArgs:r,isDefined:i}){if(typeof e!="object")return null;for(const s in t.generics){const o=t.generics[s];if("generic"in e&&o.name===e.generic)return[r[s]];if("option"in e){const a=Se.resolveGenericArgs({type:e.option,typeDef:t,genericArgs:r,isDefined:i});if(!a||!i)return a;if(a[0].kind==="type")return[{kind:"type",type:{option:a[0].type}}]}if("vec"in e){const a=Se.resolveGenericArgs({type:e.vec,typeDef:t,genericArgs:r,isDefined:i});if(!a||!i)return a;if(a[0].kind==="type")return[{kind:"type",type:{vec:a[0].type}}]}if("array"in e){const[a,u]=e.array,l=typeof u=="object",f=Se.resolveGenericArgs({type:a,typeDef:t,genericArgs:r,isDefined:i})||[];if(l){const _=t.generics.findIndex(I=>I.name===u.generic);_!==-1&&f.push(r[_])}if(f.length>0){if(!i)return f;if(f[0].kind==="type"&&f[1].kind==="const")return[{kind:"type",type:{array:[f[0].type,+f[1].value]}}]}if(l&&o.name===u.generic){const _=r[s];return i?[{kind:"type",type:{array:[a,+_.value]}}]:[_]}return null}if("defined"in e)return e.defined.generics?e.defined.generics.flatMap(a=>{switch(a.kind){case"type":return Se.resolveGenericArgs({type:a.type,typeDef:t,genericArgs:r,isDefined:!0});case"const":return[a]}}).filter(a=>a!==null):null}return null}}class F_{constructor(e){this.idl=e;const t=e.instructions.map(r=>{const i=r.name,s=r.args.map(a=>Se.fieldLayout(a,e.types)),o=ge.struct(s,i);return[i,{discriminator:r.discriminator,layout:o}]});this.ixLayouts=new Map(t)}encode(e,t){const r=te.Buffer.alloc(1e3),i=this.ixLayouts.get(e);if(!i)throw new Error(`Unknown method: ${e}`);const s=i.layout.encode(t,r),o=r.slice(0,s);return te.Buffer.concat([te.Buffer.from(i.discriminator),o])}decode(e,t="hex"){typeof e=="string"&&(e=t==="hex"?te.Buffer.from(e,"hex"):Et.decode(e));for(const[r,i]of this.ixLayouts){const s=e.subarray(0,i.discriminator.length);if(s.equals(te.Buffer.from(i.discriminator)))return{name:r,data:i.layout.decode(e.subarray(s.length))}}return null}format(e,t){return qt.format(e,t,this.idl)}}class qt{static format(e,t,r){const i=r.instructions.find(u=>e.name===u.name);if(!i)return console.error("Invalid instruction given"),null;const s=i.args.map(u=>({name:u.name,type:qt.formatIdlType(u.type),data:qt.formatIdlData(u,e.data[u.name],r.types)})),o=qt.flattenIdlAccounts(i.accounts),a=t.map((u,l)=>l<o.length?{name:o[l].name,...u}:{name:void 0,...u});return{args:s,accounts:a}}static formatIdlType(e){if(typeof e=="string")return e;if("option"in e)return`Option<${this.formatIdlType(e.option)}>`;if("coption"in e)return`COption<${this.formatIdlType(e.coption)}>`;if("vec"in e)return`Vec<${this.formatIdlType(e.vec)}>`;if("array"in e)return`Array<${e.array[0]}; ${e.array[1]}>`;if("defined"in e){const t=e.defined.name;if(e.defined.generics){const r=e.defined.generics.map(i=>{switch(i.kind){case"type":return qt.formatIdlType(i.type);case"const":return i.value}}).join(", ");return`${t}<${r}>`}return t}throw new Error(`Unknown IDL type: ${e}`)}static formatIdlData(e,t,r){if(typeof e.type=="string")return t.toString();if("vec"in e.type)return"["+t.map(i=>this.formatIdlData({name:"",type:e.type.vec},i,r)).join(", ")+"]";if("option"in e.type)return t===null?"null":this.formatIdlData({name:"",type:e.type.option},t,r);if("defined"in e.type){if(!r)throw new Error("User defined types not provided");const i=e.type.defined.name,s=r.find(o=>o.name===i);if(!s)throw new Error(`Type not found: ${i}`);return qt.formatIdlDataDefined(s,t,r)}return"unknown"}static formatIdlDataDefined(e,t,r){switch(e.type.kind){case"struct":return"{ "+Mn(e.type.fields,()=>"",i=>Object.entries(t).map(([s,o])=>{const a=i.find(u=>u.name===s);if(!a)throw new Error(`Field not found: ${s}`);return s+": "+qt.formatIdlData(a,o,r)}).join(", "),i=>Object.entries(t).map(([s,o])=>s+": "+qt.formatIdlData({name:"",type:i[s]},o,r)).join(", "))+" }";case"enum":{const i=Object.keys(t)[0],s=e.type.variants.find(a=>a.name===i);if(!s)throw new Error(`Unable to find variant: ${i}`);const o=t[i];return Mn(s.fields,()=>i,a=>{const u=Object.keys(o).map(l=>{const f=o[l],_=a.find(I=>I.name===l);if(!_)throw new Error(`Field not found: ${l}`);return l+": "+qt.formatIdlData(_,f,r)}).join(", ");return`${i} { ${u} }`},a=>{const u=Object.entries(o).map(([l,f])=>l+": "+qt.formatIdlData({name:"",type:a[l]},f,r)).join(", ");return`${i} { ${u} }`})}case"type":return qt.formatIdlType(e.type.alias)}}static flattenIdlAccounts(e,t){return e.map(r=>{const i=H_(r.name);if(r.hasOwnProperty("accounts")){const s=t?`${t} > ${i}`:i;return qt.flattenIdlAccounts(r.accounts,s)}else return{...r,name:t?`${t} > ${i}`:i}}).flat()}}function H_(n){const e=n.replace(/([A-Z])/g," $1");return e.charAt(0).toUpperCase()+e.slice(1)}class z_{constructor(e){if(this.idl=e,!e.accounts){this.accountLayouts=new Map;return}const t=e.types;if(!t)throw new Error("Accounts require `idl.types`");const r=e.accounts.map(i=>{const s=t.find(o=>o.name===i.name);if(!s)throw new Error(`Account not found: ${i.name}`);return[i.name,{discriminator:i.discriminator,layout:Se.typeDefLayout({typeDef:s,types:t})}]});this.accountLayouts=new Map(r)}async encode(e,t){const r=te.Buffer.alloc(1e3),i=this.accountLayouts.get(e);if(!i)throw new Error(`Unknown account: ${e}`);const s=i.layout.encode(t,r),o=r.slice(0,s),a=this.accountDiscriminator(e);return te.Buffer.concat([a,o])}decode(e,t){const r=this.accountDiscriminator(e);if(r.compare(t.slice(0,r.length)))throw new Error("Invalid account discriminator");return this.decodeUnchecked(e,t)}decodeAny(e){for(const[t,r]of this.accountLayouts)if(e.subarray(0,r.discriminator.length).equals(te.Buffer.from(r.discriminator)))return this.decodeUnchecked(t,e);throw new Error("Account not found")}decodeUnchecked(e,t){const r=this.accountDiscriminator(e),i=t.subarray(r.length),s=this.accountLayouts.get(e);if(!s)throw new Error(`Unknown account: ${e}`);return s.layout.decode(i)}memcmp(e,t){const r=this.accountDiscriminator(e);return{offset:0,bytes:Et.encode(t?te.Buffer.concat([r,t]):r)}}size(e){return this.accountDiscriminator(e).length+Se.typeSize({defined:{name:e}},this.idl)}accountDiscriminator(e){var t;const r=(t=this.idl.accounts)===null||t===void 0?void 0:t.find(i=>i.name===e);if(!r)throw new Error(`Account not found: ${e}`);return te.Buffer.from(r.discriminator)}}class $_{constructor(e){if(!e.events){this.layouts=new Map;return}const t=e.types;if(!t)throw new Error("Events require `idl.types`");const r=e.events.map(i=>{const s=t.find(o=>o.name===i.name);if(!s)throw new Error(`Event not found: ${i.name}`);return[i.name,{discriminator:i.discriminator,layout:Se.typeDefLayout({typeDef:s,types:t})}]});this.layouts=new Map(r)}decode(e){let t;try{t=uf(e)}catch{return null}for(const[r,i]of this.layouts){const s=t.subarray(0,i.discriminator.length);if(s.equals(te.Buffer.from(i.discriminator)))return{name:r,data:i.layout.decode(t.subarray(s.length))}}return null}}class K_{constructor(e){const t=e.types;if(!t){this.typeLayouts=new Map;return}const r=t.filter(i=>!i.generics).map(i=>[i.name,Se.typeDefLayout({typeDef:i,types:t})]);this.typeLayouts=new Map(r)}encode(e,t){const r=te.Buffer.alloc(1e3),i=this.typeLayouts.get(e);if(!i)throw new Error(`Unknown type: ${e}`);const s=i.encode(t,r);return r.slice(0,s)}decode(e,t){const r=this.typeLayouts.get(e);if(!r)throw new Error(`Unknown type: ${e}`);return r.decode(t)}}class Fd{constructor(e){this.instruction=new F_(e),this.accounts=new z_(e),this.events=new $_(e),this.types=new K_(e)}}class Kt{constructor(e,t){if(!Number.isInteger(e))throw new TypeError("span must be an integer");this.span=e,this.property=t}makeDestinationObject(){return{}}decode(e,t){throw new Error("Layout is abstract")}encode(e,t,r){throw new Error("Layout is abstract")}getSpan(e,t){if(0>this.span)throw new RangeError("indeterminate span");return this.span}replicate(e){const t=Object.create(this.constructor.prototype);return Object.assign(t,this),t.property=e,t}fromArray(e){}}var Hs=Kt;function W_(n,e){return e.property?n+"["+e.property+"]":n}class dn extends Kt{isCount(){throw new Error("ExternalLayout is abstract")}}class Hd extends dn{constructor(e,t,r){if(!(e instanceof Kt))throw new TypeError("layout must be a Layout");if(t===void 0)t=0;else if(!Number.isInteger(t))throw new TypeError("offset must be integer or undefined");super(e.span,r||e.property),this.layout=e,this.offset=t}isCount(){return this.layout instanceof zs||this.layout instanceof zd}decode(e,t){return t===void 0&&(t=0),this.layout.decode(e,t+this.offset)}encode(e,t,r){return r===void 0&&(r=0),this.layout.encode(e,t,r+this.offset)}}class zs extends Kt{constructor(e,t){if(super(e,t),6<this.span)throw new RangeError("span must not exceed 6 bytes")}decode(e,t){return t===void 0&&(t=0),e.readUIntLE(t,this.span)}encode(e,t,r){return r===void 0&&(r=0),t.writeUIntLE(e,r,this.span),this.span}}class zd extends Kt{constructor(e,t){if(super(e,t),6<this.span)throw new RangeError("span must not exceed 6 bytes")}decode(e,t){return t===void 0&&(t=0),e.readUIntBE(t,this.span)}encode(e,t,r){return r===void 0&&(r=0),t.writeUIntBE(e,r,this.span),this.span}}const aa=Math.pow(2,32);function $d(n){const e=Math.floor(n/aa),t=n-e*aa;return{hi32:e,lo32:t}}function Kd(n,e){return n*aa+e}class G_ extends Kt{constructor(e){super(8,e)}decode(e,t){t===void 0&&(t=0);const r=e.readUInt32LE(t),i=e.readUInt32LE(t+4);return Kd(i,r)}encode(e,t,r){r===void 0&&(r=0);const i=$d(e);return t.writeUInt32LE(i.lo32,r),t.writeUInt32LE(i.hi32,r+4),8}}class q_ extends Kt{constructor(e){super(8,e)}decode(e,t){t===void 0&&(t=0);const r=e.readUInt32LE(t),i=e.readInt32LE(t+4);return Kd(i,r)}encode(e,t,r){r===void 0&&(r=0);const i=$d(e);return t.writeUInt32LE(i.lo32,r),t.writeInt32LE(i.hi32,r+4),8}}class V_ extends Kt{constructor(e,t,r){if(!(Array.isArray(e)&&e.reduce((s,o)=>s&&o instanceof Kt,!0)))throw new TypeError("fields must be array of Layout instances");typeof t=="boolean"&&r===void 0&&(r=t,t=void 0);for(const s of e)if(0>s.span&&s.property===void 0)throw new Error("fields cannot contain unnamed variable-length layout");let i=-1;try{i=e.reduce((s,o)=>s+o.getSpan(),0)}catch{}super(i,t),this.fields=e,this.decodePrefixes=!!r}getSpan(e,t){if(0<=this.span)return this.span;t===void 0&&(t=0);let r=0;try{r=this.fields.reduce((i,s)=>{const o=s.getSpan(e,t);return t+=o,i+o},0)}catch{throw new RangeError("indeterminate span")}return r}decode(e,t){t===void 0&&(t=0);const r=this.makeDestinationObject();for(const i of this.fields)if(i.property!==void 0&&(r[i.property]=i.decode(e,t)),t+=i.getSpan(e,t),this.decodePrefixes&&e.length===t)break;return r}encode(e,t,r){r===void 0&&(r=0);const i=r;let s=0,o=0;for(const a of this.fields){let u=a.span;if(o=0<u?u:0,a.property!==void 0){const l=e[a.property];l!==void 0&&(o=a.encode(l,t,r),0>u&&(u=a.getSpan(t,r)))}s=r,r+=u}return s+o-i}fromArray(e){const t=this.makeDestinationObject();for(const r of this.fields)r.property!==void 0&&0<e.length&&(t[r.property]=e.shift());return t}layoutFor(e){if(typeof e!="string")throw new TypeError("property must be string");for(const t of this.fields)if(t.property===e)return t}offsetOf(e){if(typeof e!="string")throw new TypeError("property must be string");let t=0;for(const r of this.fields){if(r.property===e)return t;0>r.span?t=-1:0<=t&&(t+=r.span)}}}class Wd{constructor(e){this.property=e}decode(){throw new Error("UnionDiscriminator is abstract")}encode(){throw new Error("UnionDiscriminator is abstract")}}class Lu extends Wd{constructor(e,t){if(!(e instanceof dn&&e.isCount()))throw new TypeError("layout must be an unsigned integer ExternalLayout");super(t||e.property||"variant"),this.layout=e}decode(e,t){return this.layout.decode(e,t)}encode(e,t,r){return this.layout.encode(e,t,r)}}class Gd extends Kt{constructor(e,t,r){const i=e instanceof zs||e instanceof zd;if(i)e=new Lu(new Hd(e));else if(e instanceof dn&&e.isCount())e=new Lu(e);else if(!(e instanceof Wd))throw new TypeError("discr must be a UnionDiscriminator or an unsigned integer layout");if(t===void 0&&(t=null),!(t===null||t instanceof Kt))throw new TypeError("defaultLayout must be null or a Layout");if(t!==null){if(0>t.span)throw new Error("defaultLayout must have constant span");t.property===void 0&&(t=t.replicate("content"))}let s=-1;t&&(s=t.span,0<=s&&i&&(s+=e.layout.span)),super(s,r),this.discriminator=e,this.usesPrefixDiscriminator=i,this.defaultLayout=t,this.registry={};let o=this.defaultGetSourceVariant.bind(this);this.getSourceVariant=function(a){return o(a)},this.configGetSourceVariant=function(a){o=a.bind(this)}}getSpan(e,t){if(0<=this.span)return this.span;t===void 0&&(t=0);const r=this.getVariant(e,t);if(!r)throw new Error("unable to determine span for unrecognized variant");return r.getSpan(e,t)}defaultGetSourceVariant(e){if(e.hasOwnProperty(this.discriminator.property)){if(this.defaultLayout&&e.hasOwnProperty(this.defaultLayout.property))return;const t=this.registry[e[this.discriminator.property]];if(t&&(!t.layout||e.hasOwnProperty(t.property)))return t}else for(const t in this.registry){const r=this.registry[t];if(e.hasOwnProperty(r.property))return r}throw new Error("unable to infer src variant")}decode(e,t){t===void 0&&(t=0);let r;const i=this.discriminator,s=i.decode(e,t);let o=this.registry[s];if(o===void 0){let a=0;o=this.defaultLayout,this.usesPrefixDiscriminator&&(a=i.layout.span),r=this.makeDestinationObject(),r[i.property]=s,r[o.property]=this.defaultLayout.decode(e,t+a)}else r=o.decode(e,t);return r}encode(e,t,r){r===void 0&&(r=0);const i=this.getSourceVariant(e);if(i===void 0){const s=this.discriminator,o=this.defaultLayout;let a=0;return this.usesPrefixDiscriminator&&(a=s.layout.span),s.encode(e[s.property],t,r),a+o.encode(e[o.property],t,r+a)}return i.encode(e,t,r)}addVariant(e,t,r){const i=new j_(this,e,t,r);return this.registry[e]=i,i}getVariant(e,t){let r=e;return Buffer.isBuffer(e)&&(t===void 0&&(t=0),r=this.discriminator.decode(e,t)),this.registry[r]}}class j_ extends Kt{constructor(e,t,r,i){if(!(e instanceof Gd))throw new TypeError("union must be a Union");if(!Number.isInteger(t)||0>t)throw new TypeError("variant must be a (non-negative) integer");if(typeof r=="string"&&i===void 0&&(i=r,r=null),r){if(!(r instanceof Kt))throw new TypeError("layout must be a Layout");if(e.defaultLayout!==null&&0<=r.span&&r.span>e.defaultLayout.span)throw new Error("variant span exceeds span of containing union");if(typeof i!="string")throw new TypeError("variant must have a String property")}let s=e.span;0>e.span&&(s=r?r.span:0,0<=s&&e.usesPrefixDiscriminator&&(s+=e.discriminator.layout.span)),super(s,i),this.union=e,this.variant=t,this.layout=r||null}getSpan(e,t){if(0<=this.span)return this.span;t===void 0&&(t=0);let r=0;return this.union.usesPrefixDiscriminator&&(r=this.union.discriminator.layout.span),r+this.layout.getSpan(e,t+r)}decode(e,t){const r=this.makeDestinationObject();if(t===void 0&&(t=0),this!==this.union.getVariant(e,t))throw new Error("variant mismatch");let i=0;return this.union.usesPrefixDiscriminator&&(i=this.union.discriminator.layout.span),this.layout?r[this.property]=this.layout.decode(e,t+i):this.property?r[this.property]=!0:this.union.usesPrefixDiscriminator&&(r[this.union.discriminator.property]=this.variant),r}encode(e,t,r){r===void 0&&(r=0);let i=0;if(this.union.usesPrefixDiscriminator&&(i=this.union.discriminator.layout.span),this.layout&&!e.hasOwnProperty(this.property))throw new TypeError("variant lacks property "+this.property);this.union.discriminator.encode(this.variant,t,r);let s=i;if(this.layout&&(this.layout.encode(e[this.property],t,r+i),s+=this.layout.getSpan(t,r+i),0<=this.union.span&&s>this.union.span))throw new Error("encoded variant overruns containing union");return s}fromArray(e){if(this.layout)return this.layout.fromArray(e)}}class Z_ extends Kt{constructor(e,t){if(!(e instanceof dn&&e.isCount()||Number.isInteger(e)&&0<=e))throw new TypeError("length must be positive integer or an unsigned integer ExternalLayout");let r=-1;e instanceof dn||(r=e),super(r,t),this.length=e}getSpan(e,t){let r=this.span;return 0>r&&(r=this.length.decode(e,t)),r}decode(e,t){t===void 0&&(t=0);let r=this.span;return 0>r&&(r=this.length.decode(e,t)),e.slice(t,t+r)}encode(e,t,r){let i=this.length;if(this.length instanceof dn&&(i=e.length),!(Buffer.isBuffer(e)&&i===e.length))throw new TypeError(W_("Blob.encode",this)+" requires (length "+i+") Buffer as src");if(r+i>t.length)throw new RangeError("encoding overruns Buffer");return t.write(e.toString("hex"),r,i,"hex"),this.length instanceof dn&&this.length.encode(i,t,r),i}}var Y_=(n,e,t)=>new Hd(n,e,t),X_=n=>new zs(1,n),Ur=n=>new zs(4,n),J_=n=>new G_(n),Fr=n=>new q_(n),Rt=(n,e,t)=>new V_(n,e,t),qd=(n,e,t)=>new Gd(n,e,t),Ni=(n,e)=>new Z_(n,e);class Q_ extends Hs{constructor(e){super(-1,e),this.property=e,this.layout=Rt([Ur("length"),Ur("lengthPadding"),Ni(Y_(Ur(),-8),"chars")],this.property)}encode(e,t,r=0){if(e==null)return this.layout.span;const i={chars:Buffer.from(e,"utf8")};return this.layout.encode(i,t,r)}decode(e,t=0){return this.layout.decode(e,t).chars.toString()}getSpan(e,t=0){return Ur().span+Ur().span+new Mt(new Uint8Array(e).slice(t,t+4),10,"le").toNumber()}}function $s(n){return new Q_(n)}function ir(n){return Ni(32,n)}const Xt=qd(Ur("instruction"));Xt.addVariant(0,Rt([Fr("lamports"),Fr("space"),ir("owner")]),"createAccount");Xt.addVariant(1,Rt([ir("owner")]),"assign");Xt.addVariant(2,Rt([Fr("lamports")]),"transfer");Xt.addVariant(3,Rt([ir("base"),$s("seed"),Fr("lamports"),Fr("space"),ir("owner")]),"createAccountWithSeed");Xt.addVariant(4,Rt([ir("authorized")]),"advanceNonceAccount");Xt.addVariant(5,Rt([Fr("lamports")]),"withdrawNonceAccount");Xt.addVariant(6,Rt([ir("authorized")]),"initializeNonceAccount");Xt.addVariant(7,Rt([ir("authorized")]),"authorizeNonceAccount");Xt.addVariant(8,Rt([Fr("space")]),"allocate");Xt.addVariant(9,Rt([ir("base"),$s("seed"),Fr("space"),ir("owner")]),"allocateWithSeed");Xt.addVariant(10,Rt([ir("base"),$s("seed"),ir("owner")]),"assignWithSeed");Xt.addVariant(11,Rt([Fr("lamports"),$s("seed"),ir("owner")]),"transferWithSeed");Math.max(...Object.values(Xt.registry).map(n=>n.span));class eb extends Hs{constructor(e,t,r,i){super(e.span,i),this.layout=e,this.decoder=t,this.encoder=r}decode(e,t){return this.decoder(this.layout.decode(e,t))}encode(e,t,r){return this.layout.encode(this.encoder(e),t,r)}getSpan(e,t){return this.layout.getSpan(e,t)}}function Pu(n){return new eb(Ni(32),e=>new j(e),e=>e.toBuffer(),n)}Rt([Ur("version"),Ur("state"),Pu("authorizedPubkey"),Pu("nonce"),Rt([J_("lamportsPerSignature")],"feeCalculator")]);new j("TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA");new j("ATokenGPvbdGVxr1b2hvZbsiqW5xWH25efTNsLJA8knL");var Uu={exports:{}};(function(n,e){var t=typeof self<"u"?self:P_,r=function(){function s(){this.fetch=!1,this.DOMException=t.DOMException}return s.prototype=t,new s}();(function(s){(function(o){var a={searchParams:"URLSearchParams"in s,iterable:"Symbol"in s&&"iterator"in Symbol,blob:"FileReader"in s&&"Blob"in s&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in s,arrayBuffer:"ArrayBuffer"in s};function u(c){return c&&DataView.prototype.isPrototypeOf(c)}if(a.arrayBuffer)var l=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],f=ArrayBuffer.isView||function(c){return c&&l.indexOf(Object.prototype.toString.call(c))>-1};function _(c){if(typeof c!="string"&&(c=String(c)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(c))throw new TypeError("Invalid character in header field name");return c.toLowerCase()}function I(c){return typeof c!="string"&&(c=String(c)),c}function g(c){var h={next:function(){var m=c.shift();return{done:m===void 0,value:m}}};return a.iterable&&(h[Symbol.iterator]=function(){return h}),h}function v(c){this.map={},c instanceof v?c.forEach(function(h,m){this.append(m,h)},this):Array.isArray(c)?c.forEach(function(h){this.append(h[0],h[1])},this):c&&Object.getOwnPropertyNames(c).forEach(function(h){this.append(h,c[h])},this)}v.prototype.append=function(c,h){c=_(c),h=I(h);var m=this.map[c];this.map[c]=m?m+", "+h:h},v.prototype.delete=function(c){delete this.map[_(c)]},v.prototype.get=function(c){return c=_(c),this.has(c)?this.map[c]:null},v.prototype.has=function(c){return this.map.hasOwnProperty(_(c))},v.prototype.set=function(c,h){this.map[_(c)]=I(h)},v.prototype.forEach=function(c,h){for(var m in this.map)this.map.hasOwnProperty(m)&&c.call(h,this.map[m],m,this)},v.prototype.keys=function(){var c=[];return this.forEach(function(h,m){c.push(m)}),g(c)},v.prototype.values=function(){var c=[];return this.forEach(function(h){c.push(h)}),g(c)},v.prototype.entries=function(){var c=[];return this.forEach(function(h,m){c.push([m,h])}),g(c)},a.iterable&&(v.prototype[Symbol.iterator]=v.prototype.entries);function x(c){if(c.bodyUsed)return Promise.reject(new TypeError("Already read"));c.bodyUsed=!0}function A(c){return new Promise(function(h,m){c.onload=function(){h(c.result)},c.onerror=function(){m(c.error)}})}function N(c){var h=new FileReader,m=A(h);return h.readAsArrayBuffer(c),m}function K(c){var h=new FileReader,m=A(h);return h.readAsText(c),m}function P(c){for(var h=new Uint8Array(c),m=new Array(h.length),E=0;E<h.length;E++)m[E]=String.fromCharCode(h[E]);return m.join("")}function $(c){if(c.slice)return c.slice(0);var h=new Uint8Array(c.byteLength);return h.set(new Uint8Array(c)),h.buffer}function L(){return this.bodyUsed=!1,this._initBody=function(c){this._bodyInit=c,c?typeof c=="string"?this._bodyText=c:a.blob&&Blob.prototype.isPrototypeOf(c)?this._bodyBlob=c:a.formData&&FormData.prototype.isPrototypeOf(c)?this._bodyFormData=c:a.searchParams&&URLSearchParams.prototype.isPrototypeOf(c)?this._bodyText=c.toString():a.arrayBuffer&&a.blob&&u(c)?(this._bodyArrayBuffer=$(c.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):a.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(c)||f(c))?this._bodyArrayBuffer=$(c):this._bodyText=c=Object.prototype.toString.call(c):this._bodyText="",this.headers.get("content-type")||(typeof c=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):a.searchParams&&URLSearchParams.prototype.isPrototypeOf(c)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},a.blob&&(this.blob=function(){var c=x(this);if(c)return c;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?x(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(N)}),this.text=function(){var c=x(this);if(c)return c;if(this._bodyBlob)return K(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(P(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},a.formData&&(this.formData=function(){return this.text().then(U)}),this.json=function(){return this.text().then(JSON.parse)},this}var X=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function V(c){var h=c.toUpperCase();return X.indexOf(h)>-1?h:c}function Y(c,h){h=h||{};var m=h.body;if(c instanceof Y){if(c.bodyUsed)throw new TypeError("Already read");this.url=c.url,this.credentials=c.credentials,h.headers||(this.headers=new v(c.headers)),this.method=c.method,this.mode=c.mode,this.signal=c.signal,!m&&c._bodyInit!=null&&(m=c._bodyInit,c.bodyUsed=!0)}else this.url=String(c);if(this.credentials=h.credentials||this.credentials||"same-origin",(h.headers||!this.headers)&&(this.headers=new v(h.headers)),this.method=V(h.method||this.method||"GET"),this.mode=h.mode||this.mode||null,this.signal=h.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&m)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(m)}Y.prototype.clone=function(){return new Y(this,{body:this._bodyInit})};function U(c){var h=new FormData;return c.trim().split("&").forEach(function(m){if(m){var E=m.split("="),S=E.shift().replace(/\+/g," "),O=E.join("=").replace(/\+/g," ");h.append(decodeURIComponent(S),decodeURIComponent(O))}}),h}function G(c){var h=new v,m=c.replace(/\r?\n[\t ]+/g," ");return m.split(/\r?\n/).forEach(function(E){var S=E.split(":"),O=S.shift().trim();if(O){var C=S.join(":").trim();h.append(O,C)}}),h}L.call(Y.prototype);function M(c,h){h||(h={}),this.type="default",this.status=h.status===void 0?200:h.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in h?h.statusText:"OK",this.headers=new v(h.headers),this.url=h.url||"",this._initBody(c)}L.call(M.prototype),M.prototype.clone=function(){return new M(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new v(this.headers),url:this.url})},M.error=function(){var c=new M(null,{status:0,statusText:""});return c.type="error",c};var D=[301,302,303,307,308];M.redirect=function(c,h){if(D.indexOf(h)===-1)throw new RangeError("Invalid status code");return new M(null,{status:h,headers:{location:c}})},o.DOMException=s.DOMException;try{new o.DOMException}catch{o.DOMException=function(h,m){this.message=h,this.name=m;var E=Error(h);this.stack=E.stack},o.DOMException.prototype=Object.create(Error.prototype),o.DOMException.prototype.constructor=o.DOMException}function w(c,h){return new Promise(function(m,E){var S=new Y(c,h);if(S.signal&&S.signal.aborted)return E(new o.DOMException("Aborted","AbortError"));var O=new XMLHttpRequest;function C(){O.abort()}O.onload=function(){var R={status:O.status,statusText:O.statusText,headers:G(O.getAllResponseHeaders()||"")};R.url="responseURL"in O?O.responseURL:R.headers.get("X-Request-URL");var y="response"in O?O.response:O.responseText;m(new M(y,R))},O.onerror=function(){E(new TypeError("Network request failed"))},O.ontimeout=function(){E(new TypeError("Network request failed"))},O.onabort=function(){E(new o.DOMException("Aborted","AbortError"))},O.open(S.method,S.url,!0),S.credentials==="include"?O.withCredentials=!0:S.credentials==="omit"&&(O.withCredentials=!1),"responseType"in O&&a.blob&&(O.responseType="blob"),S.headers.forEach(function(R,y){O.setRequestHeader(y,R)}),S.signal&&(S.signal.addEventListener("abort",C),O.onreadystatechange=function(){O.readyState===4&&S.signal.removeEventListener("abort",C)}),O.send(typeof S._bodyInit>"u"?null:S._bodyInit)})}return w.polyfill=!0,s.fetch||(s.fetch=w,s.Headers=v,s.Request=Y,s.Response=M),o.Headers=v,o.Request=Y,o.Response=M,o.fetch=w,Object.defineProperty(o,"__esModule",{value:!0}),o})({})})(r),r.fetch.ponyfill=!0,delete r.fetch.polyfill;var i=r;e=i.fetch,e.default=i.fetch,e.fetch=i.fetch,e.Headers=i.Headers,e.Request=i.Request,e.Response=i.Response,n.exports=e})(Uu,Uu.exports);ge.rustEnum([ge.struct([],"uninitialized"),ge.struct([ge.option(ge.publicKey(),"authorityAddress")],"buffer"),ge.struct([ge.publicKey("programdataAddress")],"program"),ge.struct([ge.u64("slot"),ge.option(ge.publicKey(),"upgradeAuthorityAddress")],"programData")],void 0,ge.u32());const ca="Program log: ",Vd="Program data: ",tb=ca.length,rb=Vd.length;class nb{constructor(e,t,r){this._programId=e,this._provider=t,this._eventParser=new jd(e,r),this._eventCallbacks=new Map,this._eventListeners=new Map,this._listenerIdCount=0}addEventListener(e,t,r){var i;let s=this._listenerIdCount;return this._listenerIdCount+=1,this._eventListeners.has(e)||this._eventListeners.set(e,[]),this._eventListeners.set(e,((i=this._eventListeners.get(e))!==null&&i!==void 0?i:[]).concat(s)),this._eventCallbacks.set(s,[e,t]),this._onLogsSubscriptionId!==void 0||(this._onLogsSubscriptionId=this._provider.connection.onLogs(this._programId,(o,a)=>{if(!o.err)for(const u of this._eventParser.parseLogs(o.logs)){const l=this._eventListeners.get(u.name);l&&l.forEach(f=>{const _=this._eventCallbacks.get(f);if(_){const[,I]=_;I(u.data,a.slot,o.signature)}})}},r)),s}async removeEventListener(e){const t=this._eventCallbacks.get(e);if(!t)throw new Error(`Event listener ${e} doesn't exist!`);const[r]=t;let i=this._eventListeners.get(r);if(!i)throw new Error(`Event listeners don't exist for ${r}!`);if(this._eventCallbacks.delete(e),i=i.filter(s=>s!==e),this._eventListeners.set(r,i),i.length===0&&this._eventListeners.delete(r),this._eventCallbacks.size===0){if(this._eventListeners.size!==0)throw new Error(`Expected event listeners size to be 0 but got ${this._eventListeners.size}`);this._onLogsSubscriptionId!==void 0&&(await this._provider.connection.removeOnLogsListener(this._onLogsSubscriptionId),this._onLogsSubscriptionId=void 0)}}}class jd{constructor(e,t){this.coder=t,this.programId=e}*parseLogs(e,t=!1){const r=new sb(e),i=new ib;let s=r.next();for(;s!==null;){let[o,a,u]=this.handleLog(i,s,t);o&&(yield o),a&&i.push(a),u&&i.pop(),s=r.next()}}handleLog(e,t,r){return e.stack.length>0&&e.program()===this.programId.toString()?this.handleProgramLog(t,r):[null,...this.handleSystemLog(t)]}handleProgramLog(e,t){if(e.startsWith(ca)||e.startsWith(Vd)){const r=e.startsWith(ca)?e.slice(tb):e.slice(rb),i=this.coder.events.decode(r);if(t&&i===null)throw new Error(`Unable to decode event ${r}`);return[i,null,!1]}else return[null,...this.handleSystemLog(e)]}handleSystemLog(e){const t=e.split(":")[0];return t.match(/^Program (.*) success/g)!==null?[null,!0]:t.startsWith(`Program ${this.programId.toString()} invoke`)?[this.programId.toString(),!1]:t.includes("invoke")?["cpi",!1]:[null,!1]}}class ib{constructor(){this.stack=[]}program(){if(!this.stack.length)throw new Error("Expected the stack to have elements");return this.stack[this.stack.length-1]}push(e){this.stack.push(e)}pop(){if(!this.stack.length)throw new Error("Expected the stack to have elements");this.stack.pop()}}class sb{constructor(e){this.logs=e}next(){if(this.logs.length===0)return null;let e=this.logs[0];return this.logs=this.logs.slice(1),e}}function Ks(n,e){var t,r;let i={};const s=n.args?n.args.length:0;if(e.length>s){if(e.length!==s+1)throw new Error(`provided too many arguments ${e} to instruction ${n==null?void 0:n.name} expecting: ${(r=(t=n.args)===null||t===void 0?void 0:t.map(o=>o.name))!==null&&r!==void 0?r:[]}`);i=e.pop()}return[e,i]}class ys{static build(e,t,r){if(e.name==="_inner")throw new Vr("the _inner name is reserved");const i=(...s)=>{const[o,a]=Ks(e,[...s]);lf(e.accounts,a.accounts),ob(e,...s);const u=i.accounts(a.accounts);return a.remainingAccounts!==void 0&&u.push(...a.remainingAccounts),Ud("debug-logs")&&console.log("Outgoing account metas:",u),new Ce({keys:u,programId:r,data:t(e.name,w_(e,...o))})};return i.accounts=s=>ys.accountsArray(s,e.accounts,r,e.name),i}static accountsArray(e,t,r,i){return e?t.map(s=>{if(jr(s)){const f=e[s.name];return ys.accountsArray(f,s.accounts,r,i).flat()}let o;try{o=ar(e[s.name])}catch{throw new Error(`Wrong input type for account "${s.name}" in the instruction accounts object${i!==void 0?' for instruction "'+i+'"':""}. Expected PublicKey or string.`)}const a=s.optional&&o.equals(r),u=!!(s.writable&&!a),l=!!(s.signer&&!a);return{pubkey:o,isWritable:u,isSigner:l}}).flat():[]}}function ob(n,...e){}class ab{static build(e,t){return(...i)=>{var s,o,a;const[,u]=Ks(e,[...i]),l=new ke;if(u.preInstructions&&u.instructions)throw new Error("instructions is deprecated, use preInstructions");return(s=u.preInstructions)===null||s===void 0||s.forEach(f=>l.add(f)),(o=u.instructions)===null||o===void 0||o.forEach(f=>l.add(f)),l.add(t(...i)),(a=u.postInstructions)===null||a===void 0||a.forEach(f=>l.add(f)),l}}}class cb{static build(e,t,r,i){return async(...o)=>{var a;const u=t(...o),[,l]=Ks(e,[...o]);if(i.sendAndConfirm===void 0)throw new Error("This function requires 'Provider.sendAndConfirm' to be implemented.");try{return await i.sendAndConfirm(u,(a=l.signers)!==null&&a!==void 0?a:[],l.options)}catch(f){throw Dd(f,r)}}}}class ub{static build(e,t,r,i){var s;return((s=e.accounts)!==null&&s!==void 0?s:[]).reduce((o,a)=>(o[a.name]=new lb(e,a,r,i,t),o),{})}}class lb{get size(){return this._size}get programId(){return this._programId}get provider(){return this._provider}get coder(){return this._coder}constructor(e,t,r,i,s){this._idlAccount=t,this._programId=r,this._provider=i??sa(),this._coder=s??new Fd(e),this._size=this._coder.accounts.size(t.name)}async fetchNullable(e,t){const{data:r}=await this.fetchNullableAndContext(e,t);return r}async fetchNullableAndContext(e,t){const r=await this.getAccountInfoAndContext(e,t),{value:i,context:s}=r;return{data:i&&i.data.length!==0?this._coder.accounts.decode(this._idlAccount.name,i.data):null,context:s}}async fetch(e,t){const{data:r}=await this.fetchNullableAndContext(e,t);if(r===null)throw new Error(`Account does not exist or has no data ${e.toString()}`);return r}async fetchAndContext(e,t){const{data:r,context:i}=await this.fetchNullableAndContext(e,t);if(r===null)throw new Error(`Account does not exist ${e.toString()}`);return{data:r,context:i}}async fetchMultiple(e,t){return(await this.fetchMultipleAndContext(e,t)).map(i=>i?i.data:null)}async fetchMultipleAndContext(e,t){return(await T_(this._provider.connection,e.map(i=>ar(i)),t)).map(i=>{if(i==null)return null;const{account:s,context:o}=i;return{data:this._coder.accounts.decode(this._idlAccount.name,s.data),context:o}})}async all(e){const t=this.coder.accounts.memcmp(this._idlAccount.name,e instanceof Buffer?e:void 0),r=[];return(t==null?void 0:t.offset)!=null&&(t==null?void 0:t.bytes)!=null&&r.push({memcmp:{offset:t.offset,bytes:t.bytes}}),(t==null?void 0:t.dataSize)!=null&&r.push({dataSize:t.dataSize}),(await this._provider.connection.getProgramAccounts(this._programId,{commitment:this._provider.connection.commitment,filters:[...r,...Array.isArray(e)?e:[]]})).map(({pubkey:s,account:o})=>({publicKey:s,account:this._coder.accounts.decode(this._idlAccount.name,o.data)}))}subscribe(e,t){const r=si.get(e.toString());if(r)return r.ee;const i=new u_;e=ar(e);const s=this._provider.connection.onAccountChange(e,o=>{const a=this._coder.accounts.decode(this._idlAccount.name,o.data);i.emit("change",a)},t);return si.set(e.toString(),{ee:i,listener:s}),i}async unsubscribe(e){let t=si.get(e.toString());if(!t){console.warn("Address is not subscribed");return}si&&await this._provider.connection.removeAccountChangeListener(t.listener).then(()=>{si.delete(e.toString())}).catch(console.error)}async createInstruction(e,t){const r=this.size;if(this._provider.publicKey===void 0)throw new Error("This function requires the Provider interface implementor to have a 'publicKey' field.");return $e.createAccount({fromPubkey:this._provider.publicKey,newAccountPubkey:e.publicKey,space:t??r,lamports:await this._provider.connection.getMinimumBalanceForRentExemption(t??r),programId:this._programId})}async getAccountInfo(e,t){return await this._provider.connection.getAccountInfo(ar(e),t)}async getAccountInfoAndContext(e,t){return await this._provider.connection.getAccountInfoAndContext(ar(e),t)}}const si=new Map;class hb{static build(e,t,r,i,s,o,a){return async(...l)=>{var f;const _=t(...l),[,I]=Ks(e,[...l]);let g;if(i.simulate===void 0)throw new Error("This function requires 'Provider.simulate' to be implemented.");try{g=await i.simulate(_,I.signers,(f=I.options)===null||f===void 0?void 0:f.commitment)}catch(A){throw Dd(A,r)}if(g===void 0)throw new Error("Unable to simulate transaction");const v=g.logs;if(!v)throw new Error("Simulated logs not found");const x=[];if(a.events){let A=new jd(o,s);for(const N of A.parseLogs(v))x.push(N)}return{events:x,raw:v}}}}function Fo(n){return new Zd(Ni(8),e=>db.fromBuffer(e),e=>e.toBuffer(),n)}function ji(n){return new Zd(Ni(32),e=>new j(e),e=>e.toBuffer(),n)}function Ho(n,e){return new fb(n,e)}class Zd extends Hs{constructor(e,t,r,i){super(e.span,i),this.layout=e,this.decoder=t,this.encoder=r}decode(e,t){return this.decoder(this.layout.decode(e,t))}encode(e,t,r){return this.layout.encode(this.encoder(e),t,r)}getSpan(e,t){return this.layout.getSpan(e,t)}}class fb extends Hs{constructor(e,t){super(-1,t),this.layout=e,this.discriminator=Ur()}encode(e,t,r=0){return e==null?this.layout.span+this.discriminator.encode(0,t,r):(this.discriminator.encode(1,t,r),this.layout.encode(e,t,r+4)+4)}decode(e,t=0){const r=this.discriminator.decode(e,t);if(r===0)return null;if(r===1)return this.layout.decode(e,t+4);throw new Error("Invalid coption "+this.layout.property)}getSpan(e,t=0){return this.layout.getSpan(e,t+4)+4}}let db=class Yd extends Mt{toBuffer(){const e=super.toArray().reverse(),t=Buffer.from(e);if(t.length===8)return t;if(t.length>=8)throw new Error("u64 too large");const r=Buffer.alloc(8);return t.copy(r),r}static fromBuffer(e){if(e.length!==8)throw new Error(`Invalid buffer length: ${e.length}`);return new Yd([...e].reverse().map(t=>`00${t.toString(16)}`.slice(-2)).join(""),16)}};const pb=Rt([ji("mint"),ji("owner"),Fo("amount"),Ho(ji(),"delegate"),(n=>{const e=qd(X_("discriminator"),null,n);return e.addVariant(0,Rt([]),"uninitialized"),e.addVariant(1,Rt([]),"initialized"),e.addVariant(2,Rt([]),"frozen"),e})("state"),Ho(Fo(),"isNative"),Fo("delegatedAmount"),Ho(ji(),"closeAuthority")]);function yb(n){return pb.decode(n)}class gb{constructor(e,t,r,i,s,o,a,u){this._args=e,this._accounts=t,this._provider=r,this._programId=i,this._idlIx=s,this._idlTypes=a,this._customResolver=u,this._accountStore=new mb(r,o,i)}args(e){this._args=e}async resolve(){this.resolveEventCpi(this._idlIx.accounts),this.resolveConst(this._idlIx.accounts);let e=0;for(;await this.resolvePdasAndRelations(this._idlIx.accounts)+await this.resolveCustom()>0;)if(e++,e===16){const t=o=>jr(o)?o.accounts.some(t):!!(o.address||o.pda||o.relations),r=(o,a=[],u=[])=>{for(const l of o)jr(l)?u.push(...r(l.accounts,[...a,l.name])):u.push([...a,l.name]);return u},i=this._idlIx.accounts.filter(t),s=r(i).filter(o=>!this.get(o)).map(o=>o.reduce((a,u)=>a+"."+u)).map(o=>`\`${o}\``).join(", ");throw new Error(["Reached maximum depth for account resolution.",`Unresolved accounts: ${s}`].join(" "))}}resolveOptionals(e){Object.assign(this._accounts,this.resolveOptionalsHelper(e,this._idlIx.accounts))}get(e){const t=e.reduce((r,i)=>r&&r[i],this._accounts);if(t&&t.toBase58)return t}set(e,t){let r=this._accounts;e.forEach((i,s)=>{var o;s===e.length-1&&(r[i]=t),r[i]=(o=r[i])!==null&&o!==void 0?o:{},r=r[i]})}resolveOptionalsHelper(e,t){const r={};for(const i of t){const s=i.name,o=e[s];o!==void 0&&(Xd(o)?jr(i)?r[s]=this.resolveOptionalsHelper(o,i.accounts):r[s]=Jd(o):o!==null?r[s]=ar(o):i.optional&&(r[s]=this._programId))}return r}async resolveCustom(){if(this._customResolver){const{accounts:e,resolved:t}=await this._customResolver({args:this._args,accounts:this._accounts,provider:this._provider,programId:this._programId,idlIx:this._idlIx});return this._accounts=e,t}return 0}resolveEventCpi(e,t=[]){for(const r in e){const i=e[r];jr(i)&&this.resolveEventCpi(i.accounts,[...t,i.name]);const s=+r+1;if(s===e.length)return;const o=e[r].name,a=e[s].name;if(o==="eventAuthority"&&a==="program"){const u=[...t,o],l=[...t,a];this.get(u)||this.set(u,j.findProgramAddressSync([Buffer.from("__event_authority")],this._programId)[0]),this.get(l)||this.set(l,this._programId);return}}}resolveConst(e,t=[]){for(const r of e){const i=r.name;if(jr(r))this.resolveConst(r.accounts,[...t,i]);else{const s=r;if((s.signer||s.address)&&!this.get([...t,i])){if(s.signer){if(!this._provider.publicKey)throw new Error("This function requires the `Provider` interface implementor to have a `publicKey` field.");this.set([...t,i],this._provider.publicKey)}s.address&&this.set([...t,i],ar(s.address))}}}}async resolvePdasAndRelations(e,t=[]){let r=0;for(const i of e){const s=i.name;if(jr(i))r+=await this.resolvePdasAndRelations(i.accounts,[...t,s]);else{const o=i;if((o.pda||o.relations)&&!this.get([...t,s])){r++;try{if(o.pda){const a=await Promise.all(o.pda.seeds.map(f=>this.toBuffer(f,t)));if(a.some(f=>!f))continue;const u=await this.parseProgramId(o,t),[l]=j.findProgramAddressSync(a,u);this.set([...t,s],l)}}catch{}try{if(o.relations){const a=this.get([...t,o.relations[0]]);if(a){const u=await this._accountStore.fetchAccount({publicKey:a});this.set([...t,s],u[s])}}}catch{}}}}return r}async parseProgramId(e,t=[]){var r;if(!(!((r=e.pda)===null||r===void 0)&&r.program))return this._programId;const i=await this.toBuffer(e.pda.program,t);if(!i)throw new Error(`Program seed not resolved: ${e.name}`);return new j(i)}async toBuffer(e,t=[]){switch(e.kind){case"const":return this.toBufferConst(e);case"arg":return await this.toBufferArg(e);case"account":return await this.toBufferAccount(e,t);default:throw new Error(`Unexpected seed: ${e}`)}}toBufferConst(e){return this.toBufferValue("bytes",e.value)}async toBufferArg(e){const[t,...r]=e.path.split("."),i=this._idlIx.args.findIndex(a=>a.name===t);if(i===-1)throw new Error(`Unable to find argument for seed: ${t}`);const s=r.reduce((a,u)=>(a??{})[u],this._args[i]);if(s===void 0)return;const o=this.getType(this._idlIx.args[i].type,r);return this.toBufferValue(o,s)}async toBufferAccount(e,t=[]){const[r,...i]=e.path.split("."),s=this.get([...t,r]);if(!s)return;if(!i.length)return this.toBufferValue("pubkey",s);if(!e.account)throw new Error(`Seed account is required in order to resolve type: ${e.path}`);let a=await this._accountStore.fetchAccount({publicKey:s,name:e.account}),u=i;for(;u.length>0;)a=a[u[0]],u=u.slice(1);if(a===void 0)return;const l=this.getType({defined:{name:e.account}},i);return this.toBufferValue(l,a)}toBufferValue(e,t){switch(e){case"u8":case"i8":return Buffer.from([t]);case"u16":case"i16":return new Mt(t).toArrayLike(Buffer,"le",2);case"u32":case"i32":return new Mt(t).toArrayLike(Buffer,"le",4);case"u64":case"i64":return new Mt(t).toArrayLike(Buffer,"le",8);case"u128":case"i128":return new Mt(t).toArrayLike(Buffer,"le",16);case"u256":case"i256":return new Mt(t).toArrayLike(Buffer,"le",32);case"string":return Buffer.from(t);case"pubkey":return t.toBuffer();case"bytes":return Buffer.from(t);default:if(e!=null&&e.array)return Buffer.from(t);throw new Error(`Unexpected seed type: ${e}`)}}getType(e,t=[]){var r;const i=(r=e==null?void 0:e.defined)===null||r===void 0?void 0:r.name;if(i){if(i==="tokenAccount")switch(t.at(0)){case"mint":case"owner":return"pubkey";case"amount":case"delagatedAmount":return"u64";default:throw new Error(`Unknown token account path: ${t}`)}const s=this._idlTypes.find(f=>f.name===i);if(!s)throw new Error(`Type not found: ${i}`);const[o,...a]=t,l=s.type.fields.find(f=>f.name===o);if(!l)throw new Error(`Field not found: ${o}`);return this.getType(l.type,a)}return e}}class mb{constructor(e,t,r){this._provider=e,this._cache=new Map,this._idls={},this._idls[r.toBase58()]=t}async fetchAccount({publicKey:e,name:t}){const r=e.toBase58();if(!this._cache.has(r)){const i=await this._provider.connection.getAccountInfo(e);if(i===null)throw new Error(`Account not found: ${r}`);if(t==="tokenAccount"){const s=yb(i.data);this._cache.set(r,s)}else{const s=await this.getAccountsNs(i.owner);if(s){const o=Object.values(s)[0];if(o){const a=o.coder.accounts.decodeAny(i.data);this._cache.set(r,a)}}}}return this._cache.get(r)}async getAccountsNs(e){const t=e.toBase58();if(!this._idls[t]){const r=await qn.fetchIdl(e,this._provider);if(r){const i=new qn(r,this._provider);this._idls[t]=i.account}}return this._idls[t]}}class wb{static build(e,t,r,i,s,o,a,u,l,f,_){return(...I)=>new _b(I,i,s,o,a,u,e,t,r,l,f,_)}}function Xd(n){return typeof n=="object"&&n!==null&&!("_bn"in n)}function Jd(n,e){const t={};for(const r in n){const i=n[r];if(i===null)throw new Error("Failed to resolve optionals due to IDL type mismatch with input accounts!");t[r]=Xd(i)?Jd(i):ar(i)}return t}class _b{constructor(e,t,r,i,s,o,a,u,l,f,_,I){this._args=e,this._ixFn=t,this._txFn=r,this._rpcFn=i,this._simulateFn=s,this._viewFn=o,this._accounts={},this._remainingAccounts=[],this._signers=[],this._preInstructions=[],this._postInstructions=[],this._resolveAccounts=!0,this._accountsResolver=new gb(e,this._accounts,a,u,l,f,_,I)}args(e){this._args=e,this._accountsResolver.args(e)}accounts(e){return this.accountsPartial(e)}accountsPartial(e){return this._resolveAccounts=!0,this._accountsResolver.resolveOptionals(e),this}accountsStrict(e){return this._resolveAccounts=!1,this._accountsResolver.resolveOptionals(e),this}signers(e){return this._signers=this._signers.concat(e),this}remainingAccounts(e){return this._remainingAccounts=this._remainingAccounts.concat(e),this}preInstructions(e,t=!1){return t?this._preInstructions=e.concat(this._preInstructions):this._preInstructions=this._preInstructions.concat(e),this}postInstructions(e){return this._postInstructions=this._postInstructions.concat(e),this}async pubkeys(){return this._resolveAccounts&&await this._accountsResolver.resolve(),this._accounts}async instruction(){return this._resolveAccounts&&await this._accountsResolver.resolve(),this._ixFn(...this._args,{accounts:this._accounts,signers:this._signers,remainingAccounts:this._remainingAccounts,preInstructions:this._preInstructions,postInstructions:this._postInstructions})}async transaction(){return this._resolveAccounts&&await this._accountsResolver.resolve(),this._txFn(...this._args,{accounts:this._accounts,signers:this._signers,remainingAccounts:this._remainingAccounts,preInstructions:this._preInstructions,postInstructions:this._postInstructions})}async simulate(e){return this._resolveAccounts&&await this._accountsResolver.resolve(),this._simulateFn(...this._args,{accounts:this._accounts,signers:this._signers,remainingAccounts:this._remainingAccounts,preInstructions:this._preInstructions,postInstructions:this._postInstructions,options:e})}async view(e){if(this._resolveAccounts&&await this._accountsResolver.resolve(),!this._viewFn)throw new Error(["Method does not support views.","The instruction should return a value, and its accounts must be read-only"].join(" "));return this._viewFn(...this._args,{accounts:this._accounts,signers:this._signers,remainingAccounts:this._remainingAccounts,preInstructions:this._preInstructions,postInstructions:this._postInstructions,options:e})}async rpc(e){return this._resolveAccounts&&await this._accountsResolver.resolve(),this._rpcFn(...this._args,{accounts:this._accounts,signers:this._signers,remainingAccounts:this._remainingAccounts,preInstructions:this._preInstructions,postInstructions:this._postInstructions,options:e})}async rpcAndKeys(e){return{signature:await this.rpc(e),pubkeys:await this.pubkeys()}}async prepare(){return{instruction:await this.instruction(),signers:this._signers,pubkeys:await this.pubkeys()}}}class bb{static build(e,t,r,i){const s=t.accounts.find(u=>u.writable),o=!!t.returns;return s||!o?void 0:async(...u)=>{let l=await r(...u);const f=`Program return: ${e} `;let _=l.raw.find(x=>x.startsWith(f));if(!_)throw new Error("View expected return log");let I=uf(_.slice(f.length)),g=t.returns;if(!g)throw new Error("View expected return type");return Se.fieldLayout({type:g},i.types).decode(I)}}}class Eb{static build(e,t,r,i,s){const o={},a={},u={},l={},f={},_={},I=m_(e),g=e.accounts?ub.build(e,t,r,i):{};return e.instructions.forEach(v=>{const x=ys.build(v,(X,V)=>t.instruction.encode(X,V),r),A=ab.build(v,x),N=cb.build(v,A,I,i),K=hb.build(v,A,I,i,t,r,e),P=bb.build(r,v,K,e),$=wb.build(i,r,v,x,A,N,K,P,g,e.types||[],s==null?void 0:s(v)),L=v.name;a[L]=x,u[L]=A,o[L]=N,l[L]=K,f[L]=$,P&&(_[L]=P)}),[o,a,u,g,l,f,_]}}class qn{get programId(){return this._programId}get idl(){return this._idl}get rawIdl(){return this._rawIdl}get coder(){return this._coder}get provider(){return this._provider}constructor(e,t=sa(),r,i){this._idl=g_(e),this._rawIdl=e,this._provider=t,this._programId=ar(e.address),this._coder=r??new Fd(this._idl),this._events=new nb(this._programId,t,this._coder);const[s,o,a,u,l,f,_]=Eb.build(this._idl,this._coder,this._programId,t,i);this.rpc=s,this.instruction=o,this.transaction=a,this.account=u,this.simulate=l,this.methods=f,this.views=_}static async at(e,t){const r=ar(e),i=await qn.fetchIdl(r,t);if(!i)throw new Error(`IDL not found for program: ${e.toString()}`);return new qn(i,t)}static async fetchIdl(e,t){t=t??sa();const r=ar(e),i=await f_(r),s=await t.connection.getAccountInfo(i);if(!s)return null;let o=y_(s.data.slice(8));const a=a_(o.data);return JSON.parse(h_(a))}addEventListener(e,t,r){return this._events.addEventListener(e,t,r)}async removeEventListener(e){return await this._events.removeEventListener(e)}}new j("11111111111111111111111111111111");function Rb(){const n="c960fbe9-1c0e-4ece-b626-fb3b48e7bf65";console.log("🔧 環境変数デバッグ:",{heliusApiKey:`${n.slice(0,8)}...`,mode:"production",dev:!1});const e={programId:"7r3R1S43BS9fQbh1eBhM63u8XZJd7bYRtgMrAQRNrfcB",network:"devnet",rpcUrl:`https://devnet.helius-rpc.com/?api-key=${n}`};return console.log("📋 設定読み込み完了:"),console.log(`  - Program ID: ${e.programId}`),console.log(`  - Network: ${e.network}`),console.log(`  - RPC URL: ${e.rpcUrl.split("?")[0]}?api-key=***`),e}const Gr=Rb();class Ab{constructor(){me(this,"logs",[]);me(this,"logElement",null);typeof document<"u"&&(document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>{this.logElement=document.getElementById("logs")}):this.logElement=document.getElementById("logs"))}addLog(e,t){const r={timestamp:new Date,level:e,message:t};switch(this.logs.push(r),e){case"error":console.error(t);break;case"warn":console.warn(t);break;case"success":console.log(`✅ ${t}`);break;default:console.log(t)}this.updateLogDisplay()}updateLogDisplay(){if(!this.logElement)return;const e=this.logs.slice(-50).map(t=>{const r=t.timestamp.toLocaleTimeString(),i=this.getLogIcon(t.level);return`[${r}] ${i} ${t.message}`}).join(`
`);this.logElement.textContent=e,this.logElement.scrollTop=this.logElement.scrollHeight}getLogIcon(e){switch(e){case"error":return"❌";case"warn":return"⚠️";case"success":return"✅";default:return"📋"}}info(e){this.addLog("info",e)}warn(e){this.addLog("warn",e)}error(e){this.addLog("error",e)}success(e){this.addLog("success",e)}clear(){this.logs=[],this.logElement&&(this.logElement.textContent=`ログをクリアしました...
`)}getLogs(){return[...this.logs]}}const Z=new Ab,Mr=new j("TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA");new j("TokenzQdBNbLqP5VEhdkAS6EPFLC1PHnBqCXEpPxuEb");const tc=new j("ATokenGPvbdGVxr1b2hvZbsiqW5xWH25efTNsLJA8knL");new j("So11111111111111111111111111111111111111112");new j("9pan9bMn5HatX4EJdBwg9VgCa7Uz5HL8N1m5D3NdXejP");const rc=n=>{const e=n.decode.bind(n),t=n.encode.bind(n);return{decode:e,encode:t}};var Ci={};Object.defineProperty(Ci,"__esModule",{value:!0});function vb(n){{const e=Buffer.from(n);e.reverse();const t=e.toString("hex");return t.length===0?BigInt(0):BigInt(`0x${t}`)}}var Sb=Ci.toBigIntLE=vb;function Ib(n){{const e=n.toString("hex");return e.length===0?BigInt(0):BigInt(`0x${e}`)}}Ci.toBigIntBE=Ib;function kb(n,e){{const t=n.toString(16),r=Buffer.from(t.padStart(e*2,"0").slice(0,e*2),"hex");return r.reverse(),r}}var Tb=Ci.toBufferLE=kb;function xb(n,e){{const t=n.toString(16);return Buffer.from(t.padStart(e*2,"0").slice(0,e*2),"hex")}}Ci.toBufferBE=xb;const Ob=n=>e=>{const t=Le(n,e),{encode:r,decode:i}=rc(t),s=t;return s.decode=(o,a)=>{const u=i(o,a);return Sb(Buffer.from(u))},s.encode=(o,a,u)=>{const l=Tb(o,n);return r(l,a,u)},s},Nb=Ob(8),Cb=n=>{const e=ve(n),{encode:t,decode:r}=rc(e),i=e;return i.decode=(s,o)=>!!r(s,o),i.encode=(s,o,a)=>{const u=Number(s);return t(u,o,a)},i},Du=n=>{const e=Le(32,n),{encode:t,decode:r}=rc(e),i=e;return i.decode=(s,o)=>{const a=r(s,o);return new j(a)},i.encode=(s,o,a)=>{const u=s.toBuffer();return t(u,o,a)},i};class Bb extends Error{constructor(e){super(e)}}class Mb extends Bb{constructor(){super(...arguments),this.name="TokenOwnerOffCurveError"}}const Lb=ue([ce("mintAuthorityOption"),Du("mintAuthority"),Nb("supply"),ve("decimals"),Cb("isInitialized"),ce("freezeAuthorityOption"),Du("freezeAuthority")]);Lb.span;async function dr(n,e,t=!1,r=Mr,i=tc){if(!t&&!j.isOnCurve(e.toBuffer()))throw new Mb;const[s]=await j.findProgramAddress([e.toBuffer(),r.toBuffer(),n.toBuffer()],i);return s}function Pb(n,e,t,r,i=Mr,s=tc){return Ub(n,e,t,r,Buffer.alloc(0),i,s)}function Ub(n,e,t,r,i,s=Mr,o=tc){const a=[{pubkey:n,isSigner:!0,isWritable:!0},{pubkey:e,isSigner:!1,isWritable:!0},{pubkey:t,isSigner:!1,isWritable:!1},{pubkey:r,isSigner:!1,isWritable:!1},{pubkey:$e.programId,isSigner:!1,isWritable:!1},{pubkey:s,isSigner:!1,isWritable:!1}];return new Ce({keys:a,programId:o,data:i})}class Qd{static async calculatePDAs(e,t){const[r]=await j.findProgramAddress([te.Buffer.from("user"),e.toBuffer()],t),[i]=await j.findProgramAddress([te.Buffer.from("facility"),e.toBuffer()],t),[s]=await j.findProgramAddress([te.Buffer.from("config")],t),[o]=await j.findProgramAddress([te.Buffer.from("reward_mint")],t),[a]=await j.findProgramAddress([te.Buffer.from("mint_authority")],t),[u]=await j.findProgramAddress([te.Buffer.from("treasury")],t);return{userState:r,facility:i,config:s,rewardMint:o,mintAuthority:a,treasury:u}}static async getUserStatePDA(e,t){return await j.findProgramAddress([te.Buffer.from("user"),e.toBuffer()],t)}static async getFacilityPDA(e,t){return await j.findProgramAddress([te.Buffer.from("facility"),e.toBuffer()],t)}static async getConfigPDA(e){return await j.findProgramAddress([te.Buffer.from("config")],e)}static async getRewardMintPDA(e){return await j.findProgramAddress([te.Buffer.from("reward_mint")],e)}static async getMintAuthorityPDA(e){return await j.findProgramAddress([te.Buffer.from("mint_authority")],e)}}class Db{constructor(){me(this,"cache");me(this,"DEFAULT_TTL",3e4);me(this,"CONFIG_TTL",3e5);me(this,"USER_STATE_TTL",15e3);me(this,"FACILITY_TTL",2e4);this.cache={pdas:new Map,configs:new Map,userStates:new Map,facilities:new Map},setInterval(()=>this.cleanup(),6e4)}cachePDAs(e,t){const r=e.toString();this.cache.pdas.set(r,{data:t,timestamp:Date.now(),ttl:this.DEFAULT_TTL})}getCachedPDAs(e){const t=e.toString(),r=this.cache.pdas.get(t);return r?this.isExpired(r)?(this.cache.pdas.delete(t),null):r.data:null}cacheConfig(e,t){const r=e.toString();this.cache.configs.set(r,{data:t,timestamp:Date.now(),ttl:this.CONFIG_TTL})}getCachedConfig(e){const t=e.toString(),r=this.cache.configs.get(t);return r?this.isExpired(r)?(this.cache.configs.delete(t),null):r.data:null}cacheUserState(e,t){const r=e.toString();this.cache.userStates.set(r,{data:t,timestamp:Date.now(),ttl:this.USER_STATE_TTL})}getCachedUserState(e){const t=e.toString(),r=this.cache.userStates.get(t);return r?this.isExpired(r)?(this.cache.userStates.delete(t),null):r.data:null}cacheFacility(e,t){const r=e.toString();this.cache.facilities.set(r,{data:t,timestamp:Date.now(),ttl:this.FACILITY_TTL})}getCachedFacility(e){const t=e.toString(),r=this.cache.facilities.get(t);return r?this.isExpired(r)?(this.cache.facilities.delete(t),null):r.data:null}invalidateUserCache(e){const t=e.toString();this.cache.userStates.delete(t),this.cache.facilities.delete(t)}invalidateAllCache(){this.cache.pdas.clear(),this.cache.configs.clear(),this.cache.userStates.clear(),this.cache.facilities.clear()}isExpired(e){return Date.now()-e.timestamp>e.ttl}cleanup(){const e=Date.now();for(const[t,r]of this.cache.pdas.entries())e-r.timestamp>r.ttl&&this.cache.pdas.delete(t);for(const[t,r]of this.cache.configs.entries())e-r.timestamp>r.ttl&&this.cache.configs.delete(t);for(const[t,r]of this.cache.userStates.entries())e-r.timestamp>r.ttl&&this.cache.userStates.delete(t);for(const[t,r]of this.cache.facilities.entries())e-r.timestamp>r.ttl&&this.cache.facilities.delete(t)}getCacheStats(){return{pdas:this.cache.pdas.size,configs:this.cache.configs.size,userStates:this.cache.userStates.size,facilities:this.cache.facilities.size,totalMemoryEntries:this.cache.pdas.size+this.cache.configs.size+this.cache.userStates.size+this.cache.facilities.size}}}const Gt=new Db;class Fu{constructor(e){me(this,"connection");me(this,"MAX_BATCH_SIZE",100);this.connection=e}async fetchMultipleAccounts(e){if(e.length===0)return[];try{const t=[];for(let r=0;r<e.length;r+=this.MAX_BATCH_SIZE){const i=e.slice(r,r+this.MAX_BATCH_SIZE),s=await this.processBatch(i);t.push(...s)}return Z.info(`✅ バッチフェッチ完了: ${e.length}件のアカウント`),t}catch(t){throw Z.error(`❌ バッチフェッチエラー: ${t instanceof Error?t.message:String(t)}`),t}}async processBatch(e){const t=e.map(r=>r.address);try{const r=await this.connection.getMultipleAccountsInfo(t);return e.map((i,s)=>({address:i.address,name:i.name,account:r[s]}))}catch(r){return Z.warn(`⚠️ バッチ処理エラー、個別取得にフォールバック: ${r instanceof Error?r.message:String(r)}`),await this.fallbackToIndividualRequests(e)}}async fallbackToIndividualRequests(e){const t=[];for(const r of e)try{const i=await this.connection.getAccountInfo(r.address);t.push({address:r.address,name:r.name,account:i})}catch(i){Z.warn(`⚠️ 個別アカウント取得失敗 ${r.name}: ${i instanceof Error?i.message:String(i)}`),t.push({address:r.address,name:r.name,account:null})}return t}static createGameStateBatch(e,t){return[{address:t.userState,name:"userState"},{address:t.facility,name:"facility"},{address:t.config,name:"config"},{address:t.rewardMint,name:"rewardMint"}]}static createMultiUserBatch(e){const t=[];return e.forEach((r,i)=>{t.push({address:r.userStatePDA,name:`userState_${i}`},{address:r.facilityPDA,name:`facility_${i}`})}),t}async fetchWithRetry(e,t=3,r=1e3){let i=null;for(let s=0;s<t;s++)try{return await this.fetchMultipleAccounts(e)}catch(o){i=o instanceof Error?o:new Error(String(o)),s<t-1&&(Z.warn(`🔄 バッチフェッチリトライ ${s+1}/${t}: ${i.message}`),await new Promise(a=>setTimeout(a,r*(s+1))))}throw i||new Error("バッチフェッチが最大リトライ回数に達しました")}async measureBatchPerformance(e){const t=performance.now();try{const r=await this.fetchMultipleAccounts(e),s=performance.now()-t,o=r.filter(u=>u.account!==null).length,a=r.length-o;return{duration:s,requestCount:e.length,successCount:o,failureCount:a,averageTimePerRequest:s/e.length}}catch(r){const i=performance.now();throw{error:r,duration:i-t,requestCount:e.length,successCount:0,failureCount:e.length}}}}const ai={INITIAL_GROW_POWER:100,TOKEN_DECIMALS:6,TOKEN_SYMBOL:"WEED"},ep={DEFAULT_AIRDROP_AMOUNT:2},Zi={SUCCESS_MESSAGE_DURATION:5e3,ERROR_MESSAGE_DURATION:8e3,TOKEN_DECIMAL_PLACES:6},Qt={WALLET_NOT_CONNECTED:"ウォレットが接続されていません",USER_NOT_INITIALIZED:"先にユーザーを初期化してください",USER_ALREADY_INITIALIZED:"ユーザーアカウントは既に初期化されています",FACILITY_ALREADY_OWNED:"既に施設を所有しています",FACILITY_NOT_OWNED:"先に施設を購入してください",INSUFFICIENT_FUNDS:"残高不足です。「SOLエアドロップ (開発用)」ボタンでSOLを取得してから再試行してください。",CONNECTION_FAILED:"RPC接続に失敗しました",TRANSACTION_FAILED:"トランザクションが失敗しました"},zo={USER_INITIALIZED:"ユーザーアカウントの初期化が完了しました！",USER_ALREADY_INITIALIZED:"ユーザーアカウントは既に初期化済みです！",FACILITY_PURCHASED:"施設の購入が完了しました！Grow Power: 100",FACILITY_ALREADY_OWNED:"施設は既に所有済みです！",REWARDS_CLAIMED:"報酬の請求が完了しました！",AIRDROP_COMPLETED:n=>`${n} SOL のエアドロップが完了しました！`,CONNECTION_ESTABLISHED:"RPC接続が確立されました"};function Yi(n){return typeof n=="object"&&n!==null&&"owner"in n&&"totalGrowPower"in n&&"lastHarvestTime"in n&&"hasFacility"in n}function Hu(n){return typeof n=="object"&&n!==null&&"owner"in n&&"machineCount"in n&&"totalGrowPower"in n&&"facilitySize"in n&&"maxCapacity"in n}function zu(n){return typeof n=="object"&&n!==null&&"baseRate"in n&&"halvingInterval"in n&&"admin"in n&&"treasury"in n}function oi(n){if(!n)return 0;const e=Number.MAX_SAFE_INTEGER,t=n.toNumber();if(t>e)throw new Error(`BN value ${n.toString()} exceeds MAX_SAFE_INTEGER`);return t}const Fb="7r3R1S43BS9fQbh1eBhM63u8XZJd7bYRtgMrAQRNrfcB",Hb={name:"facility_game",version:"0.1.0",spec:"0.1.0",description:"Created with Anchor"},zb=[{name:"add_machine",docs:["Add machine to facility"],discriminator:[148,26,70,80,42,110,107,230],accounts:[{name:"user_state",writable:!0,pda:{seeds:[{kind:"const",value:[117,115,101,114]},{kind:"account",path:"user"}]}},{name:"facility",writable:!0,pda:{seeds:[{kind:"const",value:[102,97,99,105,108,105,116,121]},{kind:"account",path:"user"}]}},{name:"reward_mint",writable:!0,pda:{seeds:[{kind:"const",value:[114,101,119,97,114,100,95,109,105,110,116]}]}},{name:"user_token_account",writable:!0},{name:"user",writable:!0,signer:!0},{name:"token_program",address:"TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA"}],args:[]},{name:"buy_facility",docs:["Purchase facility and place initial machine"],discriminator:[221,214,186,62,45,232,185,192],accounts:[{name:"user_state",writable:!0,pda:{seeds:[{kind:"const",value:[117,115,101,114]},{kind:"account",path:"user"}]}},{name:"facility",writable:!0,pda:{seeds:[{kind:"const",value:[102,97,99,105,108,105,116,121]},{kind:"account",path:"user"}]}},{name:"user",writable:!0,signer:!0},{name:"system_program",address:"11111111111111111111111111111111"}],args:[]},{name:"claim_referral_rewards",docs:["Claim accumulated referral rewards"],discriminator:[23,112,76,162,157,106,203,246],accounts:[{name:"referrer_state",writable:!0,pda:{seeds:[{kind:"const",value:[117,115,101,114]},{kind:"account",path:"referrer"}]}},{name:"reward_mint",writable:!0,pda:{seeds:[{kind:"const",value:[114,101,119,97,114,100,95,109,105,110,116]}]}},{name:"mint_authority",pda:{seeds:[{kind:"const",value:[109,105,110,116,95,97,117,116,104,111,114,105,116,121]}]}},{name:"referrer_token_account",writable:!0},{name:"referrer",writable:!0,signer:!0},{name:"token_program",address:"TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA"}],args:[]},{name:"claim_reward",docs:["Claim rewards"],discriminator:[149,95,181,242,94,90,158,162],accounts:[{name:"user_state",writable:!0,pda:{seeds:[{kind:"const",value:[117,115,101,114]},{kind:"account",path:"user"}]}},{name:"config",writable:!0,pda:{seeds:[{kind:"const",value:[99,111,110,102,105,103]}]}},{name:"reward_mint",writable:!0,pda:{seeds:[{kind:"const",value:[114,101,119,97,114,100,95,109,105,110,116]}]}},{name:"mint_authority",pda:{seeds:[{kind:"const",value:[109,105,110,116,95,97,117,116,104,111,114,105,116,121]}]}},{name:"user_token_account",writable:!0},{name:"user",writable:!0,signer:!0},{name:"token_program",address:"TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA"}],args:[]},{name:"create_reward_mint",docs:["Create reward token mint account"],discriminator:[149,144,95,196,171,77,31,66],accounts:[{name:"reward_mint",writable:!0,pda:{seeds:[{kind:"const",value:[114,101,119,97,114,100,95,109,105,110,116]}]}},{name:"mint_authority",docs:["@dev Set mint authority as PDA"],pda:{seeds:[{kind:"const",value:[109,105,110,116,95,97,117,116,104,111,114,105,116,121]}]}},{name:"metadata_account",docs:["Token metadata account (optional for test environments)"]},{name:"admin",writable:!0,signer:!0},{name:"token_program",address:"TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA"},{name:"system_program",address:"11111111111111111111111111111111"},{name:"rent",address:"SysvarRent111111111111111111111111111111111"},{name:"token_metadata_program",docs:["Token Metadata Program (optional for test environments)"]}],args:[]},{name:"distribute_referral_reward",docs:["Distribute referral reward to referrer"],discriminator:[142,104,39,246,244,221,71,10],accounts:[{name:"invitee_state",writable:!0,pda:{seeds:[{kind:"const",value:[117,115,101,114]},{kind:"account",path:"invitee"}]}},{name:"referrer_state",writable:!0,pda:{seeds:[{kind:"const",value:[117,115,101,114]},{kind:"account",path:"referrer"}]}},{name:"reward_mint",writable:!0,pda:{seeds:[{kind:"const",value:[114,101,119,97,114,100,95,109,105,110,116]}]}},{name:"mint_authority",pda:{seeds:[{kind:"const",value:[109,105,110,116,95,97,117,116,104,111,114,105,116,121]}]}},{name:"referrer_token_account",writable:!0},{name:"invitee",writable:!0,signer:!0},{name:"referrer"},{name:"token_program",address:"TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA"}],args:[{name:"reward_amount",type:"u64"}]},{name:"init_user",docs:["Initialize user account"],discriminator:[14,51,68,159,237,78,158,102],accounts:[{name:"user_state",writable:!0,pda:{seeds:[{kind:"const",value:[117,115,101,114]},{kind:"account",path:"user"}]}},{name:"user",writable:!0,signer:!0},{name:"system_program",address:"11111111111111111111111111111111"}],args:[{name:"referrer",type:{option:"pubkey"}}]},{name:"initialize_config",docs:["Initialize global configuration"],discriminator:[208,127,21,1,194,190,196,70],accounts:[{name:"config",writable:!0,pda:{seeds:[{kind:"const",value:[99,111,110,102,105,103]}]}},{name:"admin",writable:!0,signer:!0},{name:"system_program",address:"11111111111111111111111111111111"}],args:[{name:"base_rate",type:"u64"},{name:"halving_interval",type:"i64"},{name:"treasury",type:"pubkey"}]},{name:"open_mystery_box",docs:["Open mystery box and reveal seed"],discriminator:[225,33,198,1,90,131,62,90],accounts:[{name:"config",writable:!0,pda:{seeds:[{kind:"const",value:[99,111,110,102,105,103]}]}},{name:"mystery_box",writable:!0,pda:{seeds:[{kind:"const",value:[109,121,115,116,101,114,121,95,98,111,120]},{kind:"arg",path:"box_id"}]}},{name:"seed",writable:!0,pda:{seeds:[{kind:"const",value:[115,101,101,100]},{kind:"arg",path:"seed_id"}]}},{name:"opener",writable:!0,signer:!0},{name:"system_program",address:"11111111111111111111111111111111"}],args:[{name:"box_id",type:"u64"},{name:"seed_id",type:"u64"}]},{name:"purchase_mystery_box",docs:["Purchase mystery box"],discriminator:[228,131,158,90,37,255,179,187],accounts:[{name:"config",writable:!0,pda:{seeds:[{kind:"const",value:[99,111,110,102,105,103]}]}},{name:"mystery_box",writable:!0,pda:{seeds:[{kind:"const",value:[109,121,115,116,101,114,121,95,98,111,120]},{kind:"arg",path:"box_id"}]}},{name:"reward_mint",writable:!0,pda:{seeds:[{kind:"const",value:[114,101,119,97,114,100,95,109,105,110,116]}]}},{name:"purchaser_token_account",writable:!0},{name:"treasury_token_account",writable:!0},{name:"purchaser",writable:!0,signer:!0},{name:"token_program",address:"TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA"},{name:"system_program",address:"11111111111111111111111111111111"}],args:[{name:"box_id",type:"u64"}]},{name:"transfer_with_fee",docs:["Transfer tokens with 2% fee"],discriminator:[140,41,159,221,159,13,211,126],accounts:[{name:"from_token_account",writable:!0},{name:"to_token_account",writable:!0},{name:"config",pda:{seeds:[{kind:"const",value:[99,111,110,102,105,103]}]}},{name:"treasury_token_account",writable:!0},{name:"reward_mint",pda:{seeds:[{kind:"const",value:[114,101,119,97,114,100,95,109,105,110,116]}]}},{name:"from",writable:!0,signer:!0},{name:"token_program",address:"TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA"}],args:[{name:"amount",type:"u64"}]},{name:"upgrade_facility",docs:["Upgrade facility size"],discriminator:[17,36,22,17,100,252,86,131],accounts:[{name:"user_state",writable:!0,pda:{seeds:[{kind:"const",value:[117,115,101,114]},{kind:"account",path:"user"}]}},{name:"facility",writable:!0,pda:{seeds:[{kind:"const",value:[102,97,99,105,108,105,116,121]},{kind:"account",path:"user"}]}},{name:"reward_mint",writable:!0,pda:{seeds:[{kind:"const",value:[114,101,119,97,114,100,95,109,105,110,116]}]}},{name:"user_token_account",writable:!0},{name:"user",writable:!0,signer:!0},{name:"token_program",address:"TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA"}],args:[]}],$b=[{name:"Config",discriminator:[155,12,170,224,30,250,204,130]},{name:"Facility",discriminator:[16,190,236,249,84,151,160,37]},{name:"MysteryBox",discriminator:[84,58,85,105,241,51,143,79]},{name:"Seed",discriminator:[227,135,95,221,241,179,237,142]},{name:"UserState",discriminator:[72,177,85,249,76,167,186,126]}],Kb=[{code:6e3,name:"AlreadyHasFacility",msg:"User already has a facility"},{code:6001,name:"NoFacility",msg:"User does not have a facility"},{code:6002,name:"NoRewardToClaim",msg:"No reward to claim"},{code:6003,name:"CalculationOverflow",msg:"Calculation overflow"},{code:6004,name:"InvalidConfig",msg:"Invalid configuration"},{code:6005,name:"Unauthorized",msg:"Unauthorized"},{code:6006,name:"InvalidReferrer",msg:"Invalid referrer"},{code:6007,name:"InsufficientFunds",msg:"Insufficient funds"},{code:6008,name:"FacilityAtMaxCapacity",msg:"Facility is at maximum capacity"}],Wb=[{name:"Config",docs:["Global configuration account"],type:{kind:"struct",fields:[{name:"base_rate",docs:["Base reward rate"],type:"u64"},{name:"halving_interval",docs:["Halving interval (seconds)"],type:"i64"},{name:"next_halving_time",docs:["Next halving timestamp"],type:"i64"},{name:"admin",docs:["Admin address"],type:"pubkey"},{name:"treasury",docs:["Treasury account for fee collection"],type:"pubkey"},{name:"mystery_box_cost",docs:["Mystery box cost in $WEED tokens"],type:"u64"},{name:"seed_counter",docs:["Global seed counter"],type:"u64"},{name:"mystery_box_counter",docs:["Global mystery box counter"],type:"u64"},{name:"reserve",docs:["Reserved for future expansion"],type:{array:["u8",8]}}]}},{name:"Facility",docs:["Facility account"],type:{kind:"struct",fields:[{name:"owner",docs:["Facility owner"],type:"pubkey"},{name:"facility_size",docs:["Current facility size/level (determines capacity)"],type:"u32"},{name:"max_capacity",docs:["Maximum machine capacity based on facility size"],type:"u32"},{name:"machine_count",docs:["Machine count (cannot exceed max_capacity)"],type:"u32"},{name:"total_grow_power",docs:["Total Grow Power"],type:"u64"},{name:"reserve",docs:["Reserved for future expansion (multiple machine types, etc.)"],type:{array:["u8",56]}}]}},{name:"MysteryBox",docs:["Mystery Box purchase tracker"],type:{kind:"struct",fields:[{name:"purchaser",docs:["Purchaser"],type:"pubkey"},{name:"purchased_at",docs:["Purchase timestamp"],type:"i64"},{name:"cost_paid",docs:["Box cost paid"],type:"u64"},{name:"is_opened",docs:["Whether box has been opened"],type:"bool"},{name:"random_seed",docs:["Random seed for opening (set when purchased)"],type:"u64"},{name:"box_id",docs:["Box ID"],type:"u64"},{name:"reserve",docs:["Reserved for future expansion"],type:{array:["u8",32]}}]}},{name:"Seed",docs:["Seed NFT account"],type:{kind:"struct",fields:[{name:"owner",docs:["Seed owner"],type:"pubkey"},{name:"rarity",docs:["Seed rarity level"],type:{defined:{name:"SeedRarity"}}},{name:"grow_power_multiplier",docs:["Grow power multiplier (based on rarity)"],type:"u64"},{name:"is_planted",docs:["Whether this seed is currently planted in a facility"],type:"bool"},{name:"planted_facility",docs:["Facility where this seed is planted (if any)"],type:{option:"pubkey"}},{name:"created_at",docs:["Creation timestamp"],type:"i64"},{name:"seed_id",docs:["Unique seed ID"],type:"u64"},{name:"reserve",docs:["Reserved for future expansion"],type:{array:["u8",32]}}]}},{name:"SeedRarity",docs:["Seed rarity levels"],type:{kind:"enum",variants:[{name:"Common"},{name:"Rare"},{name:"Epic"},{name:"Legendary"}]}},{name:"UserState",docs:["User state account"],type:{kind:"struct",fields:[{name:"owner",docs:["User's public key"],type:"pubkey"},{name:"total_grow_power",docs:["Total Grow Power"],type:"u64"},{name:"last_harvest_time",docs:["Last harvest timestamp"],type:"i64"},{name:"has_facility",docs:["Whether the user has a facility"],type:"bool"},{name:"referrer",docs:["Referrer (inviter) public key - can be None for users without referrer"],type:{option:"pubkey"}},{name:"pending_referral_rewards",docs:["Accumulated referral rewards (unclaimed)"],type:"u64"},{name:"reserve",docs:["Reserved for future expansion"],type:{array:["u8",55]}}]}}],Gb={address:Fb,metadata:Hb,instructions:zb,accounts:$b,errors:Kb,types:Wb};class qb{constructor(e,t){me(this,"program");me(this,"provider");me(this,"batchFetcher");this.provider=new Gn(e,t,{preflightCommitment:"confirmed"});const r=new qn(Gb,this.provider);this.program={programId:r.programId,coder:r.coder,account:r.account,methods:r.methods},this.batchFetcher=new Fu(e)}async calculatePDAs(e){const t=Gt.getCachedPDAs(e);if(t)return t;const r=await Qd.calculatePDAs(e,this.program.programId);return Gt.cachePDAs(e,r),r}async initUser(){try{Z.info("👤 ユーザーアカウントを初期化中...");const e=this.provider.wallet.publicKey,t=await this.calculatePDAs(e),r=await this.program.account.userState.fetchNullable(t.userState);if(r&&Yi(r))return Z.warn(Qt.USER_ALREADY_INITIALIZED),"already_initialized";const i=await this.program.methods.initUser(null).accounts({userState:t.userState,user:e,systemProgram:$e.programId}).rpc();return Z.success(`ユーザー初期化成功! トランザクション: ${i}`),i}catch(e){const t=this.handleProgramError(e);throw Z.error(`ユーザー初期化エラー: ${t.message}`),t}}async buyFacility(){try{Z.info("🏭 施設を購入中...");const e=this.provider.wallet.publicKey,t=await this.calculatePDAs(e),r=await this.program.account.userState.fetchNullable(t.userState);if(!r||!Yi(r))throw Z.error(Qt.USER_NOT_INITIALIZED),new Error(Qt.USER_NOT_INITIALIZED);if(r.hasFacility)return Z.warn(Qt.FACILITY_ALREADY_OWNED),"already_owned";const i=await this.program.methods.buyFacility().accounts({userState:t.userState,facility:t.facility,user:e,systemProgram:$e.programId}).rpc();return Z.success(`施設購入成功! トランザクション: ${i}`),i}catch(e){const t=this.handleProgramError(e);throw Z.error(`施設購入エラー: ${t.message}`),t}}async claimRewards(){try{Z.info("💰 報酬を請求中...");const e=this.provider.wallet.publicKey,t=await this.calculatePDAs(e),r=await this.program.account.userState.fetchNullable(t.userState);if(!r)throw Z.error(Qt.USER_NOT_INITIALIZED),new Error(Qt.USER_NOT_INITIALIZED);if(!r.hasFacility)throw Z.error(Qt.FACILITY_NOT_OWNED),new Error(Qt.FACILITY_NOT_OWNED);const i=await dr(t.rewardMint,e),s=await this.provider.connection.getAccountInfo(i);let o=null;s||(Z.info("トークンアカウントを作成中..."),o=Pb(e,i,e,t.rewardMint));let a=this.program.methods.claimReward().accounts({userState:t.userState,config:t.config,rewardMint:t.rewardMint,mintAuthority:t.mintAuthority,userTokenAccount:i,user:e,tokenProgram:Mr});o&&a.preInstructions&&(a=a.preInstructions([o]));const u=await a.rpc();return Z.success(`報酬請求成功! トランザクション: ${u}`),u}catch(e){throw Z.error(`報酬請求エラー: ${e instanceof Error?e.message:String(e)}`),e}}async fetchUserState(e){try{const t=Gt.getCachedUserState(e);if(t)return t;const r=await this.calculatePDAs(e),i=await this.program.account.userState.fetchNullable(r.userState);return i&&!Yi(i)?(Z.warn("取得したユーザー状態の型が不正です"),null):(i&&Gt.cacheUserState(e,i),i)}catch(t){const r=this.handleProgramError(t);return Z.error(`ユーザー状態取得エラー: ${r.message}`),null}}async fetchFacility(e){try{const t=Gt.getCachedFacility(e);if(t)return t;const r=await this.calculatePDAs(e),i=await this.program.account.facility.fetchNullable(r.facility);return i&&!Hu(i)?(Z.warn("取得した施設状態の型が不正です"),null):(i&&Gt.cacheFacility(e,i),i)}catch(t){const r=this.handleProgramError(t);return Z.error(`施設状態取得エラー: ${r.message}`),null}}async fetchConfig(){try{const e=Gt.getCachedConfig(this.program.programId);if(e)return e;const[t]=await j.findProgramAddress([Buffer.from("config")],this.program.programId),r=await this.program.account.config.fetchNullable(t);return r&&!zu(r)?(Z.warn("取得した設定の型が不正です"),null):(r&&Gt.cacheConfig(this.program.programId,r),r)}catch(e){const t=this.handleProgramError(e);return Z.error(`設定取得エラー: ${t.message}`),null}}async initUserWithReferrer(e){try{Z.info("👤 紹介者付きでユーザーアカウントを初期化中...");const t=this.provider.wallet.publicKey,r=await this.calculatePDAs(t);if(await this.program.account.userState.fetchNullable(r.userState))return Z.warn(Qt.USER_ALREADY_INITIALIZED),"already_initialized";const s={userState:r.userState,user:t,systemProgram:$e.programId};if(e){const a=await this.calculatePDAs(e);s.referrerState=a.userState}const o=await this.program.methods.initUser(e||null).accounts(s).rpc();return Z.success(`ユーザー初期化成功! トランザクション: ${o}`),o}catch(t){throw Z.error(`ユーザー初期化エラー: ${t instanceof Error?t.message:String(t)}`),t}}async distributeReferralReward(e){try{Z.info("💰 紹介報酬を配布中...");const t=this.provider.wallet.publicKey,r=await this.calculatePDAs(t),i=await this.program.methods.distributeReferralReward(new Mt(e)).accounts({userState:r.userState,user:t}).rpc();return Z.success(`紹介報酬配布成功! トランザクション: ${i}`),i}catch(t){throw Z.error(`紹介報酬配布エラー: ${t instanceof Error?t.message:String(t)}`),t}}async claimReferralRewards(){try{Z.info("💰 紹介報酬を請求中...");const e=this.provider.wallet.publicKey,t=await this.calculatePDAs(e),r=await dr(t.rewardMint,e),i=await this.program.methods.claimReferralRewards().accounts({userState:t.userState,config:t.config,rewardMint:t.rewardMint,mintAuthority:t.mintAuthority,userTokenAccount:r,user:e,tokenProgram:Mr}).rpc();return Z.success(`紹介報酬請求成功! トランザクション: ${i}`),i}catch(e){throw Z.error(`紹介報酬請求エラー: ${e instanceof Error?e.message:String(e)}`),e}}async upgradeFacility(){try{Z.info("🔧 施設をアップグレード中...");const e=this.provider.wallet.publicKey,t=await this.calculatePDAs(e),r=await dr(t.rewardMint,e),i=await this.program.methods.upgradeFacility().accounts({facility:t.facility,userTokenAccount:r,rewardMint:t.rewardMint,user:e,tokenProgram:Mr}).rpc();return Z.success(`施設アップグレード成功! トランザクション: ${i}`),i}catch(e){throw Z.error(`施設アップグレードエラー: ${e instanceof Error?e.message:String(e)}`),e}}async addMachine(){try{Z.info("⚙️ マシンを追加中...");const e=this.provider.wallet.publicKey,t=await this.calculatePDAs(e),r=await dr(t.rewardMint,e),i=await this.program.methods.addMachine().accounts({userState:t.userState,facility:t.facility,userTokenAccount:r,rewardMint:t.rewardMint,user:e,tokenProgram:Mr}).rpc();return Z.success(`マシン追加成功! トランザクション: ${i}`),i}catch(e){throw Z.error(`マシン追加エラー: ${e instanceof Error?e.message:String(e)}`),e}}async transferWithFee(e,t){try{Z.info("💸 手数料付き転送を実行中...");const r=this.provider.wallet.publicKey,i=await this.calculatePDAs(r),s=await dr(i.rewardMint,r),o=await dr(i.rewardMint,e),a=await dr(i.rewardMint,i.treasury),u=await this.program.methods.transferWithFee(new Mt(t)).accounts({config:i.config,senderTokenAccount:s,recipientTokenAccount:o,treasuryTokenAccount:a,sender:r,tokenProgram:Mr}).rpc();return Z.success(`手数料付き転送成功! トランザクション: ${u}`),u}catch(r){throw Z.error(`手数料付き転送エラー: ${r instanceof Error?r.message:String(r)}`),r}}async purchaseMysteryBox(){try{Z.info("📦 ミステリーボックスを購入中...");const e=this.provider.wallet.publicKey,t=await this.calculatePDAs(e),r=await dr(t.rewardMint,e),i=await this.fetchConfig();if(!i)throw new Error("Config not found");const s=i.mysteryBoxCounter,[o]=await j.findProgramAddress([Buffer.from("mystery_box"),e.toBuffer(),s.toArrayLike(Buffer,"le",8)],this.program.programId),a=await this.program.methods.purchaseMysteryBox().accounts({config:t.config,mysteryBox:o,userTokenAccount:r,rewardMint:t.rewardMint,user:e,systemProgram:$e.programId,tokenProgram:Mr}).rpc();return Z.success(`ミステリーボックス購入成功! トランザクション: ${a}`),a}catch(e){throw Z.error(`ミステリーボックス購入エラー: ${e instanceof Error?e.message:String(e)}`),e}}async openMysteryBox(e){try{Z.info("📦 ミステリーボックスを開封中...");const t=this.provider.wallet.publicKey,r=await this.calculatePDAs(t),[i]=await j.findProgramAddress([Buffer.from("mystery_box"),t.toBuffer(),new Mt(e).toArrayLike(Buffer,"le",8)],this.program.programId),s=await this.fetchConfig();if(!s)throw new Error("Config not found");const o=s.seedCounter,[a]=await j.findProgramAddress([Buffer.from("seed"),t.toBuffer(),o.toArrayLike(Buffer,"le",8)],this.program.programId),u=await this.program.methods.openMysteryBox(new Mt(e)).accounts({config:r.config,mysteryBox:i,seed:a,user:t,systemProgram:$e.programId}).rpc();return Z.success(`ミステリーボックス開封成功! トランザクション: ${u}`),u}catch(t){throw Z.error(`ミステリーボックス開封エラー: ${t instanceof Error?t.message:String(t)}`),t}}async fetchMysteryBox(e,t){try{const[r]=await j.findProgramAddress([Buffer.from("mystery_box"),e.toBuffer(),new Mt(t).toArrayLike(Buffer,"le",8)],this.program.programId);return await this.program.account.mysteryBox.fetchNullable(r)}catch(r){return Z.error(`ミステリーボックス取得エラー: ${r instanceof Error?r.message:String(r)}`),null}}async fetchSeed(e,t){try{const[r]=await j.findProgramAddress([Buffer.from("seed"),e.toBuffer(),new Mt(t).toArrayLike(Buffer,"le",8)],this.program.programId);return await this.program.account.seed.fetchNullable(r)}catch(r){return Z.error(`シード取得エラー: ${r instanceof Error?r.message:String(r)}`),null}}async getTokenBalance(e){try{const t=await this.calculatePDAs(e),r=await dr(t.rewardMint,e),i=await this.provider.connection.getTokenAccountBalance(r),s=new Mt(i.value.amount),o=i.value.decimals;return oi(s)/Math.pow(10,o)}catch{return 0}}getConnection(){return this.provider.connection}async getTokenAccount(e){const t=await this.calculatePDAs(e);return await dr(t.rewardMint,e)}async fetchCompleteGameState(e){try{const t=await this.calculatePDAs(e),r=Fu.createGameStateBatch(e,{userState:t.userState,facility:t.facility,config:t.config,rewardMint:t.rewardMint}),i=await this.batchFetcher.fetchMultipleAccounts(r);let s=null,o=null,a=null;for(const l of i)if(l.account!==null)switch(l.name){case"userState":try{const f=this.program.coder.accounts.decode("userState",l.account.data);Yi(f)&&(s=f,Gt.cacheUserState(e,f))}catch(f){Z.warn(`UserState decode error: ${f}`)}break;case"facility":try{const f=this.program.coder.accounts.decode("facility",l.account.data);Hu(f)&&(o=f,Gt.cacheFacility(e,f))}catch(f){Z.warn(`Facility decode error: ${f}`)}break;case"config":try{const f=this.program.coder.accounts.decode("config",l.account.data);zu(f)&&(a=f,Gt.cacheConfig(this.program.programId,f))}catch(f){Z.warn(`Config decode error: ${f}`)}break}const u=await this.getTokenBalance(e);return{userState:s,facility:o,config:a,tokenBalance:u,userInitialized:s!==null,hasFacility:(s==null?void 0:s.hasFacility)??!1,growPower:oi(o==null?void 0:o.totalGrowPower)||0,pendingReferralRewards:s?oi(s.pendingReferralRewards):0}}catch(t){Z.error(`バッチゲーム状態取得エラー: ${t instanceof Error?t.message:String(t)}`);const r=await this.fetchUserState(e),i=await this.fetchFacility(e),s=await this.fetchConfig(),o=await this.getTokenBalance(e);return{userState:r,facility:i,config:s,tokenBalance:o,userInitialized:r!==null,hasFacility:(r==null?void 0:r.hasFacility)??!1,growPower:oi(i==null?void 0:i.totalGrowPower)||0,pendingReferralRewards:r?oi(r.pendingReferralRewards):0}}}invalidateUserCache(e){Gt.invalidateUserCache(e)}async measureFetchPerformance(e){const t=performance.now();await this.fetchCompleteGameState(e);const r=performance.now()-t;Gt.invalidateUserCache(e);const i=performance.now();await Promise.all([this.fetchUserState(e),this.fetchFacility(e),this.fetchConfig(),this.getTokenBalance(e)]);const s=performance.now()-i,o=(s-r)/s*100;return{batchTime:r,individualTime:s,improvement:o}}handleProgramError(e){return e instanceof Error?{...e,name:"ProgramError",message:e.message}:typeof e=="object"&&e!==null&&"logs"in e?{name:"ProgramError",message:"Program execution failed",logs:e.logs}:{name:"ProgramError",message:String(e)}}}typeof window<"u"&&(window.Buffer=te.Buffer);class tp{constructor(){me(this,"connection");me(this,"wallet");me(this,"anchorClient",null);this.connection=new Rh(Gr.rpcUrl,"confirmed"),this.wallet={connected:!1,publicKey:null,balance:0}}async testConnection(){try{Z.info("🔗 RPC接続テスト開始...");const e=await this.connection.getSlot();Z.success(`現在のスロット: ${e}`);const t=await this.connection.getBlockTime(e);if(t){const r=new Date(t*1e3);Z.info(`ブロック時刻: ${r.toLocaleString()}`)}return Z.success("RPC接続テスト成功"),!0}catch(e){return Z.error(`RPC接続テスト失敗: ${e instanceof Error?e.message:String(e)}`),!1}}async connectWallet(){try{if(Z.info("👛 ウォレット接続を試行中..."),!window.solana||!window.solana.isPhantom)throw new Error("Phantom ウォレットが見つかりません。https://phantom.app からインストールしてください。");const t=(await window.solana.connect()).publicKey;Z.success(`ウォレット接続成功: ${t.toString()}`);const i=await this.connection.getBalance(t)/Qi;return this.wallet={connected:!0,publicKey:t,balance:i},Z.info(`ウォレット残高: ${i.toFixed(4)} SOL`),await this.initializeAnchorClient(),this.wallet}catch(e){throw Z.error(`ウォレット接続エラー: ${e instanceof Error?e.message:String(e)}`),e}}async disconnectWallet(){try{window.solana&&await window.solana.disconnect(),this.wallet={connected:!1,publicKey:null,balance:0},this.anchorClient=null,Z.info("ウォレットを切断しました")}catch(e){Z.error(`ウォレット切断エラー: ${e instanceof Error?e.message:String(e)}`)}}async calculatePDAs(e){const t=new j(Gr.programId);return await Qd.calculatePDAs(e,t)}async getGameState(){if(!this.wallet.publicKey||!this.anchorClient)throw new Error("ウォレットが接続されていません");try{Z.info("🎮 ゲーム状態を取得中...");const e=await this.anchorClient.fetchCompleteGameState(this.wallet.publicKey);return this.convertToUIGameState(e)}catch(e){throw Z.error(`ゲーム状態取得エラー: ${e instanceof Error?e.message:String(e)}`),e}}async getDetailedGameState(){return!this.wallet.publicKey||!this.anchorClient?{userState:null,facility:null,config:null,tokenBalance:0,userInitialized:!1,hasFacility:!1,growPower:0,pendingReferralRewards:0}:await this.anchorClient.fetchCompleteGameState(this.wallet.publicKey)}convertToUIGameState(e){var r;const t={userInitialized:e.userInitialized,hasFacility:e.hasFacility,growPower:e.growPower,tokenBalance:e.tokenBalance,lastHarvestTime:((r=e.userState)==null?void 0:r.lastHarvestTime.toNumber())||0,pendingReferralRewards:e.pendingReferralRewards};return e.facility?(t.facility={facilitySize:e.facility.facilitySize,maxCapacity:e.facility.maxCapacity,machineCount:e.facility.machineCount,totalGrowPower:e.facility.totalGrowPower.toNumber()},Z.success(`施設確認: サイズ${e.facility.facilitySize}, マシン${e.facility.machineCount}`)):Z.info("施設未所有"),e.userState?(Z.success(`ユーザー状態確認: Grow Power ${t.growPower}`),e.userState.referrer&&Z.info(`紹介者: ${e.userState.referrer.toString()}`)):Z.info("ユーザー未初期化"),Z.info(`トークン残高: ${t.tokenBalance} WEED`),Z.success("ゲーム状態取得完了"),t}getWalletState(){return{...this.wallet}}getConnection(){return this.connection}getNetworkInfo(){return{network:Gr.network,rpcUrl:Gr.rpcUrl.split("?")[0]+(Gr.rpcUrl.includes("api-key")?"?api-key=***":""),programId:Gr.programId}}async initializeAnchorClient(){if(!window.solana||!this.wallet.publicKey)throw new Error("ウォレットが接続されていません");try{const e=new Gn(this.connection,{publicKey:this.wallet.publicKey,signTransaction:async t=>{if(!window.solana)throw new Error("Wallet not connected");return await window.solana.signTransaction(t)},signAllTransactions:async t=>{if(!window.solana)throw new Error("Wallet not connected");return await window.solana.signAllTransactions(t)}},{commitment:"confirmed"});L_(e),this.anchorClient=new qb(this.connection,{publicKey:this.wallet.publicKey,signTransaction:async t=>{if(!window.solana)throw new Error("Wallet not connected");return await window.solana.signTransaction(t)},signAllTransactions:async t=>{if(!window.solana)throw new Error("Wallet not connected");return await window.solana.signAllTransactions(t)}}),Z.success("Anchorクライアントを初期化しました")}catch(e){throw Z.error(`Anchorクライアント初期化エラー: ${e instanceof Error?e.message:String(e)}`),e}}getAnchorClient(){if(!this.anchorClient)throw new Error("Anchorクライアントが初期化されていません");return this.anchorClient}async airdropSol(e=ep.DEFAULT_AIRDROP_AMOUNT){if(!this.wallet.publicKey)throw new Error("ウォレットが接続されていません");if(!Gr.rpcUrl.includes("localhost")&&!Gr.rpcUrl.includes("127.0.0.1"))throw new Error("エアドロップはローカル環境でのみ利用可能です");try{Z.info(`💰 ${e} SOL をエアドロップ中...`);const t=await this.connection.requestAirdrop(this.wallet.publicKey,e*Qi);await this.connection.confirmTransaction(t,"confirmed");const r=await this.connection.getBalance(this.wallet.publicKey);this.wallet.balance=r/Qi,Z.success(`エアドロップ完了: ${e} SOL`),Z.info(`更新された残高: ${this.wallet.balance.toFixed(4)} SOL`)}catch(t){throw Z.error(`エアドロップエラー: ${t instanceof Error?t.message:String(t)}`),t}}}function Vb(n){return n instanceof Error?n.message:String(n)}function rp(n){const e=Vb(n);return e.includes("Attempt to debit an account but found no record of a prior credit")||e.includes("insufficient funds")?Qt.INSUFFICIENT_FUNDS:e.includes("not connected")?Qt.WALLET_NOT_CONNECTED:e}async function or(n,e,t){if(!n.connected){const r=Qt.WALLET_NOT_CONNECTED;throw Z.error(r),t&&t(r),new Error(r)}return await e()}async function qr(n,e){try{e.showLoading(`${e.operationName}中...`);const t=await n();return e.onSuccess&&await e.onSuccess(),e.showSuccess(e.successMessage),t}catch(t){const r=rp(t);throw Z.error(`${e.operationName}エラー: ${r}`),e.showError(`${e.operationName}に失敗しました: ${r}`),t}finally{e.hideLoading()}}async function $o(n,e){try{e.showLoading(`${e.operationName}中...`);const t=await n();return e.specialReturns&&typeof t=="string"&&t in e.specialReturns?e.showSuccess(e.specialReturns[t]):e.showSuccess(e.successMessage),e.onSuccess&&await e.onSuccess(),t}catch(t){const r=rp(t);throw Z.error(`${e.operationName}エラー: ${r}`),e.showError(`${e.operationName}に失敗しました: ${r}`),t}finally{e.hideLoading()}}class jb{constructor(e){me(this,"solanaService");me(this,"anchorClient",null);this.solanaService=e}getAnchorClient(){return this.anchorClient||(this.anchorClient=this.solanaService.getAnchorClient()),this.anchorClient}async initializeUser(e){return await or(this.solanaService.getWalletState(),async()=>await $o(()=>this.getAnchorClient().initUser(),{operationName:"ユーザー初期化",successMessage:zo.USER_INITIALIZED,specialReturns:{already_initialized:"ユーザーアカウントは既に初期化済みです！"},onSuccess:e.updateGameState,...e}),e.showError)}async initializeUserWithReferrer(e,t){return await or(this.solanaService.getWalletState(),async()=>await $o(()=>this.getAnchorClient().initUserWithReferrer(e),{operationName:"紹介者付きユーザー初期化",successMessage:"紹介者付きでユーザーアカウントが初期化されました！",specialReturns:{already_initialized:"ユーザーアカウントは既に初期化済みです！"},onSuccess:t.updateGameState,...t}),t.showError)}async purchaseFacility(e){return await or(this.solanaService.getWalletState(),async()=>await $o(()=>this.getAnchorClient().buyFacility(),{operationName:"施設購入",successMessage:`施設の購入が完了しました！Grow Power: ${ai.INITIAL_GROW_POWER}`,specialReturns:{already_owned:"施設は既に所有済みです！"},onSuccess:e.updateGameState,...e}),e.showError)}async claimRewards(e){return await or(this.solanaService.getWalletState(),async()=>await qr(()=>this.getAnchorClient().claimRewards(),{operationName:"報酬請求",successMessage:zo.REWARDS_CLAIMED,onSuccess:e.updateGameState,...e}),e.showError)}async claimReferralRewards(e){return await or(this.solanaService.getWalletState(),async()=>await qr(()=>this.getAnchorClient().claimReferralRewards(),{operationName:"紹介報酬請求",successMessage:"紹介報酬の請求が完了しました！",onSuccess:e.updateGameState,...e}),e.showError)}async upgradeFacility(e){return await or(this.solanaService.getWalletState(),async()=>await qr(()=>this.getAnchorClient().upgradeFacility(),{operationName:"施設アップグレード",successMessage:"施設のアップグレードが完了しました！",onSuccess:e.updateGameState,...e}),e.showError)}async addMachine(e){return await or(this.solanaService.getWalletState(),async()=>await qr(()=>this.getAnchorClient().addMachine(),{operationName:"マシン追加",successMessage:"マシンの追加が完了しました！",onSuccess:e.updateGameState,...e}),e.showError)}async transferTokens(e,t,r){return await or(this.solanaService.getWalletState(),async()=>await qr(()=>this.getAnchorClient().transferWithFee(e,t),{operationName:"トークン転送",successMessage:"トークンの転送が完了しました！",onSuccess:r.updateGameState,...r}),r.showError)}async purchaseMysteryBox(e){return await or(this.solanaService.getWalletState(),async()=>await qr(()=>this.getAnchorClient().purchaseMysteryBox(),{operationName:"ミステリーボックス購入",successMessage:"ミステリーボックスの購入が完了しました！",onSuccess:e.updateGameState,...e}),e.showError)}async openMysteryBox(e,t){return await or(this.solanaService.getWalletState(),async()=>await qr(()=>this.getAnchorClient().openMysteryBox(e),{operationName:"ミステリーボックス開封",successMessage:"ミステリーボックスの開封が完了しました！",onSuccess:t.updateGameState,...t}),t.showError)}async requestAirdrop(e,t){return await or(this.solanaService.getWalletState(),async()=>await qr(()=>this.solanaService.airdropSol(e),{operationName:"SOLエアドロップ",successMessage:zo.AIRDROP_COMPLETED(e),onSuccess:async()=>{},...t}),t.showError)}async getGameState(){const e=this.solanaService.getWalletState();if(!e.connected||!e.publicKey)return{userState:null,facility:null,config:null,tokenBalance:0,userInitialized:!1,hasFacility:!1,growPower:0,pendingReferralRewards:0};try{return await this.getAnchorClient().fetchCompleteGameState(e.publicKey)}catch(t){return Z.error(`ゲーム状態取得エラー: ${t instanceof Error?t.message:String(t)}`),{userState:null,facility:null,config:null,tokenBalance:0,userInitialized:!1,hasFacility:!1,growPower:0,pendingReferralRewards:0}}}invalidateCache(){const e=this.solanaService.getWalletState();e.connected&&e.publicKey&&this.getAnchorClient().invalidateUserCache(e.publicKey)}}class Zb{constructor(){me(this,"solanaService");me(this,"gameService");me(this,"currentWallet",null);me(this,"uiCallbacks");this.solanaService=new tp,this.gameService=new jb(this.solanaService),this.uiCallbacks={showLoading:e=>this.showLoading(e),hideLoading:()=>this.hideLoading(),showSuccess:e=>this.showSuccess(e),showError:e=>this.showError(e),updateGameState:()=>this.handleRefreshData()},this.init()}async init(){Z.info("🚀 TypeScript フロントエンド初期化開始");try{this.setupEventListeners();const e=this.solanaService.getNetworkInfo();this.updateNetworkInfo(e),Z.info(`ネットワーク設定: ${e.network} - ${e.rpcUrl}`),Z.info("RPC接続テスト開始...");const t=await this.solanaService.testConnection();this.updateConnectionStatus(t),t?Z.success("✅ 初期化完了 - フロントエンド準備OK"):Z.error("❌ RPC接続失敗")}catch(e){Z.error(`初期化エラー: ${e instanceof Error?e.message:String(e)}`),this.updateConnectionStatus(!1)}}setupEventListeners(){var e,t,r,i,s,o,a,u,l,f,_,I,g;(e=document.getElementById("connect-wallet"))==null||e.addEventListener("click",async()=>{await this.handleWalletConnect()}),(t=document.getElementById("init-user"))==null||t.addEventListener("click",()=>{this.handleInitUser()}),(r=document.getElementById("buy-facility"))==null||r.addEventListener("click",()=>{this.handleBuyFacility()}),(i=document.getElementById("claim-rewards"))==null||i.addEventListener("click",()=>{this.handleClaimRewards()}),(s=document.getElementById("claim-referral-rewards"))==null||s.addEventListener("click",()=>{this.handleClaimReferralRewards()}),(o=document.getElementById("upgrade-facility"))==null||o.addEventListener("click",()=>{this.handleUpgradeFacility()}),(a=document.getElementById("add-machine"))==null||a.addEventListener("click",()=>{this.handleAddMachine()}),(u=document.getElementById("transfer-tokens"))==null||u.addEventListener("click",()=>{this.handleTransferTokens()}),(l=document.getElementById("purchase-mystery-box"))==null||l.addEventListener("click",()=>{this.handlePurchaseMysteryBox()}),(f=document.getElementById("open-mystery-box"))==null||f.addEventListener("click",()=>{this.handleOpenMysteryBox()}),(_=document.getElementById("refresh-data"))==null||_.addEventListener("click",async()=>{await this.handleRefreshData()}),(I=document.getElementById("airdrop-sol"))==null||I.addEventListener("click",async()=>{await this.handleAirdrop()}),(g=document.getElementById("clear-logs"))==null||g.addEventListener("click",()=>{Z.clear()})}async handleWalletConnect(){try{const e=await this.solanaService.connectWallet();this.currentWallet=e,this.updateWalletDisplay(e),this.enableGameButtons(),await this.handleRefreshData()}catch(e){Z.error(`ウォレット接続失敗: ${e instanceof Error?e.message:String(e)}`),this.showError(`ウォレット接続に失敗しました: ${e instanceof Error?e.message:String(e)}`)}}async handleRefreshData(){var e,t;if(!((e=this.currentWallet)!=null&&e.connected)){Z.warn("ウォレットが接続されていません");return}try{const r=await this.gameService.getGameState(),i={userInitialized:r.userInitialized,hasFacility:r.hasFacility,growPower:r.growPower,tokenBalance:r.tokenBalance,lastHarvestTime:((t=r.userState)==null?void 0:t.lastHarvestTime.toNumber())||0,pendingReferralRewards:r.pendingReferralRewards,facility:r.facility?{facilitySize:r.facility.facilitySize,maxCapacity:r.facility.maxCapacity,machineCount:r.facility.machineCount,totalGrowPower:r.facility.totalGrowPower.toNumber()}:void 0};this.updateGameDisplay(i)}catch(r){Z.error(`データ更新エラー: ${r instanceof Error?r.message:String(r)}`)}}async handleInitUser(){Z.info("👤 ユーザー初期化機能"),await this.gameService.initializeUser(this.uiCallbacks)}async handleBuyFacility(){Z.info("🏭 施設購入機能"),await this.gameService.purchaseFacility(this.uiCallbacks)}async handleClaimRewards(){Z.info("💰 報酬請求機能"),await this.gameService.claimRewards(this.uiCallbacks)}async handleAirdrop(){Z.info("💰 SOLエアドロップ（開発用）"),await this.gameService.requestAirdrop(ep.DEFAULT_AIRDROP_AMOUNT,{...this.uiCallbacks,updateGameState:async()=>{const e=this.solanaService.getWalletState();this.updateWalletDisplay(e)}})}async handleClaimReferralRewards(){Z.info("💰 紹介報酬請求機能"),await this.gameService.claimReferralRewards(this.uiCallbacks)}async handleUpgradeFacility(){Z.info("🔧 施設アップグレード機能"),await this.gameService.upgradeFacility(this.uiCallbacks)}async handleAddMachine(){Z.info("⚙️ マシン追加機能"),await this.gameService.addMachine(this.uiCallbacks)}async handleTransferTokens(){Z.info("💸 トークン転送機能");try{const e=prompt("送信先アドレスを入力してください:"),t=prompt("送信量を入力してください:");if(!e||!t)throw new Error("アドレスまたは送信量が入力されていません");const r=new j(e);await this.gameService.transferTokens(r,parseInt(t),this.uiCallbacks)}catch(e){this.showError(`入力エラー: ${e instanceof Error?e.message:String(e)}`)}}async handlePurchaseMysteryBox(){Z.info("📦 ミステリーボックス購入機能"),await this.gameService.purchaseMysteryBox(this.uiCallbacks)}async handleOpenMysteryBox(){Z.info("📦 ミステリーボックス開封機能");try{const e=prompt("開封するミステリーボックスのIDを入力してください:");if(!e)throw new Error("ミステリーボックスIDが入力されていません");await this.gameService.openMysteryBox(parseInt(e),this.uiCallbacks)}catch(e){this.showError(`入力エラー: ${e instanceof Error?e.message:String(e)}`)}}showLoading(e){const t=document.getElementById("status-message");t&&(t.innerHTML=`<div class="info-message">${e}</div>`)}hideLoading(){const e=document.getElementById("status-message");e&&(e.innerHTML="")}showSuccess(e){const t=document.getElementById("status-message");t&&(t.innerHTML=`<div class="success">${e}</div>`,setTimeout(()=>this.hideLoading(),Zi.SUCCESS_MESSAGE_DURATION))}updateConnectionStatus(e){const t=document.getElementById("connection-status");t&&(e?t.innerHTML='<span class="status-indicator status-connected"></span>Helius RPC 接続済み':t.innerHTML='<span class="status-indicator status-disconnected"></span>接続失敗')}updateNetworkInfo(e){const t=document.getElementById("rpc-url"),r=document.getElementById("network");t&&(t.textContent=e.rpcUrl),r&&(r.textContent=e.network.toUpperCase())}updateWalletDisplay(e){const t=document.getElementById("wallet-status"),r=document.getElementById("wallet-address"),i=document.getElementById("wallet-balance"),s=document.getElementById("wallet-info");t&&(t.innerHTML=e.connected?'<span class="status-indicator status-connected"></span>接続済み':'<span class="status-indicator status-disconnected"></span>未接続'),e.connected&&e.publicKey?(r&&(r.textContent=e.publicKey.toString()),i&&(i.textContent=e.balance.toFixed(4)),s&&(s.style.display="block")):s&&(s.style.display="none")}updateGameDisplay(e){const t=document.getElementById("user-state"),r=document.getElementById("facility-state"),i=document.getElementById("grow-power"),s=document.getElementById("token-balance"),o=document.getElementById("facility-details"),a=document.getElementById("referral-rewards");if(t&&(t.textContent=e.userInitialized?"初期化済み":"未初期化"),r&&(r.textContent=e.hasFacility?"所有済み":"未所有"),i&&(i.textContent=e.growPower.toString()),s){const u=e.tokenBalance/Math.pow(10,ai.TOKEN_DECIMALS);s.textContent=`${u.toFixed(Zi.TOKEN_DECIMAL_PLACES)} ${ai.TOKEN_SYMBOL}`}if(o&&e.facility?o.innerHTML=`
        <div><strong>サイズ:</strong> ${e.facility.facilitySize}</div>
        <div><strong>最大容量:</strong> ${e.facility.maxCapacity}</div>
        <div><strong>マシン数:</strong> ${e.facility.machineCount}</div>
      `:o&&(o.innerHTML="<div>施設なし</div>"),a&&e.pendingReferralRewards!==void 0){const u=e.pendingReferralRewards/Math.pow(10,ai.TOKEN_DECIMALS);a.textContent=`${u.toFixed(Zi.TOKEN_DECIMAL_PLACES)} ${ai.TOKEN_SYMBOL}`}}enableGameButtons(){["init-user","buy-facility","claim-rewards","airdrop-sol","claim-referral-rewards","upgrade-facility","add-machine","transfer-tokens","purchase-mystery-box","open-mystery-box"].forEach(t=>{const r=document.getElementById(t);r&&(r.disabled=!1)})}showError(e){Z.error(e);const t=document.getElementById("status-message");if(t){let r=e;(e.includes("Attempt to debit an account but found no record of a prior credit")||e.includes("insufficient funds"))&&(r="残高不足です。「SOLエアドロップ (開発用)」ボタンでSOLを取得してから再試行してください。"),t.innerHTML=`<div class="error">${r}</div>`,setTimeout(()=>this.hideLoading(),Zi.ERROR_MESSAGE_DURATION)}}}typeof document<"u"&&document.addEventListener("DOMContentLoaded",()=>{new Zb,window.testHeliusConnection=async()=>await new tp().testConnection(),window.runManualTest=async()=>{const{runManualFrontendTest:n}=await ap(async()=>{const{runManualFrontendTest:e}=await import("./manual-frontend-test-CKBo8Bw6.js");return{runManualFrontendTest:e}},[]);return await n()},console.log("🎮 Facility Game Frontend loaded!"),console.log("💡 Available console commands:"),console.log("  - testHeliusConnection(): Test RPC connection"),console.log("  - runManualTest(): Run comprehensive frontend test")});export{jb as G,tp as S,Gr as c,Z as l};
//# sourceMappingURL=index-BIvyWUus.js.map
